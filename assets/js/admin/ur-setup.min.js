!function(i,n){var r=i(document);__=n.i18n.__,_x=n.i18n._x,sprintf=n.i18n.sprintf,i(".user-registration__wrap.ur-form-container").remove(),n.updates.installExtension=function(t){var e=i(".plugin-card-"+t.slug),a=e.find(".install-now, .activate-now");return t=_.extend({success:n.updates.installExtensionSuccess,error:n.updates.installExtensionError},t),a.html()!==__("Installing...")&&a.data("originaltext",a.html()),a.addClass("updating-message").attr("aria-label",sprintf(_x("Installing %s...","user-registration"),a.data("name"))).text(__("Installing...")),n.a11y.speak(__("Installing... please wait."),"polite"),e.removeClass("plugin-card-install-failed").find(".notice.notice-error").remove(),r.trigger("wp-extension-installing",t),n.updates.ajax("user_registration_install_extension",t)},n.updates.installExtensionSuccess=function(t){var e,a;"user-registration_page_add-new-registration"===pagenow?(i('tr[data-slug="'+t.slug+'"]').removeClass("install").addClass("installed").find(".plugin-status span").removeClass("updating-message install-now").addClass("updated-message active").attr("aria-label",sprintf(_x("%s installed!","user-registration"),t.pluginName)).text(_x("Installed!","plugin")),n.a11y.speak(__("Installation completed successfully."),"polite"),r.trigger("wp-plugin-bulk-install-success",t)):(e=i(".plugin-card-"+t.slug).find(".install-now"),a=i(".plugin-card-"+t.slug).find(".status-label"),e.removeClass("updating-message").addClass("updated-message installed button-disabled").attr("aria-label",sprintf(_x("%s installed!","user-registration"),t.pluginName)).text(_x("Installed!","user-registration")),n.a11y.speak(__("Installation completed successfully."),"polite"),r.trigger("wp-plugin-install-success",t),t.activateUrl&&setTimeout(function(){a.removeClass("status-install-now").addClass("status-active").text(n.updates.l10n.pluginInstalled),e.removeClass("install-now installed button-disabled updated-message").addClass("activate-now").attr("href",t.activateUrl),"plugins-network"===pagenow?e.attr("aria-label",sprintf(_x("Network Activate %s","user-registration"),t.pluginName)).text(__("Network Activate")):e.attr("aria-label",sprintf(_x("Activate %s","user-registration"),t.pluginName)).text(__("Activate"))},1e3))},n.updates.installExtensionError=function(t){var e,a,s;"user-registration_page_add-new-registration"===pagenow?(a=i('tr[data-slug="'+t.slug+'"]').find(".plugin-status span"),n.updates.isValidResponse(t,"install")&&!n.updates.maybeHandleCredentialError(t,"install-plugin")&&(s=sprintf(__("Installation failed: %s"),t.errorMessage),a.removeClass("updating-message").addClass("updated-message").attr("aria-label",sprintf(_x("%s installation failed","user-registration"),a.closest("tr").data("name"))).text(__("Installation Failed!")),n.a11y.speak(s,"assertive"),r.trigger("wp-plugin-bulk-install-error",t))):(a=(e=i(".plugin-card-"+t.slug)).find(".install-now"),n.updates.isValidResponse(t,"install")&&!n.updates.maybeHandleCredentialError(t,"user_registration_install_extension")&&(s=sprintf(__("Installation failed: %s"),t.errorMessage),e.addClass("plugin-card-update-failed").append('<div class="notice notice-error notice-alt is-dismissible"><p>'+s+"</p></div>"),e.on("click",".notice.is-dismissible .notice-dismiss",function(){setTimeout(function(){e.removeClass("plugin-card-update-failed").find(".column-name a").focus()},200)}),a.removeClass("updating-message").addClass("button-disabled").attr("aria-label",sprintf(_x("%s installation failed","user-registration"),a.data("name"))).text(__("Installation Failed!")),n.a11y.speak(s,"assertive"),r.trigger("wp-plugin-install-error",t)))},n.updates.queueChecker=function(){var t;!n.updates.ajaxLocked&&n.updates.queue.length&&("user_registration_install_extension"===(t=n.updates.queue.shift()).action&&n.updates.installExtension(t.data),r.trigger("wp-updates-queue-job",t))}}(jQuery,window.wp),jQuery(function(o){var u={$setup_form:o(".user-registration-setup--form"),$button_install:ur_setup_params.i18n_activating,init:function(){this.title_focus(),o(document).on("click",".user-registration-template-install-addon",this.install_addon),o(document).on("click",".upgrade-modal",this.message_upgrade),o(document).on("click",".ur-template-preview",this.template_preview),this.$setup_form.on("click",".ur-template-select",this.template_select),o(document.body).on("keypress",".user-registration-setup-form-name input",this.input_keypress)},title_focus:function(){setTimeout(function(){o("#user-registration-setup-name").focus()},100)},install_addon:function(t){var e=o(".plugins-list-table").find("#the-list tr"),i=o(t.target),n=0,r=0,l=[];wp.updates.maybeRequestFilesystemCredentials(t),o(".user-registration-template-install-addon").html(u.$button_install+'<div class="ur-spinner"></div>').closest("button").prop("disabled",!0),o(document).trigger("wp-plugin-bulk-install",e),e.each(function(t,e){e=o(e);e.hasClass("inactive")&&!e.find("notice-error").length&&wp.updates.queue.push({action:"user_registration_install_extension",data:{page:pagenow,name:e.data("name"),slug:e.data("slug")}})}),o(document).on("wp-plugin-bulk-install-success wp-plugin-bulk-install-error",function(t,e){var a,s=o('[data-slug="'+e.slug+'"]');"wp-"+e.install+"-bulk-install-success"===t.type?n++:(t=e.pluginName||s.find(".plugin-name").text(),r++,l.push(t+": "+e.errorMessage)),wp.updates.adminNotice=wp.template("wp-bulk-installs-admin-notice"),o(".user-registration-recommend-addons .bulk-action-notice").remove(),o(".user-registration-recommend-addons .plugins-list-table").before(wp.updates.adminNotice({id:"bulk-action-notice",className:"bulk-action-notice notice-alt",successes:n,errors:r,errorMessages:l,type:e.install})),a=o("#bulk-action-notice").on("click","button",function(){o(this).toggleClass("bulk-action-errors-collapsed").attr("aria-expanded",!o(this).hasClass("bulk-action-errors-collapsed")),a.find(".bulk-action-errors").toggleClass("hidden")}),wp.updates.queue.length||0<r&&i.removeClass("updating-message").text(i.data("originaltext")),0===wp.updates.queue.length&&(o(".user-registration-template-install-addon").parent().prop("disabled",!1),o(".user-registration-template-install-addon").removeClass("user-registration-template-install-addon").addClass("user-registration-template-continue").text(ur_setup_params.i18n_form_ok))}),wp.updates.queueChecker()},message_upgrade:function(t){var e=o(this).data("template-name-raw");t.preventDefault(),Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:'<span class="user-registration-swal2-modal__title">'+e+" "+ur_setup_params.upgrade_title+"</span>",text:ur_setup_params.upgrade_message,allowOutsideClick:!1,confirmButtonText:ur_setup_params.upgrade_button,showCancelButton:!0,cancelButtonText:ur_setup_params.i18n_ok,cancelButtonColor:"#DD6B55"}).then(function(t){t.isConfirmed&&window.open(ur_setup_params.upgrade_url,"_blank")})},template_preview:function(){var t=o(this),e=t.data("preview-link");t.closest(".user-registration-setup--form").find(".ur-template-preview-iframe #frame").attr("src",e)},template_select:function(t){var e,a=o(this),s=a.data("template"),i=(a.data("template-name-raw"),'<a href="#" class="user-registration-btn user-registration-template-continue">'+ur_setup_params.i18n_form_ok+"</a>"),n="";t.preventDefault(),($target=o(t.target)).hasClass("disabled")||$target.hasClass("updating-message")||(t='<span class="user-registration-swal2-modal__title">'+ur_setup_params.i18n_form_title+"</span>",$target.closest(".ur-template").find("span.user-registration-badge").length&&(a={action:"user_registration_template_licence_check",plan:a.attr("data-licence-plan").replace("-lifetime",""),slug:a.attr("data-template"),security:ur_setup_params.template_licence_check_nonce},o.ajax({url:ur_setup_params.ajax_url,data:a,type:"POST","async":!1}).done(function(t){$target.closest(".ur-template").append("<div class='user-registration-template-addons' style='display:none'>"+t.data.html+"</div>"),t.data.activate?o(".user-registration-builder-setup .swal2-confirm").show():(i="",t.data.html.includes("install-now")?(i=ur_setup_params.i18n_install_activate,u.$button_install=ur_setup_params.i18n_installing):i=ur_setup_params.i18n_install_only,t='<a href="#" class="user-registration-btn user-registration-template-install-addon">'+i+"</a>",o(".user-registration-template-addons").append('<div class="ur-install-now">'+t+"</div>"))})),$target.closest(".ur-template").find(".user-registration-template-addons").length&&(void 0!==(a=o(".user-registration-template-addons").find(".ur-install-now").html())&&(i=a),o(".user-registration-template-addons").find(".ur-install-now").remove(),n+=$target.closest(".ur-template").find(".user-registration-template-addons").html(),$target.closest(".ur-template").find(".user-registration-template-addons").remove()),n+="<h3>"+ur_setup_params.i18n_form_name+"</h3>",e=!1,Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:t,html:n,input:"text",inputPlaceholder:ur_setup_params.i18n_form_placeholder,inputAttributes:{id:"user-registration-setup-name"},showCloseButton:!0,allowOutsideClick:!1,confirmButtonText:i,inputValidator:function(t){0<o(".user-registration-template-install-addon").length||(0<o(".swal2-validation-message").length&&o(".swal2-validation-message").remove(),e=""===t&&(o(".swal2-content").append("<div class='swal2-validation-message' id='swal2-validation-message' style='display: flex;'>"+ur_setup_params.i18n_form_error_name+"</div>"),!0))},preConfirm:function(){if(0<o(".user-registration-template-install-addon").length){if(!e)return!1}else if(!e)return!0;return!1}}).then(function(t){var e;0<o(".user-registration-template-continue").length&&((e=o("#user-registration-setup-name")).val()&&(e={title:e.val(),action:"user_registration_create_form",template:s,security:ur_setup_params.create_form_nonce},o.post(ur_setup_params.ajax_url,e,function(t){t.success?window.location.href=t.data.redirect:(o(".user-registartion-setup-name").focus(),Swal.fire({icon:"error",title:"Oops...",text:t.data.error}))}).fail(function(t){Swal.fire({icon:"error",title:"Oops...",text:t.responseText})})))}))},input_keypress:function(t){var e=t.keyCode||t.which;if(o(this).removeClass("user-registration-required"),13===e&&"input"===t.target.tagName.toLowerCase())return t.preventDefault(),!1}};u.init()});