!function(e,t){var a=e(document);__=t.i18n.__,_x=t.i18n._x,sprintf=t.i18n.sprintf,e(".user-registration__wrap.ur-form-container").remove(),t.updates.installExtension=function(s){var i=e(".plugin-card-"+s.slug),n=i.find(".install-now, .activate-now");return s=_.extend({success:t.updates.installExtensionSuccess,error:t.updates.installExtensionError},s),n.html()!==__("Installing...")&&n.data("originaltext",n.html()),n.addClass("updating-message").attr("aria-label",sprintf(_x("Installing %s...","user-registration"),n.data("name"))).text(__("Installing...")),t.a11y.speak(__("Installing... please wait."),"polite"),i.removeClass("plugin-card-install-failed").find(".notice.notice-error").remove(),a.trigger("wp-extension-installing",s),t.updates.ajax("user_registration_install_extension",s)},t.updates.installExtensionSuccess=function(s){if("user-registration_page_add-new-registration"===pagenow){e('tr[data-slug="'+s.slug+'"]').removeClass("install").addClass("installed").find(".plugin-status span").removeClass("updating-message install-now").addClass("updated-message active").attr("aria-label",sprintf(_x("%s installed!","user-registration"),s.pluginName)).text(_x("Installed!","plugin")),t.a11y.speak(__("Installation completed successfully."),"polite"),a.trigger("wp-plugin-bulk-install-success",s)}else{var i=e(".plugin-card-"+s.slug).find(".install-now"),n=e(".plugin-card-"+s.slug).find(".status-label");i.removeClass("updating-message").addClass("updated-message installed button-disabled").attr("aria-label",sprintf(_x("%s installed!","user-registration"),s.pluginName)).text(_x("Installed!","user-registration")),t.a11y.speak(__("Installation completed successfully."),"polite"),a.trigger("wp-plugin-install-success",s),s.activateUrl&&setTimeout(function(){n.removeClass("status-install-now").addClass("status-active").text(t.updates.l10n.pluginInstalled),i.removeClass("install-now installed button-disabled updated-message").addClass("activate-now").attr("href",s.activateUrl),"plugins-network"===pagenow?i.attr("aria-label",sprintf(_x("Network Activate %s","user-registration"),s.pluginName)).text(__("Network Activate")):i.attr("aria-label",sprintf(_x("Activate %s","user-registration"),s.pluginName)).text(__("Activate"))},1e3)}},t.updates.installExtensionError=function(s){if("user-registration_page_add-new-registration"===pagenow){var i=e('tr[data-slug="'+s.slug+'"]').find(".plugin-status span");if(!t.updates.isValidResponse(s,"install"))return;if(t.updates.maybeHandleCredentialError(s,"install-plugin"))return;n=sprintf(__("Installation failed: %s"),s.errorMessage),i.removeClass("updating-message").addClass("updated-message").attr("aria-label",sprintf(_x("%s installation failed","user-registration"),i.closest("tr").data("name"))).text(__("Installation Failed!")),t.a11y.speak(n,"assertive"),a.trigger("wp-plugin-bulk-install-error",s)}else{var n,r=e(".plugin-card-"+s.slug),l=r.find(".install-now");if(!t.updates.isValidResponse(s,"install"))return;if(t.updates.maybeHandleCredentialError(s,"user_registration_install_extension"))return;n=sprintf(__("Installation failed: %s"),s.errorMessage),r.addClass("plugin-card-update-failed").append('<div class="notice notice-error notice-alt is-dismissible"><p>'+n+"</p></div>"),r.on("click",".notice.is-dismissible .notice-dismiss",function(){setTimeout(function(){r.removeClass("plugin-card-update-failed").find(".column-name a").focus()},200)}),l.removeClass("updating-message").addClass("button-disabled").attr("aria-label",sprintf(_x("%s installation failed","user-registration"),l.data("name"))).text(__("Installation Failed!")),t.a11y.speak(n,"assertive"),a.trigger("wp-plugin-install-error",s)}},t.updates.queueChecker=function(){var e;if(!t.updates.ajaxLocked&&t.updates.queue.length){switch((e=t.updates.queue.shift()).action){case"user_registration_install_extension":t.updates.installExtension(e.data)}a.trigger("wp-updates-queue-job",e)}}}(jQuery,window.wp),jQuery(function(e){var t={$setup_form:e(".user-registration-setup--form"),$button_install:ur_setup_params.i18n_activating,init:function(){this.title_focus(),e(document).on("click",".user-registration-template-install-addon",this.install_addon),e(document).on("click",".upgrade-modal",this.message_upgrade),e(document).on("click",".ur-template-preview",this.template_preview),this.$setup_form.on("click",".ur-template-select",this.template_select),e(document.body).on("keypress",".user-registration-setup-form-name input",this.input_keypress)},title_focus:function(){setTimeout(function(){e("#user-registration-setup-name").focus()},100)},install_addon:function(a){var s=e(".plugins-list-table").find("#the-list tr"),i=e(a.target),n=0,r=0,l=[];wp.updates.maybeRequestFilesystemCredentials(a),e(".user-registration-template-install-addon").html(t.$button_install+'<div class="ur-spinner"></div>').closest("button").prop("disabled",!0),e(document).trigger("wp-plugin-bulk-install",s),s.each(function(t,a){var s=e(a);s.hasClass("inactive")&&!s.find("notice-error").length&&wp.updates.queue.push({action:"user_registration_install_extension",data:{page:pagenow,name:s.data("name"),slug:s.data("slug")}})}),e(document).on("wp-plugin-bulk-install-success wp-plugin-bulk-install-error",function(t,a){var s,o,u=e('[data-slug="'+a.slug+'"]');"wp-"+a.install+"-bulk-install-success"===t.type?n++:(o=a.pluginName?a.pluginName:u.find(".plugin-name").text(),r++,l.push(o+": "+a.errorMessage)),wp.updates.adminNotice=wp.template("wp-bulk-installs-admin-notice"),e(".user-registration-recommend-addons .bulk-action-notice").remove(),e(".user-registration-recommend-addons .plugins-list-table").before(wp.updates.adminNotice({id:"bulk-action-notice",className:"bulk-action-notice notice-alt",successes:n,errors:r,errorMessages:l,type:a.install})),s=e("#bulk-action-notice").on("click","button",function(){e(this).toggleClass("bulk-action-errors-collapsed").attr("aria-expanded",!e(this).hasClass("bulk-action-errors-collapsed")),s.find(".bulk-action-errors").toggleClass("hidden")}),wp.updates.queue.length||r>0&&i.removeClass("updating-message").text(i.data("originaltext")),0===wp.updates.queue.length&&(e(".user-registration-template-install-addon").parent().prop("disabled",!1),e(".user-registration-template-install-addon").removeClass("user-registration-template-install-addon").addClass("user-registration-template-continue").text(ur_setup_params.i18n_form_ok))}),wp.updates.queueChecker()},message_upgrade:function(t){var a=e(this).data("template-name-raw");t.preventDefault(),Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:'<span class="user-registration-swal2-modal__title">'+a+" "+ur_setup_params.upgrade_title+"</span>",text:ur_setup_params.upgrade_message,allowOutsideClick:!1,confirmButtonText:ur_setup_params.upgrade_button,showCancelButton:!0,cancelButtonText:ur_setup_params.i18n_ok,cancelButtonColor:"#DD6B55"}).then(function(e){e.isConfirmed&&window.open(ur_setup_params.upgrade_url,"_blank")})},template_preview:function(){var t=e(this),a=t.data("preview-link");t.closest(".user-registration-setup--form").find(".ur-template-preview-iframe #frame").attr("src",a)},template_select:function(a){var s=e(this),i=s.data("template"),n=(s.data("template-name-raw"),'<a href="#" class="user-registration-btn user-registration-template-continue">'+ur_setup_params.i18n_form_ok+"</a>"),r="";if(a.preventDefault(),$target=e(a.target),!$target.hasClass("disabled")&&!$target.hasClass("updating-message")){var l='<span class="user-registration-swal2-modal__title">'+ur_setup_params.i18n_form_title+"</span>";if($target.closest(".ur-template").find("span.user-registration-badge").length){var o={action:"user_registration_template_licence_check",plan:s.attr("data-licence-plan").replace("-lifetime",""),slug:s.attr("data-template"),security:ur_setup_params.template_licence_check_nonce};e.ajax({url:ur_setup_params.ajax_url,data:o,type:"POST",async:!1}).done(function(a){if($target.closest(".ur-template").append("<div class='user-registration-template-addons' style='display:none'>"+a.data.html+"</div>"),a.data.activate)e(".user-registration-builder-setup .swal2-confirm").show();else{n="",a.data.html.includes("install-now")?(n=ur_setup_params.i18n_install_activate,t.$button_install=ur_setup_params.i18n_installing):n=ur_setup_params.i18n_install_only;var s='<a href="#" class="user-registration-btn user-registration-template-install-addon">'+n+"</a>";e(".user-registration-template-addons").append('<div class="ur-install-now">'+s+"</div>")}})}if($target.closest(".ur-template").find(".user-registration-template-addons").length){var u=e(".user-registration-template-addons").find(".ur-install-now").html();void 0!==u&&(n=u),e(".user-registration-template-addons").find(".ur-install-now").remove(),r+=$target.closest(".ur-template").find(".user-registration-template-addons").html(),$target.closest(".ur-template").find(".user-registration-template-addons").remove()}r+="<h3>"+ur_setup_params.i18n_form_name+"</h3>";var p=!1;Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:l,html:r,input:"text",inputPlaceholder:ur_setup_params.i18n_form_placeholder,inputAttributes:{id:"user-registration-setup-name"},showCloseButton:!0,allowOutsideClick:!1,confirmButtonText:n,inputValidator:function(t){if(!(e(".user-registration-template-install-addon").length>0)){if(e(".swal2-validation-message").length>0&&e(".swal2-validation-message").remove(),""===t)return e(".swal2-content").append("<div class='swal2-validation-message' id='swal2-validation-message' style='display: flex;'>"+ur_setup_params.i18n_form_error_name+"</div>"),void(p=!0);p=!1}},preConfirm:function(){if(e(".user-registration-template-install-addon").length>0){if(!p)return!1}else if(!p)return!0;return!1}}).then(function(t){if(e(".user-registration-template-continue").length>0){var a=e("#user-registration-setup-name");if(!a.val())return;var s={title:a.val(),action:"user_registration_create_form",template:i,security:ur_setup_params.create_form_nonce};e.post(ur_setup_params.ajax_url,s,function(t){t.success?window.location.href=t.data.redirect:(e(".user-registartion-setup-name").focus(),Swal.fire({icon:"error",title:"Oops...",text:t.data.error}))}).fail(function(e){Swal.fire({icon:"error",title:"Oops...",text:e.responseText})})}})}},input_keypress:function(t){var a=t.keyCode||t.which;if(e(this).removeClass("user-registration-required"),13===a&&"input"===t.target.tagName.toLowerCase())return t.preventDefault(),!1}};t.init()});