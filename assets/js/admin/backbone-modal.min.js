!function(t,e,o){"use strict";t.fn.URBackboneModal=function(e){return this.each(function(){new t.URBackboneModal(t(this),e)})},t.URBackboneModal=function(e,o){var n=t.extend({},t.URBackboneModal.defaultOptions,o);n.template&&new t.URBackboneModal.View({target:n.template,string:n.variable})},t.URBackboneModal.defaultOptions={template:"",variable:{}},t.URBackboneModal.View=e.View.extend({tagName:"div",id:"ur-backbone-modal-dialog",_target:void 0,_string:void 0,events:{"click .modal-close":"closeButton","click #btn-ok":"addButton","touchstart #btn-ok":"addButton",keydown:"keyboardActions"},resizeContent:function(){var e=t(".ur-backbone-modal-content").find("article"),o=.75*t(window).height();e.css({"max-height":o+"px"})},initialize:function(e){var n=this;this._target=e.target,this._string=e.string,o.bindAll(this,"render"),this.render(),t(window).resize(function(){n.resizeContent()})},render:function(){var e=wp.template(this._target);this.$el.attr("tabindex","0").append(e(this._string)),t(document.body).css({overflow:"hidden"}).append(this.$el),this.resizeContent(),this.$el.trigger("focus"),t(document.body).trigger("init_tooltips"),t(document.body).trigger("ur_backbone_modal_loaded",this._target)},closeButton:function(e){e.preventDefault(),t(document.body).trigger("ur_backbone_modal_before_remove",this._target),this.undelegateEvents(),t(document).off("focusin"),t(document.body).css({overflow:"auto"}),this.remove(),t(document.body).trigger("ur_backbone_modal_removed",this._target)},addButton:function(e){t(document.body).trigger("ur_backbone_modal_response",[this._target,this.getFormData()]),this.closeButton(e)},getFormData:function(){var e={};return t(document.body).trigger("ur_backbone_modal_before_update",this._target),t.each(t("form",this.$el).serializeArray(),function(o,n){-1!==n.name.indexOf("[]")?(n.name=n.name.replace("[]",""),e[n.name]=t.makeArray(e[n.name]),e[n.name].push(n.value)):e[n.name]=n.value}),e},keyboardActions:function(t){var e=t.keyCode||t.which;13!==e||t.target.tagName&&("input"===t.target.tagName.toLowerCase()||"textarea"===t.target.tagName.toLowerCase())||this.addButton(t),27===e&&this.closeButton(t)}})}(jQuery,Backbone,_);