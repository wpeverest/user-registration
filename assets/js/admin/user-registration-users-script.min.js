jQuery(function(e){function t(){e("textarea").each(function(){var t,r=e(this).closest(".ur-field-item");if(r.find(".ur-input-count").length>0){var n=e(this).val().trim();t="characters"===r.find(".ur-input-count").data("count-type")?n.length:""===n?0:n.split(/\s+/).length}r.find(".ur-input-count").text(t)})}var r=urUsersl10n,n={init:function(){n.initUIBindings(),n.handle_users_filter_reset()},initUIBindings:function(){e("#bulk-action-selector-top").on("change",n.handleActionsChange),n.handleActionsChange(),e("#user-registration-users-advanced-filter-btn").on("click",n.hideShowAdvancedFilters),e("#user_registration_pro_users_date_range_filter").on("change",n.hideShowAdvancedFilters),e("#user_registration_pro_start_date_filter, #user_registration_pro_end_date_filter").on("change",n.handleCustomDateRangeInput),e(".ur-back-button").on("click",n.handleBackButton),e("#user-registration-user-action-delete a").on("click",n.handleSingleUserDelete),e("#doaction.button.action").on("click",n.handleBulkDelete),e(".hide-column-tog").on("click",n.handleColumnStateChange),e("textarea").each(function(){e(this).on("input",t);var r,n=e(this).closest(".ur-field-item");if(n.find(".ur-input-count").length>0){var a=e(this).val().trim();r="characters"===n.find(".ur-input-count").data("count-type")?a.length:""===a?0:a.split(/\s+/).length}n.find(".ur-input-count").text(r)}),e("body").on("click",".disable-user-link",function(){var t=e(this).attr("id").split("-").pop(),r=e(this).data("nonce"),n="<span>"+user_registration_pro_admin_script_data.disable_user_popup_content+"</span>";n+='<form id="disable-user-form-'+t+'" class="disable-users-form" style="text-align:center">',n+='<input type="hidden" name="action" value="user_registration_disable_user">',n+='<input type="hidden" name="user_id" value="'+t+'">',n+='<input type="hidden" name="_wpnonce" value="'+r+'">',n+='<input type="number" name="duration_value" min="1" placeholder="'+user_registration_pro_admin_script_data.disable_user_placeholder+'" style="margin-right:10px;">',n+='<select name="duration_unit" style="margin-right:10px;"><option value="days">Day(s)</option><option value="weeks">Week(s)</option><option value="months">Month(s)</option><option value="years">Year(s)</option></select>',n+="</form>",swal.fire({title:'<i class="dashicons dashicons-warning"></i><span class="user-registration-swal2-modal__title" >'+user_registration_pro_admin_script_data.disable_user_title+"</span>",html:n,confirmButtonText:user_registration_pro_admin_script_data.disable,confirmButtonColor:"#3085d6",showConfirmButton:!0,showCancelButton:!0,cancelButtonText:user_registration_pro_admin_script_data.cancel,customClass:{container:"user-registration-swal2-container"},customClass:"user-registration-swal2-modal user-registration-swal2-modal--centered",focusConfirm:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(n){var a=Swal.getPopup().querySelector('input[name="duration_value"]').value,i=Swal.getPopup().querySelector('select[name="duration_unit"]').value;a&&i?(e.ajax({type:"get",url:user_registration_pro_admin_script_data.ajax_url,data:{action:"user_registration_disable_user",user_id:t,nonce:r,duration_value:a,duration_unit:i},success:function(e){e.success?Swal.fire({icon:"success",title:'<span class="user-registration-swal2-modal__title" >'+user_registration_pro_admin_script_data.disable_user_success_message_title+"</span>",customClass:"user-registration-swal2-modal user-registration-swal2-modal--centered",html:user_registration_pro_admin_script_data.disable_user_success_message}).then(function(){window.location.href=user_registration_pro_admin_script_data.after_disable_redirect_url}):Swal.fire({icon:"error",title:'<span class="user-registration-swal2-modal__title" >'+user_registration_pro_admin_script_data.disable_user_error_message_title+"</span>",customClass:"user-registration-swal2-modal user-registration-swal2-modal--centered",html:e.data.message+" "+user_registration_pro_admin_script_data.disable_user_error_message})},error:function(e){Swal.fire({icon:"error",title:'<span class="user-registration-swal2-modal__title" >'+user_registration_pro_admin_script_data.disable_user_error_message_title+"</span>",customClass:"user-registration-swal2-modal user-registration-swal2-modal--centered",html:e.data.message+" "+user_registration_pro_admin_script_data.disable_user_error_message})}}),Swal.close()):(Swal.showValidationMessage("Please enter duration value and unit."),Swal.hideLoading(),e(".swal2-actions").find("button").prop("disabled",!1))})}})})},handleColumnStateChange:function(t){var n=e(t.target),a=e("#user-registration-users-form-id");if(!["email","role","user_status","user_source","user_registered"].includes(n.val())&&a.length){var i=a.val();e.post(r.ajax_url,{action:"user_registration_pro_users_table_change_column_state",form:i,_wpnonce:r.change_column_nonce})}},handleActionsChange:function(){"update_role"===e("#bulk-action-selector-top").val()?(e("select#new_role").closest(".alignleft.actions").show(),e("#doaction").hide()):(e("select#new_role").closest(".alignleft.actions").hide(),e("#doaction").show())},handleBackButton:function(){window.history.back()},handleCustomDateRangeInput:function(){e("#user_registration_pro_users_date_range_filter").val("custom")},hideShowAdvancedFilters:function(t){e("#user_registration_pro_users_date_range_filter").is(e(t.target))?"custom"===e("#user_registration_pro_users_date_range_filter").val()?e("#user-registration-users-advanced-filters").slideDown(600):e("#user-registration-users-advanced-filters").slideUp(600):(e("#user-registration-users-advanced-filter-btn").is(e(t.target))||e("#user-registration-users-advanced-filter-btn").is(e(t.target).parent()))&&e("#user-registration-users-advanced-filters").slideToggle(600)},handleBulkDelete:function(t){if("delete"===e(t.target).parent().find("#bulk-action-selector-top").val()){t.preventDefault(),t.stopPropagation();var r=document.getElementById("user-registration-users-action-form"),a=new FormData(r),i=new URLSearchParams(a),s=window.location.origin+window.location.pathname+"?"+i.toString();n.handleDeletePrompt(s,"bulk")}},handleSingleUserDelete:function(t){t.preventDefault(),t.stopPropagation();var r=e(t.target).closest("#user-registration-user-action-delete").find("a").attr("href");n.handleDeletePrompt(r,"single")},handleDeletePrompt:function(e,t){var n=r.delete_prompt,a="single"==t?n.confirm_message_single:n.confirm_message_bulk;Swal.fire({title:"<img src='"+n.icon+"' id='delete-user-icon'>"+n.title,html:'<p id="html_1">'+a+'</p><p id="html_2">'+n.warning_message+"</p>",showCancelButton:!0,confirmButtonText:n.delete_label,cancelButtonText:n.cancel_label}).then(function(t){t.isConfirmed&&e&&(window.location.href=e)})},handle_users_filter_reset:function(){e("#user-registration-users-filter-reset-btn").on("click",function(t){t.preventDefault();var r=window.location.href,n=e(this).closest("form")[0];n.reset(),e(n).find('input[type="hidden"]').val(""),e(n).find("select").each(function(){e(this).prop("selectedIndex",0)}),window.location.href=r.split("&")[0]})}};e(document).ready(function(){e(".user-registration-users-page, #user-registration-pro-single-user-view").length&&n.init()})});