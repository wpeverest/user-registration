!function(e){"use strict";var t={conditions:[],contentTargets:[],accessControl:"access",membershipId:0,conditionCounter:0,targetCounter:0,ruleData:null,initialized:!1,init:function(){if("undefined"!=typeof urcr_membership_access_data){urcr_membership_access_data.membership_id&&(this.membershipId=parseInt(urcr_membership_access_data.membership_id,10));var t=null;if("undefined"!=typeof window.urcrMembershipRuleData&&window.urcrMembershipRuleData)t=window.urcrMembershipRuleData;else{var r=e("#ur-membership-access-section");if(r.length){var a=r.attr("data-rule-data");a&&(t=JSON.parse(a))}}var n=e(".urcr-conditions-list"),i=e(".urcr-target-type-group"),s=n.find(".urcr-condition-wrapper").length>0,o=i.find(".urcr-target-item").length>0;s||o?this.syncFromExistingHTML():t?(this.ruleData=t,this.populateRuleData(t)):this.initializeEmptyRule(),this.bindEvents(),this.initSelect2(),this.initActionSection(),this.initialized=!0}},initializeEmptyRule:function(){},syncFromExistingHTML:function(){var t=this;e(".urcr-condition-wrapper").each(function(){var r=e(this),a=r.data("condition-id"),n=r.find(".urcr-condition-field-select"),i=r.find(".urcr-condition-value-input"),s=n.val()||"roles",o="multiselect",c=t.getConditionOptions().find(function(e){return e.value===s});c&&(o=c.type||"multiselect");var u="";if("multiselect"===o){var l=i.attr("data-value");if(l)try{u=JSON.parse(l)}catch(m){u=[]}else u=[]}else if("checkbox"===o)u=i.find('input[type="radio"]:checked').val()||"logged-in";else if("date"===o||"number"===o||"text"===o)u=i.val()||"";else if("period"===o){var d=i.find('[data-period-part="select"]').val()||"During",p=i.find('[data-period-part="input"]').val()||"";u={select:d,input:p}}t.conditions.push({id:a,type:s,value:u,isLocked:!1}),"multiselect"===o&&t.initConditionSelect2(a,o,u)}),e(".urcr-target-item").each(function(){var r=e(this),a=r.data("target-id"),n=r.find(".urcr-target-type-label"),i="",s=n.length?n.text().toLowerCase():"";if(-1!==s.indexOf("pages"))i="pages";else if(-1!==s.indexOf("posts"))i="posts";else if(-1!==s.indexOf("post type"))i="post_types";else if(-1!==s.indexOf("taxonomy"))i="taxonomy";else if(-1!==s.indexOf("whole site"))i="whole_site";else{var o=r.find(".urcr-content-target-input");o.length&&(i=o.data("content-type")||o.data("field-type")||""),!i&&r.find("span").length&&-1!==r.text().indexOf("Whole Site")&&(i="whole_site")}var c="";if("whole_site"===i)c="whole_site";else if("taxonomy"===i){var u=r.find(".urcr-taxonomy-select").val()||"",l=r.find(".urcr-content-target-input").attr("data-value"),d=[];if(l)try{d=JSON.parse(l)}catch(m){d=[]}c={taxonomy:u,value:d}}else{var p=r.find(".urcr-content-target-input").attr("data-value");if(p)try{c=JSON.parse(p)}catch(m){c=[]}else c=[]}t.contentTargets.push({id:a,type:i,value:c}),"whole_site"!==i&&setTimeout(function(){t.initContentTargetSelect2(a,i,c)},100)})},populateRuleData:function(t){var r=this;if(e(".urcr-conditions-list").empty(),e(".urcr-target-type-group").empty(),r.conditions=[],r.contentTargets=[],t.access_control?(r.accessControl=t.access_control,r.updateAccessControlClass()):(r.accessControl="access",r.updateAccessControlClass()),t.logic_map&&t.logic_map.conditions&&t.logic_map.conditions.length>0){var a=t.logic_map.conditions;a.sort(function(e,t){return"membership"===e.type?-1:"membership"===t.type?1:0}),a.forEach(function(e,t){var n=a[0],i=n&&"membership"===n.type&&0===t,s=e.value;s=Array.isArray(s)?s:"object"==typeof s&&null!==s?s:s||"",r.addCondition(e.type,i,s,e.id)})}else r.membershipId>0&&r.addCondition("membership",!0,[r.membershipId.toString()]);t.target_contents&&t.target_contents.length>0&&t.target_contents.forEach(function(e){var t=e.type;"wp_pages"===t&&(t="pages"),"wp_posts"===t&&(t="posts");var a=e.value||("whole_site"===t?"whole_site":[]);"taxonomy"===t?e.taxonomy?a={taxonomy:e.taxonomy,value:Array.isArray(e.value)?e.value:[]}:"object"!=typeof e.value||null===e.value||Array.isArray(e.value)||e.value.taxonomy&&(a={taxonomy:e.value.taxonomy,value:Array.isArray(e.value.value)?e.value.value:[]}):"whole_site"!==t&&(Array.isArray(a)||(a=a?[a]:[])),r.addContentTarget(t,a,e.id)})},bindEvents:function(){var t=this;e(document).on("click",".urcr-add-condition-button",function(e){e.preventDefault(),t.addCondition("roles",!1,"")}),e(document).on("keydown",".urcr-add-condition-button",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.addCondition("roles",!1,""))}),e(document).on("click",".urcr-condition-remove",function(r){r.preventDefault();var a=e(this).closest(".urcr-condition-wrapper").data("condition-id");t.removeCondition(a)}),e(document).on("change",".urcr-condition-field-select",function(){var r=e(this).closest(".urcr-condition-wrapper").data("condition-id"),a=e(this).val();t.updateConditionType(r,a)}),e(document).on("change",".urcr-condition-value-input",function(){var r=e(this).closest(".urcr-condition-wrapper");if(r.length){var a=r.data("condition-id");t.updateConditionValue(a,e(this))}}),e(document).on("change",".urcr-period-input-group input, .urcr-period-input-group select",function(){var r=e(this).closest(".urcr-condition-wrapper");if(r.length){var a=r.data("condition-id"),n=e(this).closest(".urcr-period-input-group"),i=n.find('[data-period-part="select"]').val(),s=n.find('[data-period-part="input"]').val(),o={select:i||"During",input:s||""},c=t.conditions.find(function(e){return e.id===a});c&&(c.value=o)}}),e(document).on("click",".urcr-add-content-button",function(r){r.preventDefault(),t.showContentTypeDropdown(e(this))}),e(document).on("click",".urcr-target-remove",function(r){r.preventDefault();var a=e(this).closest(".urcr-target-item").data("target-id");t.removeContentTarget(a)}),e(document).on("click",".urcr-content-type-option",function(r){r.preventDefault();var a=e(this).data("content-type");t.addContentTarget(a),e(".urcr-content-type-dropdown-menu").removeClass("ur-d-flex").addClass("ur-d-none")}),e(document).on("keydown",".urcr-content-type-option",function(r){if("Enter"===r.key||" "===r.key){r.preventDefault();var a=e(this).data("content-type");t.addContentTarget(a),e(".urcr-content-type-dropdown-menu").removeClass("ur-d-flex").addClass("ur-d-none")}}),e(document).on("click",function(t){e(t.target).closest(".urcr-content-dropdown-wrapper").length||e(t.target).closest(".urcr-add-content-button").length||e(".urcr-content-type-dropdown-menu").removeClass("ur-d-flex").addClass("ur-d-none")}),e(document).on("change",".urcr-action-type-select",function(){var r=e(this).val()||"message";t.handleActionTypeChange(r)})},addCondition:function(t,r,a,n){if(t||(t="roles"),"membership"!==t){n||(n="x"+Date.now()+"_"+this.conditionCounter++);var i=this.getConditionOptions();if(i&&0!==i.length){var s=i.find(function(e){return e.value===t});s||(s=i[0],t=s.value);var o=s.type||"multiselect",c=this.getConditionRowHtml(n,t,s.label,o,a||"",!1),u=e(".urcr-conditions-list");0!==u.length&&(u.append(c),this.initConditionSelect2(n,o,a),this.conditions.push({id:n,type:t,value:a||"",isLocked:!1}))}}},getConditionRowHtml:function(e,t,r,a,n,i){var s=this.getConditionOptions(),o="";i||(o='<button type="button" class="button button-link-delete urcr-condition-remove" aria-label="Remove condition"><span class="dashicons dashicons-no-alt"></span></button>');var c='<select class="urcr-condition-field-select urcr-condition-value-input"'+(i?" disabled":"")+">";s.forEach(function(e){var r=e.value===t?"selected":"";c+='<option value="'+e.value+'" '+r+">"+e.label+"</option>"}),c+="</select>";var u=this.getConditionValueInputHtml(e,a,t,n,i);return'<div class="urcr-condition-wrapper" data-condition-id="'+e+'"><div class="urcr-condition-row ur-d-flex ur-mt-2 ur-align-items-start"><div class="urcr-condition-only ur-d-flex ur-align-items-start"><div class="urcr-condition-selection-section ur-d-flex ur-align-items-center ur-g-4"><div class="urcr-condition-field-name">'+c+'</div><div class="urcr-condition-operator"><span>is</span></div><div class="urcr-condition-value">'+u+"</div></div></div></div>"+o+"</div>"},getConditionValueInputHtml:function(e,t,r,a,n){var i="",s=n?" disabled":"";if("multiselect"===t)i='<select class="urcr-enhanced-select2 urcr-condition-value-input" multiple data-condition-id="'+e+'" data-field-type="'+r+'" '+s+"></select>";else if("checkbox"===t){var o="logged-out"===a||"logged_out"===a?"checked":"";i='<div class="urcr-checkbox-radio-input"><label><input type="radio" name="condition_'+e+'_user_state" value="logged-in" '+("logged-in"===a||"logged_in"===a||""===a?"checked":"")+" "+s+"> "+(urcr_membership_access_data.labels.logged_in||"Logged In")+'</label><label><input type="radio" name="condition_'+e+'_user_state" value="logged-out" '+o+" "+s+"> "+(urcr_membership_access_data.labels.logged_out||"Logged Out")+"</label></div>"}else if("date"===t)i='<input type="date" class="urcr-condition-value-input" data-condition-id="'+e+'" data-field-type="'+r+'" value="'+(a||"")+'" '+s+">";else if("period"===t){var c="During",u="";a&&"object"==typeof a?(c=a.select||"During",u=a.input||""):a&&"object"==typeof a&&a.value&&(u=a.value||"",c="During"),i='<div class="urcr-period-input-group ur-d-flex ur-align-items-center" style="gap: 8px;"><select class="urcr-period-select urcr-condition-value-input" data-condition-id="'+e+'" data-field-type="'+r+'" data-period-part="select" '+s+'><option value="During" '+("During"===c?"selected":"")+'>During</option><option value="After" '+("After"===c?"selected":"")+'>After</option></select><input type="number" class="urcr-period-number urcr-condition-value-input" data-condition-id="'+e+'" data-field-type="'+r+'" data-period-part="input" value="'+u+'" min="0" placeholder="Days" '+s+"></div>"}else i="number"===t?'<input type="number" class="urcr-condition-value-input" data-condition-id="'+e+'" data-field-type="'+r+'" value="'+(a||"")+'" '+s+">":'<input type="text" class="urcr-condition-value-input" data-condition-id="'+e+'" data-field-type="'+r+'" value="'+(a||"")+'" '+s+">";return i},initConditionSelect2:function(t,r,a){var n=e('.urcr-condition-wrapper[data-condition-id="'+t+'"] .urcr-enhanced-select2');if(n.length&&"multiselect"===r){var i=n.data("field-type"),s=this.getSelect2Options(i);n.hasClass("select2-hidden-accessible")&&n.select2("destroy"),setTimeout(function(){n.select2({data:s,multiple:!0,width:"100%"});var e=a,t=n.attr("data-value");if(t)try{e=JSON.parse(t)}catch(r){e=a}e&&Array.isArray(e)&&e.length>0?n.val(e).trigger("change"):e&&!Array.isArray(e)&&n.val([e]).trigger("change")},100)}},getSelect2Options:function(e){var t=[];if("roles"===e)urcr_membership_access_data.wp_roles&&(t=Object.keys(urcr_membership_access_data.wp_roles).map(function(e){return{id:e,text:urcr_membership_access_data.wp_roles[e]}}));else if("membership"===e)if(this.membershipId>0){var r="";urcr_membership_access_data.memberships&&urcr_membership_access_data.memberships[this.membershipId]&&(r=urcr_membership_access_data.memberships[this.membershipId]),t=[{id:this.membershipId.toString(),text:r||"Current Membership"}]}else urcr_membership_access_data.memberships&&(t=Object.keys(urcr_membership_access_data.memberships).map(function(e){return{id:e,text:urcr_membership_access_data.memberships[e]}}));else"capabilities"===e?urcr_membership_access_data.wp_capabilities&&(t=Object.keys(urcr_membership_access_data.wp_capabilities).map(function(e){return{id:e,text:urcr_membership_access_data.wp_capabilities[e]}})):"registration_source"===e?urcr_membership_access_data.registration_sources&&(t=Object.keys(urcr_membership_access_data.registration_sources).map(function(e){return{id:e,text:urcr_membership_access_data.registration_sources[e]}})):"ur_form_field"===e?t=[]:"payment_status"===e&&urcr_membership_access_data.payment_status&&(t=Object.keys(urcr_membership_access_data.payment_status).map(function(e){return{id:e,text:urcr_membership_access_data.payment_status[e]}}));return t},removeCondition:function(t){e('.urcr-condition-wrapper[data-condition-id="'+t+'"]').remove(),this.conditions=this.conditions.filter(function(e){return e.id!==t})},updateConditionType:function(t,r){var a=this.getConditionOptions().find(function(e){return e.value===r});if(a){var n=e('.urcr-condition-wrapper[data-condition-id="'+t+'"]').find(".urcr-condition-value"),i=this.getConditionValueInputHtml(t,a.type,r,"",!1);n.html(i),this.initConditionSelect2(t,a.type,"");var s=this.conditions.find(function(e){return e.id===t});s&&(s.type=r,s.value="")}},updateConditionValue:function(e,t){var r="";if(t.is("select"))r=t.is("[multiple]")?t.val()||[]:t.val()||"";else if(t.is('input[type="radio"]')){r=t.closest(".urcr-condition-wrapper").find('input[type="radio"]:checked').val()||""}else r=(t.is('input[type="number"]')||t.is('input[type="text"]')||t.is('input[type="date"]'),t.val()||"");var a=this.conditions.find(function(t){return t.id===e});a&&(a.value=r)},addContentTarget:function(t,r,a){a||(a="x"+Date.now()+"_"+this.targetCounter++);var n=this.getContentTypeLabel(t),i=this.getContentTargetHtml(a,t,n,r||"");e(".urcr-target-type-group").append(i),this.initContentTargetSelect2(a,t,r),this.contentTargets.push({id:a,type:t,value:r||("whole_site"===t?"whole_site":[])})},getContentTargetHtml:function(e,t,r,a){var n="";return n="whole_site"===t?"<span>"+urcr_membership_access_data.labels.whole_site+"</span>":"pages"===t||"posts"===t?'<select class="urcr-enhanced-select2 urcr-content-target-input" multiple data-target-id="'+e+'" data-content-type="'+t+'"></select>':"taxonomy"===t?'<div class="urcr-taxonomy-select-group"><select class="urcr-taxonomy-select" data-target-id="'+e+'"><option value="">Select Taxonomy</option></select><select class="urcr-enhanced-select2 urcr-content-target-input" multiple data-target-id="'+e+'" data-content-type="taxonomy"></select></div>':'<select class="urcr-enhanced-select2 urcr-content-target-input" multiple data-target-id="'+e+'" data-content-type="'+t+'"></select>','<div class="urcr-target-item" data-target-id="'+e+'"><span class="urcr-target-type-label">'+r+":</span>"+n+'<button type="button" class="button-link urcr-target-remove" aria-label="Remove"><span class="dashicons dashicons-no-alt"></span></button></div>'},initContentTargetSelect2:function(t,r,a){var n=e('.urcr-target-item[data-target-id="'+t+'"] .urcr-content-target-input');if(n.length&&"whole_site"!==r){var i=this.getContentTargetOptions(r);n.hasClass("select2-hidden-accessible")&&n.select2("destroy"),n.select2({data:i,multiple:!0,width:"100%"}),setTimeout(function(){a&&Array.isArray(a)&&a.length>0?n.val(a).trigger("change"):a&&!Array.isArray(a)&&"object"==typeof a&&a.value?Array.isArray(a.value)&&a.value.length>0&&n.val(a.value).trigger("change"):a&&!Array.isArray(a)&&n.val([a]).trigger("change")},50)}"taxonomy"===r&&this.initTaxonomySelect(t,a)},initTaxonomySelect:function(t,r){var a=this,n=e('.urcr-target-item[data-target-id="'+t+'"] .urcr-taxonomy-select'),i=e('.urcr-target-item[data-target-id="'+t+'"] .urcr-content-target-input');if(n.length&&urcr_membership_access_data.taxonomies){n.find("option").length<=1&&Object.keys(urcr_membership_access_data.taxonomies).forEach(function(e){n.append('<option value="'+e+'">'+urcr_membership_access_data.taxonomies[e]+"</option>")});var s=null,o=[];if(r&&r.taxonomy)s=r.taxonomy,o=r.value||[];else{s=n.val();var c=i.attr("data-value");if(c)try{o=JSON.parse(c)}catch(u){o=[]}}s&&(n.val()!==s&&n.val(s),a.updateTaxonomyTerms(t,s,o)),n.off("change").on("change",function(){var r=e(this).val();a.updateTaxonomyTerms(t,r,[])})}},updateTaxonomyTerms:function(t,r,a){var n=e('.urcr-target-item[data-target-id="'+t+'"] .urcr-content-target-input');if(n.length&&r&&urcr_membership_access_data.terms_list&&urcr_membership_access_data.terms_list[r]){var i=urcr_membership_access_data.terms_list[r],s=Object.keys(i).map(function(e){return{id:e,text:i[e]}});n.hasClass("select2-hidden-accessible")&&n.select2("destroy"),n.empty().select2({data:s,multiple:!0,width:"100%"}),a&&a.length>0&&setTimeout(function(){var e=a.map(function(e){return String(e)});n.val(e).trigger("change")},50)}},getContentTargetOptions:function(e){var t=[];return"pages"===e&&urcr_membership_access_data.pages?t=Object.keys(urcr_membership_access_data.pages).map(function(e){return{id:e,text:urcr_membership_access_data.pages[e]}}):"posts"===e&&urcr_membership_access_data.posts?t=Object.keys(urcr_membership_access_data.posts).map(function(e){return{id:e,text:urcr_membership_access_data.posts[e]}}):"post_types"===e&&urcr_membership_access_data.post_types&&(t=Object.keys(urcr_membership_access_data.post_types).map(function(e){return{id:e,text:urcr_membership_access_data.post_types[e]}})),t},removeContentTarget:function(t){var r=e('.urcr-target-item[data-target-id="'+t+'"]');r.length&&(r.removeClass("ur-d-flex").addClass("ur-d-none"),r.remove()),this.contentTargets=this.contentTargets.filter(function(e){return e.id!==t})},showContentTypeDropdown:function(t){var r=this.contentTargets.map(function(e){return e.type}),a=urcr_membership_access_data.is_pro||!1,n=urcr_membership_access_data.content_type_options,i=(a?n:n.filter(function(e){return"posts"===e.value||"pages"===e.value})).filter(function(e){return-1===r.indexOf(e.value)}),s=t.closest(".urcr-content-dropdown-wrapper");if(0===s.length&&(s=t.closest(".urcr-target-selection-section").find(".urcr-content-dropdown-wrapper")),0===s.length&&(s=t.closest(".urcr-target-selection-wrapper").find(".urcr-content-dropdown-wrapper")),0!==s.length){var o=s.find(".urcr-content-type-dropdown-menu");0===o.length&&(o=e('<div class="urcr-content-type-dropdown-menu urcr-dropdown-menu"></div>'),s.append(o)),o.empty(),i.forEach(function(e){o.append('<span role="button" tabindex="0" class="urcr-dropdown-option urcr-content-type-option" data-content-type="'+e.value+'">'+e.label+"</span>")}),o.hasClass("ur-d-none")?o.removeClass("ur-d-none").addClass("ur-d-flex"):o.removeClass("ur-d-flex").addClass("ur-d-none")}},updateAccessControlClass:function(){var t=e(".urcr-condition-value-input-wrapper");t.removeClass("urcr-restrict-content"),t.addClass("urcr-access-content")},initSelect2:function(){},getConditionOptions:function(){var e=urcr_membership_access_data.condition_options||[];return urcr_membership_access_data.is_pro||!1||(e=e.filter(function(e){return"membership"===e.value||"roles"===e.value||"user_state"===e.value})),e=e.filter(function(e){return"membership"!==e.value})},getContentTypeLabel:function(e){for(var t=urcr_membership_access_data.content_type_options||[],r=0;r<t.length;r++)if(t[r].value===e)return t[r].label||e;return e},prepareRuleData:function(){var t=this,r=e("#ur-input-type-membership-name").closest("form").find('input[name="membership_id"]');if(r.length&&r.val()&&(t.membershipId=parseInt(r.val(),10)),!t.membershipId&&window.location.search){var a=new URLSearchParams(window.location.search).get("post_id");a&&(t.membershipId=parseInt(a,10))}var n=!1;e(".urcr-condition-wrapper").each(function(){if("membership"===e(this).find(".urcr-condition-field-select").val())return n=!0,!1});var i=[];e(".urcr-condition-wrapper").each(function(){var r=e(this),a=r.data("condition-id"),n=r.find(".urcr-condition-field-select").val(),s="",o=r.find(".select2-hidden-accessible");if(o.length)s=o.val()||[],Array.isArray(s)||(s=s?[s]:[]);else{var c=r.find(".urcr-condition-value-input");if(c.is("select[multiple]")){var u=c.val();s=Array.isArray(u)?u:u?[u]:[]}else if(c.is('input[type="radio"]'))s=r.find('input[type="radio"]:checked').val()||"";else if(r.find(".urcr-period-input-group").length){var l=r.find(".urcr-period-input-group"),d=l.find('[data-period-part="select"]').val(),p=l.find('[data-period-part="input"]').val();s={select:d||"During",input:p||""}}else s=c.val()||""}"membership"===n&&t.membershipId>0&&(s=[t.membershipId.toString()]),i.push({id:a,type:n,value:s})}),!n&&t.membershipId>0&&i.unshift({id:"x"+Date.now(),type:"membership",value:[t.membershipId.toString()]});var s=[];e(".urcr-target-item").each(function(){var t=e(this),r=t.data("target-id"),a="";if(t.find(".urcr-taxonomy-select").length)a="taxonomy";else if(t.find(".urcr-content-target-input").length)a=t.find(".urcr-content-target-input").data("content-type")||"";else{var n=t.find(".urcr-target-type-label");n.length&&-1!==n.text().indexOf("Whole Site")&&(a="whole_site")}var i="";switch(a){case"whole_site":i="whole_site";break;case"taxonomy":var o=t.find(".urcr-taxonomy-select").val(),c=t.find(".urcr-content-target-input"),u=[],l=c.attr("data-value");if(l)try{u=JSON.parse(l)}catch(f){u=[]}else u=c.val()||[];Array.isArray(u)||(u=u?[u]:[]),i={taxonomy:o,value:u};break;case"pages":case"posts":var d=[],p=(m=t.find(".urcr-content-target-input")).attr("data-value");if(p)try{d=JSON.parse(p)}catch(f){d=[]}else d=m.val()||[];i=Array.isArray(d)?d:d?[d]:[];break;default:var m,h=[],g=(m=t.find(".urcr-content-target-input")).attr("data-value");if(g)try{h=JSON.parse(g)}catch(f){h=[]}else h=m.val()||[];i=Array.isArray(h)?h:h?[h]:[]}switch(a){case"pages":a="wp_pages";break;case"posts":a="wp_posts"}s.push({id:r,type:a,value:i})});var o=t.getActionsFromForm(),c={title:"",access_rule_data:{enabled:!0,access_control:t.accessControl||"access",logic_map:{type:"group",id:"x"+Date.now(),conditions:i,logic_gate:"AND"},target_contents:s,actions:o},rule_type:"membership",membership_id:t.membershipId};return console.log(o),e("#urcr-membership-access-rule-data").val(JSON.stringify(c)),window.urcrMembershipAccessRuleData=c,c},initActionSection:function(){var t=e("#urcr-membership-action-type");if(e(".urcr-action-input-container").removeClass("ur-d-flex").addClass("ur-d-none"),t.length){e(".urcr-action-local-page, .urcr-action-ur-form, .urcr-action-shortcode-tag").each(function(){e(this).hasClass("select2-hidden-accessible")||e(this).select2({width:"100%"})});var r=t.val()||"message";this.handleActionTypeChange(r)}},handleActionTypeChange:function(t){e(".urcr-action-input-container").removeClass("ur-d-flex").addClass("ur-d-none"),t||(t="message");var r=null;switch(t){case"message":r=e(".urcrra-message-input-container");break;case"redirect":r=e(".urcrra-redirect-input-container");break;case"local_page":r=e(".urcrra-redirect-to-local-page-input-container");break;case"ur-form":r=e(".urcrra-ur-form-input-container");break;case"shortcode":r=e(".urcrra-shortcode-input-container");break;default:r=e(".urcrra-message-input-container")}r&&r.length&&r.removeClass("ur-d-none").addClass("ur-d-flex")},getActionsFromForm:function(){var t=e("#urcr-membership-action-type");if(!t.length)return this.getDefaultActions();var r=t.val()||"message",a={id:"x"+Date.now(),type:r,access_control:this.accessControl||"access"};switch(r){case"message":a.label="Show Message";var n="";n="undefined"!=typeof wp&&wp.editor&&e("#urcr-membership-action-message").length?wp.editor.getContent("urcr-membership-action-message"):e("#urcr-membership-action-message").val()||"",a.message=n||"<p>You do not have sufficient permission to access this content.</p>",a.redirect_url="",a.local_page="",a.ur_form="",a.shortcode={tag:"",args:""};break;case"redirect":a.label="Redirect",a.message="",a.redirect_url=e(".urcr-action-redirect-url").val()||"",a.local_page="",a.ur_form="",a.shortcode={tag:"",args:""};break;case"local_page":a.type="redirect_to_local_page",a.label="Redirect to a Local Page",a.message="",a.redirect_url="",a.local_page=e(".urcr-action-local-page").val()||"",a.ur_form="",a.shortcode={tag:"",args:""};break;case"ur-form":a.type="ur-form",a.label="Show UR Form",a.message="",a.redirect_url="",a.local_page="",a.ur_form=e(".urcr-action-ur-form").val()||"",a.shortcode={tag:"",args:""};break;case"shortcode":a.label="Render Shortcode",a.message="",a.redirect_url="",a.local_page="",a.ur_form="",a.shortcode={tag:e(".urcr-action-shortcode-tag").val()||"",args:e(".urcr-action-shortcode-args").val()||""}}return[a]},getDefaultActions:function(){return[{id:"x"+Date.now(),type:"message",label:"Show Message",message:"<p>You do not have sufficient permission to access this content.</p>",redirect_url:"",access_control:this.accessControl,local_page:"",ur_form:"",shortcode:{tag:"",args:""}}]}};e(document).ready(function(){0===e("#ur-membership-access-section").length?setTimeout(function(){e("#ur-membership-access-section").length>0&&t.init()},500):t.init()}),window.URCRMembershipAccess=t}(jQuery);