!function(t,r){var a={},n={append_spinner:function(e){if(e&&e.append){return e.append('<span class="urm-spinner is-active"></span>'),!0}return!1},remove_spinner:function(e){return!(!e||!e.remove)&&(e.find(".urm-spinner").remove(),!0)},convert_to_array:function(e){return Object.values(e).reverse().slice(2).reverse()},toggleSaveButtons:function(e,r){e=this.if_empty(e,!0),t(r).prop("disabled",!!e)},if_empty:function(e,t){return null===e||undefined===e||""===e?t:e},clear_validation_error:function(){t("span.notice_red").each(function(){t(this).text("")})},show_validation_error:function(e,r){e.removeClass("notice_blue").addClass("notice_red").text(r),this.clear_validation_error();e.siblings("input");t("html, body").animate({scrollTop:e.parent().offset().top},200),e.text(r)},toggleNotice:function(){t(".notice-container").toggleClass("active"),setTimeout(this.toggleNotice,5e3)},show_failure_message:function(e){t(".notice-container .notice_blue").removeClass("notice_blue").addClass("notice_red"),t(".notice_message").text(e),this.toggleNotice()},show_success_message:function(e){t(".notice-container .notice_red").removeClass("notice_red").addClass("notice_blue"),t(".notice_message").text(e),this.toggleNotice()},show_form_success_message:function(e,a){var n=e.data,s=user_registration_params.ursL10n,o=t("#user-registration-form-"+e.form_id),u=t('<ul class=""/>'),_=n.success_message_positon,d=o.find('input[name="ur-redirect-url"]').val(),m=e.data.redirect_timeout?e.data.redirect_timeout:2e3;"undefined"!=typeof n.role_based_redirect_url&&(d=n.role_based_redirect_url),"undefined"!=typeof e.data.form_login_option&&"sms_verification"===e.data.form_login_option&&window.setTimeout(function(){"undefined"!=typeof e.data.redirect_url&&e.data.redirect_url&&(window.location=e.data.redirect_url)},m),void 0!==d&&""!==d?(t(document).trigger("user_registration_frontend_before_redirect_url",[d]),window.setTimeout(function(){window.location=d},m)):d=r.thank_you_page_url,o.find(".ur-submit-button").find("span").removeClass("ur-front-spinner"),"admin_approval"==n.form_login_option?u.append("<li>"+s.user_under_approval+"</li>"):"email_confirmation"===n.form_login_option||"admin_approval_after_email_confirmation"===n.form_login_option?u.append("<li>"+s.user_email_pending+"</li>"):u.append("<li>"+s.user_successfully_saved+"</li>"),o.find("form")[0].reset();var p=t('<div class="ur-message user-registration-message" id="ur-submit-message-node"/>');p.append(u),"1"===_?(o.find("form").append(p),t(window).scrollTop(o.find("form").find(".ur-button-container").offset().top)):(o.find("form").prepend(p),t(window).scrollTop(o.find("form").closest(".ur-frontend-form").offset().top)),o.find("form").find(".ur-submit-button").prop("disabled",!1),void 0!==d&&""!==d?i.show_default_response(d,a,m):"undefined"!=typeof n.auto_login&&n.auto_login&&i.show_default_response(d,a,m)},isEventRegistered:function(e,r){var a=t._data(t(e)[0],"events");return a&&a[r]}},i={prepare_members_data:function(){var e={},r=t("#ur-membership-registration").find("input.ur_membership_input_class");(r=n.convert_to_array(r)).forEach(function(r){var a=t(r);if(a.attr("name")!==undefined){var n=a.attr("name").toLowerCase().replace("urm_","");e[n]=a.val()}});var a=t('input[name="urm_membership"]:checked');e.membership=a.val(),e.payment_method="free","free"!==a.data("urm-pg-type")&&(e.payment_method=t('input[name="urm_payment_method"]:checked').val());var i=new Date;return e.start_date=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),e},prepare_coupons_apply_data:function(){var e={};return e.coupon=t("#ur-membership-coupon").val(),e.membership_id=t('input[name="urm_membership"]:checked').val(),e},validate_membership_form:function(e){void 0===e&&(e=!1);var i=!0,s=t('input[name="urm_payment_method"]:visible');return s.length>0&&s.each(function(){if("stripe"===t(this).val()&&t(this).is(":checked")){if(e?t(".membership-upgrade-container").find(".stripe-input-container .StripeElement--empty").length:t(".ur-frontend-form").find(".stripe-input-container .StripeElement--empty").length){i=!1;var n={error:{message:r.labels.i18n_empty_card_details}};a.card.emit("change",n)}}}),i&&n.clear_validation_error(),i},validate_coupon_data:function(){var e=t("#ur-membership-coupon").val(),a=t('input[name="urm_membership"]:checked'),i=t("#coupon-validation-error"),s=!0;return n.clear_validation_error(),e.length<1?(s=!1,n.show_validation_error(i,r.labels.i18n_error+"! "+r.labels.i18n_coupon_empty_error),s):0===a.length?(s=!1,n.show_validation_error(i,r.labels.i18n_error+"! "+r.labels.i18n_membership_required),s):"free"===a.data("urm-pg-type")?(s=!1,n.show_validation_error(i,r.labels.i18n_error+"! "+r.labels.i18n_coupon_free_membership_error),s):s},create_member:function(e){var t=this.prepare_members_data();t.username=e.data.username,this.send_data({action:"user_registration_membership_register_member",members_data:JSON.stringify(t),form_response:JSON.stringify(e.data)},{success:function(r){r.success?(n.show_success_message(r.data.message),i.handle_response(r,t,e)):n.show_failure_message(r.data.message)},failure:function(e,t){n.show_failure_message(r.labels.network_error+"("+t+")")},complete:function(){s.hide_loader(e.form_id)}})},handle_response:function(e,t,r){switch(t.payment_method){case"paypal":n.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"bank":this.show_bank_response(e,t,r);break;case"stripe":o.handle_stripe_response(e,t,r);break;case"authorize":n.show_success_message(e.data.message),window.location.replace(e.data.redirect);break;case"mollie":n.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;default:n.show_form_success_message(r,{username:t.username})}},show_bank_response:function(e,t,a){if(e.data.is_upgrading||e.data.is_renewing||e.data.is_purchasing_multiple)window.location.replace(r.membership_endpoint_url);else{var i={transaction_id:e.data.transaction_id,payment_type:"unpaid",info:e.data.pg_data.data,username:t.username};n.show_form_success_message(a,i)}},show_default_response:function(e,a,n){n=n||2e3;var i=r.thank_you_page_url,s=t.param(a).toString();window.setTimeout(function(){window.location.replace(i+"?"+s)},n)},validate_coupon:function(e){if(n.toggleSaveButtons(!0,e),n.append_spinner(e),this.validate_coupon_data()){var a={action:"user_registration_membership_validate_coupon",coupon_data:this.prepare_coupons_apply_data()},s=e.closest(".ur_membership_registration_container").find("input[name='urm_membership']:checked");s.data("urm-upgrade-type")&&(a.coupon_data.upgrade_amount=s.data("urm-pg-calculated-amount")),this.send_data(a,{success:function(e){e.success?i.handle_coupon_validation_response(e):n.show_failure_message(e.data.message)},failure:function(e,a){500===e.status?n.show_failure_message(r.labels.network_error+"("+a+")"):n.show_validation_error(t("#coupon-validation-error"),r.labels.i18n_error+"! "+e.responseJSON.data.message)},complete:function(){n.remove_spinner(e),n.toggleSaveButtons(!1,e)}})}else n.toggleSaveButtons(!1,e),n.remove_spinner(e)},handle_coupon_validation_response:function(e){t(".urm_apply_coupon").hide(),n.clear_validation_error(),t("#coupon-validation-error").removeClass("notice_red").addClass("notice_blue").text(e.data.message),e=JSON.parse(e.data.data);var a=t('input[name="urm_membership"]:checked'),s="";a.attr("data-ur-discount-amount",e.discount_amount),i.calculate_total(a),s="fixed"===e.coupon_details.coupon_discount_type?r.currency_symbol+""+e.coupon_details.coupon_discount:e.coupon_details.coupon_discount+"%",t("#total-input-notice").text(s+" "+r.labels.i18n_coupon_discount_message)},send_data:function(e,a){var n="function"==typeof a.success?a.success:function(){},i="function"==typeof a.failure?a.failure:function(){},s="function"==typeof a.beforeSend?a.beforeSend:function(){},o="function"==typeof a.complete?a.complete:function(){};!e._wpnonce&&r&&(e._wpnonce=r._nonce),t.ajax({type:"post",dataType:"json",url:r.ajax_url,data:e,beforeSend:s,success:n,error:i,complete:o})},calculate_total:function(e){var a=e.data("urm-pg-calculated-amount"),n=t("#ur-membership-total"),i=e.data("ur-discount-amount"),s=i!==undefined&&""!==i?a-i:a,o=e.data("urm-upgrade-type"),u=t(".urm-membership-total-value").find(".ur_membership_input_label");u.find(".user-registration-badge").length>0&&u.find(".user-registration-badge").remove(),o&&u.append('<span class="user-registration-badge">'+o+"</span>"),s=parseFloat(s).toFixed(2),"left"===r.curreny_pos?n.text(r.currency_symbol+s):n.text(s+r.currency_symbol)},upgrade_membership:function(e,t,a,s,o,u){"authorize"===o?this.handle_authorize_upgrade(e,t,a,s,o,u):this.send_data({_wpnonce:r.upgrade_membership_nonce,action:"user_registration_membership_upgrade_membership",form_data:e.form_data,form_id:e.form_id,current_membership_id:t,selected_membership_id:a,current_subscription_id:s,selected_pg:o,coupon:e.coupon},{success:function(e){if(e.success){n.show_success_message(e.data.message);var t={payment_method:o,username:e.data.username};i.handle_upgrade_response(e,t)}else n.show_failure_message(e.data.message)},failure:function(e,t){n.show_failure_message(user_registration_params.network_error+"("+t+")")},complete:function(){"stripe"!==o&&n.remove_spinner(u),n.toggleSaveButtons(!1,u)}})},renew_membership:function(e,t){this.send_data({_wpnonce:r.renew_membership_nonce,action:"user_registration_membership_renew_membership",selected_pg:e},{success:function(t){if(t.success){n.show_success_message(t.data.message);var r={payment_method:e,username:t.data.username};i.handle_renewal_response(t,r)}else n.show_failure_message(t.data.message)},failure:function(e,t){n.show_failure_message(user_registration_params.network_error+"("+t+")")},complete:function(){n.toggleSaveButtons(!1,t)}})},handle_authorize_upgrade:function(e,a,s,o,u,_){var d={current_plan:a,selected_membership_id:s,current_subscription_id:o,selected_pg:u,btn:_,form_data:e.form_data,coupon:e.coupon};t(document).trigger("urm_before_upgrade_membership_submit",{data:d,onComplete:function(a){i.send_data({_wpnonce:r.upgrade_membership_nonce,action:"user_registration_membership_upgrade_membership",current_membership_id:a.current_plan,selected_membership_id:a.selected_membership_id,current_subscription_id:a.current_subscription_id,selected_pg:a.selected_pg,ur_authorize_data:a.ur_authorize_data,form_data:e.form_data,coupon:e.coupon},{success:function(e){if(e.success){n.show_success_message(e.data.message);var r={payment_method:u,username:e.data.username};i.handle_upgrade_response(e,r)}else n.show_failure_message(e.data.message),t(document).find(".swal2-confirm").find("span").removeClass("urm-spinner")},failure:function(e,r){n.show_failure_message(user_registration_params.network_error+"("+r+")"),t(document).find(".swal2-confirm").find("span").removeClass("urm-spinner")},complete:function(){n.toggleSaveButtons(!1,_)}})}})},authorize_net_container_html:function(){return'<div id="authorize-net-container" class="urm-d-none membership-only authorize-net-container"><div data-field-id="authorizenet_gateway" class="ur-field-item field-authorize_net_gateway" data-ref-id="authorizenet_gateway" data-field-pattern-enabled="0" data-field-pattern-value=" " data-field-pattern-message=" "><div class="form-row" id="authorizenet_gateway_field"><label class="ur-label" for="Authorize.net">Authorize.net <abbr class="required" title="required">*</abbr></label><p></p><div id="user_registration_authorize_net_gateway" data-gateway="authorize_net" class="input-text" conditional_rules=""><div class="ur-field-row"><div class="user-registration-authorize-net-card-number"><input type="text" id="user_registration_authorize_net_card_number" name="user_registration_authorize_net_card_number" maxlength="16" placeholder="411111111111111" class="widefat ur-anet-sub-field user_registration_authorize_net_card_number"><br><label class="user-registration-sub-label">Card Number</label></div></div><div class="ur-field-row clearfix"><div class="user-registration-authorize-net-expiration user-registration-one-half"><div class="user-registration-authorize-net-expiration-month user-registration-one-half"><select class="widefat ur-anet-sub-field user_registration_authorize_net_expiration_month" id="user_registration_authorize_net_expiration_month" name="user_registration_authorize_net_expiration_month"><option> MM </option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select><label class="user-registration-sub-label">Expiration</label></div><div class="user-registration-authorize-net-expiration-year user-registration-one-half last"><select class="widefat ur-anet-sub-field user_registration_authorize_net_expiration_year" id="user_registration_authorize_net_expiration_year" name="user_registration_authorize_net_expiration_year"><option> YY </option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option></select></div></div><div class="user-registration-authorize-net-cvc user-registration-one-half last"><input type="text" id="user_registration_authorize_net_card_code" name="user_registration_authorize_net_card_code" placeholder="900" maxlength="4" class="widefat ur-anet-sub-field user_registration_authorize_net_card_code"><br><label class="user-registration-sub-label">CVC</label></div></div></div></div></div></div>'},prepare_pg_html:function(e){var r="";return t.each(e,function(t,a){var n=a.toLowerCase();r+='<label class="ur_membership_input_label ur-label" for="ur-membership-'+n+'"><input class="ur_membership_input_class pg-list" data-key-name="ur-payment-method" id="ur-membership-'+n+'" type="radio" name="urm_payment_method" '+(0===t&&e&&1===e.length?"checked":"")+' required value="'+n+'"><span class="ur-membership-duration">'+n.charAt(0).toUpperCase()+n.slice(1)+"</span></label>"}),r},prepare_renew_membership_html:function(e){return'<div class="membership-upgrade-container"><div class="ur_membership_registration_container"><div class="ur_membership_frontend_input_container urm_hidden_payment_container ur_payment_gateway_container"><div id="payment-gateway-body" class="ur_membership_frontend_input_container">'+i.prepare_pg_html(e)+'<span id="payment-gateway-notice" class="notice_red"></span></div></div><div class="ur_membership_frontend_input_container"><div class="stripe-container urm-d-none"><button type="button" class="stripe-card-indicator ur-stripe-element-selected" id="credit_card">Credit Card</button><div class="stripe-input-container"><div id="card-element"></div></div></div></div>'+i.authorize_net_container_html()+'</div><span id="upgrade-membership-notice"></span></div>'},prepare_upgrade_membership_html:function(e){var a=t("#membership-title").text()||"",n="",s=r.membership_gateways||[];return t.each(e,function(e,t){var r=t.ID||"",a=t.title||"",i=t.type||"",s=t.period||"",o=t.calculated_amount||"",u=(t.amount,t.active_payment_gateways||"{}");n+='<label class="upgrade-membership-label" for="ur-membership-select-membership-'+r+'"><input class="ur_membership_input_class ur_membership_radio_input ur-frontend-field" id="ur-membership-select-membership-'+r+'" type="radio" name="urm_membership" data-label="'+a+'" required="required" value="'+r+"\" data-urm-pg='"+u+"' data-urm-pg-type=\""+i+'" data-urm-pg-calculated-amount="'+o+'"><span class="ur-membership-duration">'+a+'</span><span class="ur-membership-duration"> - '+s+"</span></label>"}),'<div class="membership-upgrade-container"><span>Your current Plan is <b>'+a+'</b></span><div class="upgrade-plan-container"><span class="ur-upgrade-label">Select Plan</span><div id="upgradable-plans">'+n+'</div></div><div class="ur_membership_registration_container urm-d-none"><div class="ur_membership_frontend_input_container urm_hidden_payment_container ur_payment_gateway_container urm-d-none"><span class="ur-upgrade-label ur-label required">Select Payment Gateway</span><div id="payment-gateway-body" class="ur_membership_frontend_input_container">'+i.prepare_pg_html(s)+'<span id="payment-gateway-notice" class="notice_red"></span></div></div><div class="ur_membership_frontend_input_container"><div class="stripe-container urm-d-none"><button type="button" class="stripe-card-indicator ur-stripe-element-selected" id="credit_card">Credit Card</button><div class="stripe-input-container"><div id="card-element"></div></div></div></div>'+i.authorize_net_container_html()+"</div></div>"},handle_upgrade_response:function(e,t){switch(t.payment_method){case"paypal":n.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"stripe":o.handle_stripe_response(e,t,{data:{}});break;case"mollie":n.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"authorize":window.location.replace(e.data.redirect);break;case"free":window.location.origin,window.location.pathname;window.location.replace(e.data.pg_data.payment_url);default:i.show_bank_response(e,{username:t.username,payment_method:t.payment_method},{data:{}})}},handle_renewal_response:function(e,t){switch(t.payment_method){case"paypal":n.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"stripe":o.handle_stripe_response(e,t,{data:{}});break;default:i.show_bank_response(e,{username:t.username,payment_method:t.payment_method},{data:{}})}},cancel_delayed_subscription:function(e){n.toggleSaveButtons(!0,e),n.append_spinner(e),this.send_data({_wpnonce:r.upgrade_membership_nonce,action:"user_registration_membership_cancel_upcoming_subscription"},{success:function(e){e.success?(Swal.close(),n.show_success_message(e.data.message)):n.show_failure_message(e.data.message)},failure:function(e,t){n.show_failure_message(r.labels.network_error+" ("+e.statusText+")")},complete:function(){n.remove_spinner(e),n.toggleSaveButtons(!1,e)}})}},s={hide_loader:function(e){var r=t("#user-registration-form-"+e);r.find(".ur-submit-button").find("span").removeClass("ur-front-spinner"),r.find("form").find(".ur-submit-button").prop("disabled",!1)}},o={show_stripe_error:function(e){if($membership_registration_form.find("#stripe-errors").length>0)$membership_registration_form.find("#stripe-errors").html(e).show();else{var t='<label id="stripe-errors" class="user-registration-error" role="alert">'+e+"</label>";$membership_registration_form.find(".stripe-container").closest(".ur_membership_frontend_input_container").append(t)}},init:function(e){a=o.setupElements(),$membership_registration_form=t(e?".membership-upgrade-container":"#ur-membership-registration"),this.triggerInputChange()},triggerInputChange:function(){a.card.addEventListener("change",function(e){e.error?o.show_stripe_error(e.error.message):$membership_registration_form.find("#stripe-errors").length>0&&$membership_registration_form.find("#stripe-errors").remove()})},setupElements:function(){var e=Stripe(r.stripe_publishable_key),t=e.elements(),a={base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#8f9194"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}},n=t.create("card",{style:a,hidePostalCode:"1"==r.urm_hide_stripe_card_postal_code}),i=t.create("idealBank",{style:a});return n.mount("#card-element"),{stripe:e,card:n,ideal:i,clientSecret:""}},handle_stripe_response:function(e,t,r){"paid"===e.data.pg_data.type?this.handle_one_time_payment(e,t,r):this.handle_recurring_payment(e,{paymentElements:a,user_id:e.data.member_id,response_data:e,prepare_members_data:t,form_response:r})},handle_one_time_payment:function(e,r,i){a.stripe.confirmCardPayment(e.data.pg_data.client_secret,{payment_method:{card:a.card}}).then(function(a){var s=t(".membership_register_button");n.toggleSaveButtons(!0,s),n.append_spinner(s),o.update_order_status(a,e,r,i)})},update_order_status:function(e,a,u,_){i.send_data({_wpnonce:r._confirm_payment_nonce,action:"user_registration_membership_confirm_payment",members_data:JSON.stringify(u),member_id:a.data.member_id,payment_status:e.error?"failed":"succeeded",form_response:JSON.stringify(_.data),payment_result:e},{success:function(t){if(t.success)if(t.data.is_upgrading||t.data.is_renewing){var a={username:u.username,message:t.data.message};t.data.is_upgrading?a.is_upgrading=t.data.is_upgrading:t.data.is_renewing&&(a.is_renewing=t.data.is_renewing),i.show_default_response(window.location.href,a)}else i.show_default_response(r.thank_you_page_url,{username:u.username,transaction_id:e.paymentIntent.id});else o.show_stripe_error(t.data.message),s.hide_loader(_.form_id)},failure:function(e,t){n.show_failure_message(r.labels.i18n_error+"("+e.responseJSON.data.message+")")},complete:function(){var e=t(".swal2-confirm ");s.hide_loader(_.form_id),n.toggleSaveButtons(!1,e),n.remove_spinner(e)}})},handle_recurring_payment:function(e,r){Promise.resolve(t.extend({},r,{customer_id:e.data.pg_data.stripe_cus_id})).then(o.createPaymentMethod).then(o.createSubscription).then(o.handleCustomerActionRequired).then(o.handleOnComplete)["catch"](function(t,a){o.update_order_status({error:{}},e,r.prepare_members_data,r.form_response)})},createPaymentMethod:function(e){return new Promise(function(r,a){var i=t(".membership_register_button");n.toggleSaveButtons(!0,i),n.append_spinner(i),e.paymentElements.stripe.createPaymentMethod({type:"card",card:e.paymentElements.card}).then(function(n){n.error?a(n.error.message,n):r(t.extend({},e,{payment_method_id:n.paymentMethod.id}))})["catch"](function(e){a(e,result)})})},createSubscription:function(e){return new Promise(function(a,o){i.send_data({_wpnonce:r._confirm_payment_nonce,action:"user_registration_membership_create_stripe_subscription",member_id:e.user_id,customer_id:e.customer_id,payment_method_id:e.payment_method_id,form_response:JSON.stringify(e.form_response.data)},{success:function(r){if(r.success){var n=r.data.subscription.latest_invoice.payment_intent;if(r.error){var i=r.error.message;return void o(i,e)}if("trialing"!==r.data.subscription.status&&n&&"requires_payment_method"===n.status){o(r,i="Your card was declined")}a(t.extend({},e,{subscription:r.data.subscription,message:r.data.message}))}else s.hide_loader(e.form_id),o(r,i)},failure:function(e,t){n.show_failure_message(r.labels.network_error+"("+t+")")}})})},handleCustomerActionRequired:function(e){return new Promise(function(t,r){!e.subscription||"active"!==e.subscription.status&&"trialing"!==e.subscription.status||t({subscription:e.subscription,response_data:e.response_data,message:e.message,prepare_members_data:e.prepare_members_data,form_response:e.form_response});var a=e.subscription.latest_invoice.payment_intent;"trialing"!==e.subscription.status&&"requires_action"===a.status&&e.paymentElements.stripe.confirmCardPayment(a.client_secret,{payment_method:e.paymentMethodId}).then(function(a){if(a.error){var n=a.error.message;r(n,e)}else if("succeeded"===a.paymentIntent.status)e.subscription.status="active",t({subscription:e.subscription,form_id:e.form_response.form_id,response_data:e.response_data,prepare_members_data:e.prepare_members_data,form_response:e.form_response,three_d_secure:!0});else{r(n="Unable to complete the payment.",e)}})})},handleOnComplete:function(e){var t=e.response_data.data.is_upgrading!==undefined&&e.response_data.data.is_upgrading,r=e.response_data.data.is_renewing!==undefined&&e.response_data.data.is_renewing;(t||r||!0===e.three_d_secure)&&o.update_order_status(e.subscription,e.response_data,e.prepare_members_data,e.form_response),!e.subscription||"active"!==e.subscription.status&&"trialing"!==e.subscription.status||t||r||n.show_form_success_message(e.form_response,{username:e.prepare_members_data.username,transaction_id:e.subscription.id})}};(function(){t('input[name="urm_payment_method"]').on("change",function(){var e=t(this).val(),i=t(".stripe-container"),s=t("#stripe-errors"),u=t(".authorize-net-container"),_=t("#authorize-errors");if(i.addClass("urm-d-none"),s.remove(),u.addClass("urm-d-none"),_.remove(),a={},"stripe"===e){if(0==r.stripe_publishable_key.length)return void n.show_failure_message(r.labels.i18n_incomplete_stripe_setup_error);i.removeClass("urm-d-none"),o.init()}"authorize"===e&&u.removeClass("urm-d-none")}),t(document).on("change",'input[name="urm_membership"]',function(){t(".ur_membership_registration_container").removeClass("urm-d-none"),t("#total-input-notice").text("");t(this).data("urm-pg");var e=t(this).data("urm-pg-type"),a=t(".ur_payment_gateway_container"),n=a.find("input"),s=t(".urm_hidden_payment_container"),u=t(".stripe-container"),_=t("#stripe-errors"),d=t("#upgrade-membership-notice"),m=t(this).data("urm-default-pg");"yes"===t(this).data("has-coupon-link")?t(document).find("#ur_coupon_container").show():t(document).find("#ur_coupon_container").hide();var p=t(".authorize-net-container");if(t("#authorize-errors").remove(),_.remove(),d.text(""),m&&m.toLowerCase()===m?(t(this).closest("#ur-membership-registration").find("#ur-membership-"+m).prop("checked",!0).trigger("change"),"stripe"===m.toLowerCase()&&o.init(),"authorize"!==m.toLowerCase()&&p.addClass("urm-d-none")):(t('input[name="urm_payment_method"]').prop("checked",!1),u.addClass("urm-d-none")),s.addClass("urm-d-none"),t(".urm_apply_coupon").show(),"free"!==e){if(r.gateways_configured&&Object.keys(r.gateways_configured).length>0&&(s.removeClass("urm-d-none"),n.each(function(e,a){var n=t(a).val(),i=t('label[for="ur-membership-'+n+'"]');i.removeClass("urm-d-none"),n in r.gateways_configured||i.addClass("urm-d-none")})),1===a.find("input:visible").length){var c=a.find("input:visible");t(c[0]).prop("checked",!0),c.trigger("change")}i.calculate_total(t(this))}else u.addClass("urm-d-none")});var s=new URLSearchParams(window.location.search),u=t('input[name="urm_membership"]');t(document).on("user_registration_membership_update_before_form_submit",function(e,r){e.preventDefault();var a="free",n="",o=(t('input[name="urm_membership"]:checked').data("urm-pg-type"),t(this));n=t('input[name="urm_membership"]:checked').val(),a=t('input[name="urm_payment_method"]:checked').val()===undefined?a:t('input[name="urm_payment_method"]:checked').val();var u=s.get("action"),_=s.get("current"),d=s.get("subscription_id");"multiple"==u?i.add_multiple_membership(n,a,o):"upgrade"==u&&(t("#ur-membership-coupon").length>0&&(r.coupon=t("#ur-membership-coupon").val().trim()),i.upgrade_membership(r,_,n,d,a,o))}),s.has("membership_id")&&t('input[name="urm_membership"]:checked').change(),u!==undefined&&1===u.length&&t(u[0]).prop("checked",!0).change(),t(".close_notice").on("click",n.toggleNotice),t("#ur-membership-password").on("keyup change",function(){var e=t(this).val(),a=t("#password-notice"),i=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*()_+}{\"':;?/>.<,]).*$");if(n.show_validation_error(a,""),e.length<8)n.show_validation_error(a,r.labels.i18n_field_password_field_length_validation);else{if(i.test(e))return!0;n.show_validation_error(a,r.labels.i18n_field_password_field_regex_validation)}}),t("#ur-membership-confirm-password").on("keyup",function(){var e=t(this).val(),a=t("#ur-membership-password").val(),i=t("#confirm-password-notice");if(n.show_validation_error(i,""),0===a.length&&n.show_validation_error(i,r.labels.i18n_field_password_empty_validation),e===a)return!0;n.show_validation_error(i,r.labels.i18n_field_confirm_password_field_validation)}),t(document).on("click",".urm_apply_coupon",function(){i.validate_coupon(t(this))}),t(document).on("click",".ur_clear_coupon",function(){t("#ur-membership-coupon").val(""),t("#coupon-validation-error").text(""),t(".urm_apply_coupon").show(),t("#total-input-notice").text("");var e=t('input[name="urm_membership"]:checked');e.removeData("ur-discount-amount").removeAttr("data-ur-discount-amount"),i.calculate_total(e)}),t(document).on("click","#membership-old-selection-form .membership-signup-button",function(){if(r.isEditor)e.preventDefault();else{var a=t(this).closest("form");if(a.hasClass("layout-list"))var n=a.find('input[name="membership_id"]:checked').val(),i=a.find('input[name="redirection_url"]').val(),s=a.find('input[name="thank_you_page_id"]').val(),o=a.find('input[name="urm_uuid"]').val();else{var u=t(this);n=u.siblings('input[name="membership_id"]').val(),i=u.siblings('input[name="redirection_url"]').val(),s=u.siblings('input[name="thank_you_page_id"]').val(),o=u.siblings('input[name="urm_uuid"]').val()}var _=i+"?membership_id="+n+"&urm_uuid="+o+"&thank_you="+s;"_blank"!==t(this).attr("target")?window.location.replace(_):window.open(_,"_blank")}}),t(document).on("user_registration_frontend_validate_before_form_submit",function(){i.validate_membership_form()}),t(document).on("user_registration_frontend_before_form_submit",function(e,r,a,n){t(a).find("#ur-membership-registration").length>0&&(r.is_membership_active=t(a).find('input[name="urm_membership"]:checked').val(),r.membership_type=t('input[name="urm_membership"]:checked').val())}),t(document).on("user_registration_frontend_before_ajax_complete_success_message",function(e,r,a,n){var s=!0,o=JSON.parse(r.responseText),u={data:o.data,form_id:t(n).data("form-id")};"undefined"!=typeof o.data.registration_type&&"membership"===o.data.registration_type&&(s=!1,i.create_member(u)),a.status=s}),t(document).on("change",'.membership-upgrade-container input[name="urm_payment_method"]',function(){var e=t(this).val(),i=t(".stripe-container"),s=t("#stripe-errors"),u=t("#upgrade-membership-notice"),_=t(".authorize-net-container"),d=t("#authorize-errors");if(u.text(""),i.addClass("urm-d-none"),s.remove(),_.addClass("urm-d-none"),d.remove(),a={},"stripe"===e){if(0==r.stripe_publishable_key.length)return void n.show_failure_message(r.labels.i18n_incomplete_stripe_setup_error);i.removeClass("urm-d-none"),o.init(!0)}"authorize"===e&&_.removeClass("urm-d-none")}),t(document).on("click",".cancel-membership-button",function(e){e.preventDefault();var a=t(this),n=t("#membership-error-div"),i=a.text(),s=t("#membership-title").text();Swal.fire({icon:"warning",title:r.labels.i18n_cancel_membership_text+" "+s.trim(),text:r.labels.i18n_cancel_membership_subtitle,customClass:"user-registration-upgrade-membership-swal2-container",showConfirmButton:!0,showCancelButton:!0}).then(function(e){e.isConfirmed&&t.ajax({url:r.ajax_url,type:"POST",data:{action:"user_registration_membership_cancel_subscription",security:r._nonce,subscription_id:a.data("id")},beforeSend:function(){a.text(r.labels.i18n_sending_text)},success:function(e){e.success?(n.hasClass("btn-error")&&(n.removeClass("btn-error"),n.addClass("btn-success")),n.text(e.data.message),n.show(),location.reload()):(n.hasClass("btn-success")&&(n.removeClass("btn-success"),n.addClass("btn-error")),n.text(e.data.message),n.show())},complete:function(){a.text(i)}})})}),t(document).on("click",".reactivate-membership-button",function(e){e.preventDefault();var a=t(this),n=t("#membership-error-div"),i=a.text();t("#membership-title").text();t.ajax({url:r.ajax_url,type:"POST",data:{action:"user_registration_membership_reactivate_membership",security:r._nonce,subscription_id:a.data("id")},beforeSend:function(){a.text(r.labels.i18n_sending_text)},success:function(e){e.success?(n.hasClass("btn-error")&&(n.removeClass("btn-error"),n.addClass("btn-success")),n.text(e.data.message),n.show(),location.reload()):(n.hasClass("btn-success")&&(n.removeClass("btn-success"),n.addClass("btn-error")),n.text(e.data.message),n.show())},complete:function(){a.text(i)}})}),t(document).on("click",".renew-membership-button",function(e){e.preventDefault();var a=t(this),s="free",o=a.data("pg-gateways").split(","),u=i.prepare_renew_membership_html(o);a.attr("disabled",!0),n.append_spinner(a),Swal.fire({title:r.labels.i18n_field_select_payment_gateway,html:u,customClass:"user-registration-upgrade-membership-swal2-container",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:user_registration_params.user_registration_membership_renew_plan_button_text,confirmButtonColor:"#475BB2",didOpen:function(){t('.membership-upgrade-container input[name="urm_payment_method"]').trigger("change")},preConfirm:function(e){t('input[name="urm_membership"]:checked').data("urm-pg-type");var r=t(".swal2-confirm");return!(r.find("span.urm-spinner").length>0)&&(n.append_spinner(r),r.attr("disabled",!0),s=t('input[name="urm_payment_method"]:checked').val()===undefined?s:t('input[name="urm_payment_method"]:checked').val(),i.renew_membership(s,r),!1)},allowOutsideClick:!1}).then(function(e){e.isConfirmed||(a.attr("disabled",!1),n.remove_spinner(a))})}),t("#membership-error-div .cancel-notice").on("click",function(){t(this).siblings("span").text(""),t(this).closest("#membership-error-div").hide()}),t(".field-membership").length&&t(".field-membership").each(function(e,r){if(t(r).find(".no-membership")){var a=t(r).find(".no-membership").attr("data-form-id");t("#user-registration-form-"+a).find(".ur-submit-button").prop("disabled",!0)}}),t(".view-bank-data").on("click",function(){Swal.fire({title:r.labels.i18n_bank_details_title,html:t(".upgrade-info").html(),customClass:"user-registration-upgrade-membership-swal2-container",showCancelButton:!1,showConfirmButton:!1})})})()}(jQuery,window.ur_membership_frontend_localized_data);