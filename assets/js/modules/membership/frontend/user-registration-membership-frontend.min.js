!function(e,t){var r={},a={append_spinner:function(e){if(e&&e.append){return e.append('<span class="urm-spinner is-active"></span>'),!0}return!1},remove_spinner:function(e){return!(!e||!e.remove)&&(e.find(".urm-spinner").remove(),!0)},convert_to_array:function(e){return Object.values(e).reverse().slice(2).reverse()},toggleSaveButtons:function(t,r){t=this.if_empty(t,!0),e(r).prop("disabled",!!t)},if_empty:function(e,t){return null===e||undefined===e||""===e?t:e},clear_validation_error:function(){e("span.notice_red").each(function(){e(this).text("")})},show_validation_error:function(t,r){t.removeClass("notice_blue").addClass("notice_red").text(r),this.clear_validation_error();t.siblings("input");e("html, body").animate({scrollTop:t.parent().offset().top},200),t.text(r)},toggleNotice:function(){e(".notice-container").toggleClass("active"),setTimeout(this.toggleNotice,5e3)},show_failure_message:function(t){e(".notice-container .notice_blue").removeClass("notice_blue").addClass("notice_red"),e(".notice_message").text(t),this.toggleNotice()},show_success_message:function(t){e(".notice-container .notice_red").removeClass("notice_red").addClass("notice_blue"),e(".notice_message").text(t),this.toggleNotice()},show_form_success_message:function(r,a){var i=r.data,s=user_registration_params.ursL10n,o=e("#user-registration-form-"+r.form_id),u=e('<ul class=""/>'),_=i.success_message_positon,m=t.thank_you_page_url;"undefined"!=typeof i.role_based_redirect_url&&(m=i.role_based_redirect_url),"undefined"!=typeof i.redirect_url&&(m=i.redirect_url),o.find(".ur-submit-button").find("span").removeClass("ur-front-spinner"),"admin_approval"==i.form_login_option?u.append("<li>"+s.user_under_approval+"</li>"):"email_confirmation"===i.form_login_option||"admin_approval_after_email_confirmation"===i.form_login_option?u.append("<li>"+s.user_email_pending+"</li>"):u.append("<li>"+s.user_successfully_saved+"</li>"),o.find("form")[0].reset();var d=e('<div class="ur-message user-registration-message" id="ur-submit-message-node"/>');d.append(u),"1"===_?(o.find("form").append(d),e(window).scrollTop(o.find("form").find(".ur-button-container").offset().top)):(o.find("form").prepend(d),e(window).scrollTop(o.find("form").closest(".ur-frontend-form").offset().top)),o.find("form").find(".ur-submit-button").prop("disabled",!1),void 0!==m&&""!==m?n.show_default_response(m,a):"undefined"!=typeof i.auto_login&&i.auto_login&&n.show_default_response(m,a)},isEventRegistered:function(t,r){var a=e._data(e(t)[0],"events");return a&&a[r]}},n={prepare_members_data:function(){var t={},r=e("#ur-membership-registration").find("input.ur_membership_input_class");(r=a.convert_to_array(r)).forEach(function(r){var a=e(r);if(a.attr("name")!==undefined){var n=a.attr("name").toLowerCase().replace("urm_","");t[n]=a.val()}});var n=e('input[name="urm_membership"]:checked');t.membership=n.val(),t.payment_method="free","free"!==n.data("urm-pg-type")&&(t.payment_method=e('input[name="urm_payment_method"]:checked:visible').val());var i=new Date;return t.start_date=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),t},prepare_coupons_apply_data:function(){var t={};return t.coupon=e("#ur-membership-coupon").val(),t.membership_id=e('input[name="urm_membership"]:checked').val(),t},validate_membership_form:function(n){void 0===n&&(n=!1);var i=!0,s=e('input[name="urm_payment_method"]:visible');return s.length>0&&s.each(function(){if("stripe"===e(this).val()&&e(this).is(":checked")){if(n?e(".membership-upgrade-container").find(".stripe-input-container .StripeElement--empty").length:e(".ur-frontend-form").find(".stripe-input-container .StripeElement--empty").length){i=!1;var a={error:{message:t.labels.i18n_empty_card_details}};r.card.emit("change",a)}}}),i&&a.clear_validation_error(),i},validate_coupon_data:function(){var r=e("#ur-membership-coupon").val(),n=e('input[name="urm_membership"]:checked'),i=e("#coupon-validation-error"),s=!0;return a.clear_validation_error(),r.length<1?(s=!1,a.show_validation_error(i,t.labels.i18n_error+"! "+t.labels.i18n_coupon_empty_error),s):0===n.length?(s=!1,a.show_validation_error(i,t.labels.i18n_error+"! "+t.labels.i18n_membership_required),s):"free"===n.data("urm-pg-type")?(s=!1,a.show_validation_error(i,t.labels.i18n_error+"! "+t.labels.i18n_coupon_free_membership_error),s):s},create_member:function(e){var r=this.prepare_members_data();r.username=e.data.username,this.send_data({action:"user_registration_membership_register_member",members_data:JSON.stringify(r),form_response:JSON.stringify(e.data)},{success:function(t){t.success?(a.show_success_message(t.data.message),n.handle_response(t,r,e)):a.show_failure_message(t.data.message)},failure:function(e,r){a.show_failure_message(t.labels.network_error+"("+r+")")},complete:function(){i.hide_loader(e.form_id)}})},handle_response:function(e,t,r){switch(t.payment_method){case"paypal":a.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"bank":this.show_bank_response(e,t,r);break;case"stripe":s.handle_stripe_response(e,t,r);break;case"authorize":a.show_success_message(e.data.message),window.location.replace(e.data.redirect);break;case"mollie":a.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;default:a.show_form_success_message(r,{username:t.username})}},show_bank_response:function(e,t,r){if(e.data.is_upgrading||e.data.is_renewing)location.reload();else{var n={transaction_id:e.data.transaction_id,payment_type:"unpaid",info:e.data.pg_data.data,username:t.username};a.show_form_success_message(r,n)}},show_default_response:function(t,r){var a=e.param(r).toString();window.setTimeout(function(){window.location.replace(t+"?"+a)},1e3)},validate_coupon:function(r){a.toggleSaveButtons(!0,r),a.append_spinner(r),this.validate_coupon_data()?this.send_data({action:"user_registration_membership_validate_coupon",coupon_data:this.prepare_coupons_apply_data()},{success:function(e){e.success?n.handle_coupon_validation_response(e):a.show_failure_message(e.data.message)},failure:function(r,n){500===r.status?a.show_failure_message(t.labels.network_error+"("+n+")"):a.show_validation_error(e("#coupon-validation-error"),t.labels.i18n_error+"! "+r.responseJSON.data.message)},complete:function(){a.remove_spinner(r),a.toggleSaveButtons(!1,r)}}):(a.toggleSaveButtons(!1,r),a.remove_spinner(r))},handle_coupon_validation_response:function(r){e(".urm_apply_coupon").hide(),a.clear_validation_error(),e("#coupon-validation-error").removeClass("notice_red").addClass("notice_blue").text(r.data.message),r=JSON.parse(r.data.data);var i=e('input[name="urm_membership"]:checked'),s="";i.attr("data-ur-discount-amount",r.discount_amount),n.calculate_total(i),s="fixed"===r.coupon_details.coupon_discount_type?t.currency_symbol+""+r.coupon_details.coupon_discount:r.coupon_details.coupon_discount+"%",e("#total-input-notice").text(s+" "+t.labels.i18n_coupon_discount_message)},send_data:function(r,a){var n="function"==typeof a.success?a.success:function(){},i="function"==typeof a.failure?a.failure:function(){},s="function"==typeof a.beforeSend?a.beforeSend:function(){},o="function"==typeof a.complete?a.complete:function(){};!r._wpnonce&&t&&(r._wpnonce=t._nonce),e.ajax({type:"post",dataType:"json",url:t.ajax_url,data:r,beforeSend:s,success:n,error:i,complete:o})},calculate_total:function(r){var a=r.data("urm-pg-calculated-amount"),n=e("#ur-membership-total"),i=r.data("ur-discount-amount"),s=i!==undefined&&""!==i?a-i:a;n.val(t.currency_symbol+s)},upgrade_membership:function(e,r,i,s,o){"authorize"===s?this.handle_authorize_upgrade(e,r,i,s,o):this.send_data({_wpnonce:t.upgrade_membership_nonce,action:"user_registration_membership_upgrade_membership",current_membership_id:e,selected_membership_id:r,current_subscription_id:i,selected_pg:s},{success:function(e){if(e.success){a.show_success_message(e.data.message);var t={payment_method:s,username:e.data.username};n.handle_upgrade_response(e,t)}else a.show_failure_message(e.data.message)},failure:function(e,t){a.show_failure_message(user_registration_pro_frontend_data.network_error+"("+t+")")},complete:function(){"stripe"!==s&&a.remove_spinner(o),a.toggleSaveButtons(!1,o)}})},renew_membership:function(e,r){this.send_data({_wpnonce:t.renew_membership_nonce,action:"user_registration_membership_renew_membership",selected_pg:e},{success:function(t){if(t.success){a.show_success_message(t.data.message);var r={payment_method:e,username:t.data.username};n.handle_renewal_response(t,r)}else a.show_failure_message(t.data.message)},failure:function(e,t){a.show_failure_message(user_registration_pro_frontend_data.network_error+"("+t+")")},complete:function(){a.toggleSaveButtons(!1,r)}})},handle_authorize_upgrade:function(r,i,s,o,u){var _={current_plan:r,selected_membership_id:i,current_subscription_id:s,selected_pg:o,btn:u};e(document).trigger("urm_before_upgrade_membership_submit",{data:_,onComplete:function(r){n.send_data({_wpnonce:t.upgrade_membership_nonce,action:"user_registration_membership_upgrade_membership",current_membership_id:r.current_plan,selected_membership_id:r.selected_membership_id,current_subscription_id:r.current_subscription_id,selected_pg:r.selected_pg,ur_authorize_data:r.ur_authorize_data},{success:function(t){if(t.success){a.show_success_message(t.data.message);var r={payment_method:o,username:t.data.username};n.handle_upgrade_response(t,r)}else a.show_failure_message(t.data.message),e(document).find(".swal2-confirm").find("span").removeClass("urm-spinner")},failure:function(t,r){a.show_failure_message(user_registration_pro_frontend_data.network_error+"("+r+")"),e(document).find(".swal2-confirm").find("span").removeClass("urm-spinner")},complete:function(){a.toggleSaveButtons(!1,u)}})}})},authorize_net_container_html:function(){return'<div id="authorize-net-container" class="urm-d-none membership-only authorize-net-container"><div data-field-id="authorizenet_gateway" class="ur-field-item field-authorize_net_gateway" data-ref-id="authorizenet_gateway" data-field-pattern-enabled="0" data-field-pattern-value=" " data-field-pattern-message=" "><div class="form-row" id="authorizenet_gateway_field"><label class="ur-label" for="Authorize.net">Authorize.net <abbr class="required" title="required">*</abbr></label><p></p><div id="user_registration_authorize_net_gateway" data-gateway="authorize_net" class="input-text" conditional_rules=""><div class="ur-field-row"><div class="user-registration-authorize-net-card-number"><input type="text" id="user_registration_authorize_net_card_number" name="user_registration_authorize_net_card_number" maxlength="16" placeholder="411111111111111" class="widefat ur-anet-sub-field user_registration_authorize_net_card_number"><br><label class="user-registration-sub-label">Card Number</label></div></div><div class="ur-field-row clearfix"><div class="user-registration-authorize-net-expiration user-registration-one-half"><div class="user-registration-authorize-net-expiration-month user-registration-one-half"><select class="widefat ur-anet-sub-field user_registration_authorize_net_expiration_month" id="user_registration_authorize_net_expiration_month" name="user_registration_authorize_net_expiration_month"><option> MM </option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select><label class="user-registration-sub-label">Expiration</label></div><div class="user-registration-authorize-net-expiration-year user-registration-one-half last"><select class="widefat ur-anet-sub-field user_registration_authorize_net_expiration_year" id="user_registration_authorize_net_expiration_year" name="user_registration_authorize_net_expiration_year"><option> YY </option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option></select></div></div><div class="user-registration-authorize-net-cvc user-registration-one-half last"><input type="text" id="user_registration_authorize_net_card_code" name="user_registration_authorize_net_card_code" placeholder="900" maxlength="4" class="widefat ur-anet-sub-field user_registration_authorize_net_card_code"><br><label class="user-registration-sub-label">CVC</label></div></div></div></div></div></div>'},prepare_pg_html:function(t){var r="";return e.each(t,function(e,a){var n=a.toLowerCase();r+='<label class="ur_membership_input_label ur-label" for="ur-membership-'+n+'"><input class="ur_membership_input_class pg-list" data-key-name="ur-payment-method" id="ur-membership-'+n+'" type="radio" name="urm_payment_method" '+(0===e&&t&&1===t.length?"checked":"")+' required value="'+n+'"><span class="ur-membership-duration">'+n.charAt(0).toUpperCase()+n.slice(1)+"</span></label>"}),r},prepare_renew_membership_html:function(e){return'<div class="membership-upgrade-container"><div class="ur_membership_registration_container"><div class="ur_membership_frontend_input_container urm_hidden_payment_container ur_payment_gateway_container"><div id="payment-gateway-body" class="ur_membership_frontend_input_container">'+n.prepare_pg_html(e)+'<span id="payment-gateway-notice" class="notice_red"></span></div></div><div class="ur_membership_frontend_input_container"><div class="stripe-container urm-d-none"><button type="button" class="stripe-card-indicator ur-stripe-element-selected" id="credit_card">Credit Card</button><div class="stripe-input-container"><div id="card-element"></div></div></div></div>'+n.authorize_net_container_html()+'</div><span id="upgrade-membership-notice"></span></div>'},prepare_upgrade_membership_html:function(r){var a=e("#membership-title").text()||"",i="",s=t.membership_gateways||[];return e.each(r,function(e,t){var r=t.ID||"",a=t.title||"",n=t.type||"",s=t.period||"",o=t.calculated_amount||"",u=t.active_payment_gateways||"{}";i+='<label class="upgrade-membership-label" for="ur-membership-select-membership-'+r+'"><input class="ur_membership_input_class ur_membership_radio_input ur-frontend-field" id="ur-membership-select-membership-'+r+'" type="radio" name="urm_membership" data-label="'+a+'" required="required" value="'+r+"\" data-urm-pg='"+u+"' data-urm-pg-type=\""+n+'" data-urm-pg-calculated-amount="'+o+'"><span class="ur-membership-duration">'+a+'</span><span class="ur-membership-duration"> - '+s+"</span></label>"}),'<div class="membership-upgrade-container"><span>Your current Plan is <b>'+a+'</b></span><div class="upgrade-plan-container"><span class="ur-upgrade-label">Select Plan</span><div id="upgradable-plans">'+i+'</div></div><div class="ur_membership_registration_container"><div class="ur_membership_frontend_input_container urm_hidden_payment_container ur_payment_gateway_container urm-d-none"><span class="ur-upgrade-label ur-label required">Select Payment Gateway</span><div id="payment-gateway-body" class="ur_membership_frontend_input_container">'+n.prepare_pg_html(s)+'<span id="payment-gateway-notice" class="notice_red"></span></div></div><div class="ur_membership_frontend_input_container"><div class="stripe-container urm-d-none"><button type="button" class="stripe-card-indicator ur-stripe-element-selected" id="credit_card">Credit Card</button><div class="stripe-input-container"><div id="card-element"></div></div></div></div>'+n.authorize_net_container_html()+'</div><span id="upgrade-membership-notice"></span></div>'},handle_upgrade_response:function(e,t){switch(t.payment_method){case"paypal":a.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"stripe":s.handle_stripe_response(e,t,{data:{}});break;case"mollie":a.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"authorize":case"free":location.reload();break;default:n.show_bank_response(e,{username:t.username,payment_method:t.payment_method},{data:{}})}},handle_renewal_response:function(e,t){switch(t.payment_method){case"paypal":a.show_success_message(e.data.message),window.location.replace(e.data.pg_data.payment_url);break;case"stripe":s.handle_stripe_response(e,t,{data:{}});break;default:n.show_bank_response(e,{username:t.username,payment_method:t.payment_method},{data:{}})}},cancel_delayed_subscription:function(e){a.toggleSaveButtons(!0,e),a.append_spinner(e),this.send_data({_wpnonce:t.upgrade_membership_nonce,action:"user_registration_membership_cancel_upcoming_subscription"},{success:function(e){e.success?(Swal.close(),a.show_success_message(e.data.message)):a.show_failure_message(e.data.message)},failure:function(e,r){a.show_failure_message(t.labels.network_error+" ("+e.statusText+")")},complete:function(){a.remove_spinner(e),a.toggleSaveButtons(!1,e)}})}},i={hide_loader:function(t){var r=e("#user-registration-form-"+t);r.find(".ur-submit-button").find("span").removeClass("ur-front-spinner"),r.find("form").find(".ur-submit-button").prop("disabled",!1)}},s={show_stripe_error:function(e){if($membership_registration_form.find("#stripe-errors").length>0)$membership_registration_form.find("#stripe-errors").html(e).show();else{var t='<label id="stripe-errors" class="user-registration-error" role="alert">'+e+"</label>";$membership_registration_form.find(".stripe-container").closest(".ur_membership_frontend_input_container").append(t)}},init:function(t){r=s.setupElements(),$membership_registration_form=e(t?".membership-upgrade-container":"#ur-membership-registration"),this.triggerInputChange()},triggerInputChange:function(){r.card.addEventListener("change",function(e){e.error?s.show_stripe_error(e.error.message):$membership_registration_form.find("#stripe-errors").length>0&&$membership_registration_form.find("#stripe-errors").remove()})},setupElements:function(){var e=Stripe(t.stripe_publishable_key),r=e.elements(),a={base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#8f9194"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}},n=r.create("card",{style:a}),i=r.create("idealBank",{style:a});return n.mount("#card-element"),{stripe:e,card:n,ideal:i,clientSecret:""}},handle_stripe_response:function(e,t,a){"paid"===e.data.pg_data.type?this.handle_one_time_payment(e,t,a):this.handle_recurring_payment(e,{paymentElements:r,user_id:e.data.member_id,response_data:e,prepare_members_data:t,form_response:a})},handle_one_time_payment:function(t,n,i){r.stripe.confirmCardPayment(t.data.pg_data.client_secret,{payment_method:{card:r.card}}).then(function(r){var o=e(".membership_register_button");a.toggleSaveButtons(!0,o),a.append_spinner(o),s.update_order_status(r,t,n,i)})},update_order_status:function(r,o,u,_){n.send_data({_wpnonce:t._confirm_payment_nonce,action:"user_registration_membership_confirm_payment",members_data:JSON.stringify(u),member_id:o.data.member_id,payment_status:r.error?"failed":"succeeded",form_response:JSON.stringify(_.data),payment_result:r},{success:function(e){if(e.success)if(e.data.is_upgrading||e.data.is_renewing){var a={username:u.username,message:e.data.message};e.data.is_upgrading?a.is_upgrading=e.data.is_upgrading:e.data.is_renewing&&(a.is_renewing=e.data.is_renewing),n.show_default_response(window.location.href,a)}else n.show_default_response(t.thank_you_page_url,{username:u.username,transaction_id:r.paymentIntent.id});else s.show_stripe_error(e.data.message),i.hide_loader(_.form_id)},failure:function(e,r){a.show_failure_message(t.labels.i18n_error+"("+e.responseJSON.data.message+")")},complete:function(){var t=e(".swal2-confirm ");i.hide_loader(_.form_id),a.toggleSaveButtons(!1,t),a.remove_spinner(t)}})},handle_recurring_payment:function(t,r){Promise.resolve(e.extend({},r,{customer_id:t.data.pg_data.stripe_cus_id})).then(s.createPaymentMethod).then(s.createSubscription).then(s.handleCustomerActionRequired).then(s.handleOnComplete)["catch"](function(e,a){s.update_order_status({error:{}},t,r.prepare_members_data,r.form_response)})},createPaymentMethod:function(t){return new Promise(function(r,n){var i=e(".membership_register_button");a.toggleSaveButtons(!0,i),a.append_spinner(i),t.paymentElements.stripe.createPaymentMethod({type:"card",card:t.paymentElements.card}).then(function(a){a.error?n(a.error.message,a):r(e.extend({},t,{payment_method_id:a.paymentMethod.id}))})["catch"](function(e){n(e,result)})})},createSubscription:function(r){return new Promise(function(s,o){n.send_data({_wpnonce:t._confirm_payment_nonce,action:"user_registration_membership_create_stripe_subscription",member_id:r.user_id,customer_id:r.customer_id,payment_method_id:r.payment_method_id,form_response:JSON.stringify(r.form_response.data)},{success:function(t){if(t.success){var a=t.data.subscription.latest_invoice.payment_intent;if(t.error){var n=t.error.message;return void o(n,r)}if("trialing"!==t.data.subscription.status&&a&&"requires_payment_method"===a.status){o(t,n="Your card was declined")}s(e.extend({},r,{subscription:t.data.subscription,message:t.data.message}))}else i.hide_loader(r.form_id),o(t,n)},failure:function(e,r){a.show_failure_message(t.labels.network_error+"("+r+")")}})})},handleCustomerActionRequired:function(e){return new Promise(function(t,r){!e.subscription||"active"!==e.subscription.status&&"trialing"!==e.subscription.status||t({subscription:e.subscription,response_data:e.response_data,message:e.message,prepare_members_data:e.prepare_members_data,form_response:e.form_response});var a=e.subscription.latest_invoice.payment_intent;"trialing"!==e.subscription.status&&"requires_action"===a.status&&e.paymentElements.stripe.confirmCardPayment(a.client_secret,{payment_method:e.paymentMethodId}).then(function(a){if(a.error){var n=a.error.message;r(n,e)}else if("succeeded"===a.paymentIntent.status)e.subscription.status="active",t({subscription:e.subscription,form_id:e.form_id,response_data:e.response_data,form_response:e.form_response});else{r(n="Unable to complete the payment.",e)}})})},handleOnComplete:function(e){var t=e.response_data.data.is_upgrading!==undefined&&e.response_data.data.is_upgrading,r=e.response_data.data.is_renewing!==undefined&&e.response_data.data.is_renewing;(t||r)&&s.update_order_status(e.subscription,e.response_data,e.prepare_members_data,e.form_response),!e.subscription||"active"!==e.subscription.status&&"trialing"!==e.subscription.status||t||r||a.show_form_success_message(e.form_response,{username:e.prepare_members_data.username,transaction_id:e.subscription.id})}};(function(){e('input[name="urm_payment_method"]').on("change",function(){var n=e(this).val(),i=e(".stripe-container"),o=e("#stripe-errors"),u=e(".authorize-net-container"),_=e("#authorize-errors");if(i.addClass("urm-d-none"),o.remove(),u.addClass("urm-d-none"),_.remove(),r={},"stripe"===n){if(0==t.stripe_publishable_key.length)return void a.show_failure_message(t.labels.i18n_incomplete_stripe_setup_error);i.removeClass("urm-d-none"),s.init()}"authorize"===n&&u.removeClass("urm-d-none")}),e(document).on("change",'input[name="urm_membership"]',function(){e("#total-input-notice").text("");var t=e(this).data("urm-pg"),r=e(this).data("urm-pg-type"),a=e(".ur_payment_gateway_container"),i=a.find("input"),s=e(".urm_hidden_payment_container"),o=e(".stripe-container"),u=e("#stripe-errors"),_=e("#upgrade-membership-notice"),m=e(".authorize-net-container");if(e("#authorize-errors").remove(),u.remove(),_.text(""),e('input[name="urm_payment_method"]').prop("checked",!1),o.addClass("urm-d-none"),m.addClass("urm-d-none"),s.addClass("urm-d-none"),e(".urm_apply_coupon").show(),"free"!==r){if(s.removeClass("urm-d-none"),i.each(function(r,a){var n=e(a).val(),i=e('label[for="ur-membership-'+n+'"]');i.removeClass("urm-d-none"),t.hasOwnProperty(n)||i.addClass("urm-d-none")}),1===a.find("input:visible").length){var d=a.find("input:visible");e(d[0]).prop("checked",!0),d.trigger("change")}n.calculate_total(e(this))}});var i=new URLSearchParams(window.location.search),o=e('input[name="urm_membership"]');i.has("membership_id")&&e('input[name="urm_membership"]:checked').change(),o!==undefined&&1===o.length&&e(o[0]).prop("checked",!0).change(),e(".close_notice").on("click",a.toggleNotice),e("#ur-membership-password").on("keyup change",function(){var r=e(this).val(),n=e("#password-notice"),i=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*()_+}{\"':;?/>.<,]).*$");if(a.show_validation_error(n,""),r.length<8)a.show_validation_error(n,t.labels.i18n_field_password_field_length_validation);else{if(i.test(r))return!0;a.show_validation_error(n,t.labels.i18n_field_password_field_regex_validation)}}),e("#ur-membership-confirm-password").on("keyup",function(){var r=e(this).val(),n=e("#ur-membership-password").val(),i=e("#confirm-password-notice");if(a.show_validation_error(i,""),0===n.length&&a.show_validation_error(i,t.labels.i18n_field_password_empty_validation),r===n)return!0;a.show_validation_error(i,t.labels.i18n_field_confirm_password_field_validation)}),e(document).on("click",".urm_apply_coupon",function(){n.validate_coupon(e(this))}),e(document).on("click",".ur_clear_coupon",function(){e("#ur-membership-coupon").val(""),e("#coupon-validation-error").text(""),e(".urm_apply_coupon").show(),e("#total-input-notice").text("");var t=e('input[name="urm_membership"]:checked');t.removeData("ur-discount-amount").removeAttr("data-ur-discount-amount"),n.calculate_total(t)}),e(document).on("click","#membership-old-selection-form .membership-signup-button",function(){var t=e(this),r=t.siblings('input[name="membership_id"]').val(),a=t.siblings('input[name="redirection_url"]').val(),n=t.siblings('input[name="thank_you_page_id"]').val(),i=a+"?membership_id="+r+"&urm_uuid="+t.siblings('input[name="urm_uuid"]').val()+"&thank_you="+n;window.location.replace(i)}),e(document).on("user_registration_frontend_validate_before_form_submit",function(){n.validate_membership_form()}),e(document).on("user_registration_frontend_before_form_submit",function(t,r,a,n){e(a).find("#ur-membership-registration").length>0&&(r.is_membership_active=e(a).find('input[name="urm_membership"]:checked').val(),r.membership_type=e('input[name="urm_membership"]:checked').val())}),e(document).on("user_registration_frontend_before_ajax_complete_success_message",function(t,r,a,i){var s=!0,o=JSON.parse(r.responseText),u={data:o.data,form_id:e(i).data("form-id")};"undefined"!=typeof o.data.registration_type&&"membership"===o.data.registration_type&&(s=!1,n.create_member(u)),a.status=s}),e('input[name="urm_payment_method"]').on("change",function(){var n=e(this).val(),i=e(".stripe-container"),o=e("#stripe-errors"),u=e(".authorize-net-container"),_=e("#authorize-errors");if(i.addClass("urm-d-none"),o.remove(),u.addClass("urm-d-none"),_.remove(),r={},"stripe"===n){if(0==t.stripe_publishable_key.length)return void a.show_failure_message(t.labels.i18n_incomplete_stripe_setup_error);i.removeClass("urm-d-none"),s.init()}"authorize"===n&&u.removeClass("urm-d-none")}),e(document).on("change",'.membership-upgrade-container input[name="urm_payment_method"]',function(){var n=e(this).val(),i=e(".stripe-container"),o=e("#stripe-errors"),u=e("#upgrade-membership-notice"),_=e(".authorize-net-container"),m=e("#authorize-errors");if(u.text(""),i.addClass("urm-d-none"),o.remove(),_.addClass("urm-d-none"),m.remove(),r={},"stripe"===n){if(0==t.stripe_publishable_key.length)return void a.show_failure_message(t.labels.i18n_incomplete_stripe_setup_error);i.removeClass("urm-d-none"),s.init(!0)}"authorize"===n&&_.removeClass("urm-d-none")}),e(document).on("click",".cancel-membership-button",function(){var r=e(this),a=e("#membership-error-div"),n=r.text(),i=e("#membership-title").text();Swal.fire({icon:"warning",title:t.labels.i18n_cancel_membership_text+" "+i.trim(),text:t.labels.i18n_cancel_membership_subtitle,customClass:"user-registration-upgrade-membership-swal2-container",showConfirmButton:!0,showCancelButton:!0}).then(function(i){i.isConfirmed&&e.ajax({url:t.ajax_url,type:"POST",data:{action:"user_registration_membership_cancel_subscription",security:t._nonce,subscription_id:r.data("id")},beforeSend:function(){r.text(t.labels.i18n_sending_text)},success:function(e){e.success?(a.hasClass("btn-error")&&(a.removeClass("btn-error"),a.addClass("btn-success")),a.text(e.data.message),a.show(),location.reload()):(a.hasClass("btn-success")&&(a.removeClass("btn-success"),a.addClass("btn-error")),a.text(e.data.message),a.show())},complete:function(){r.text(n)}})})}),e(document).on("click",".reactivate-membership-button",function(){var r=e(this),a=e("#membership-error-div"),n=r.text();e("#membership-title").text();e.ajax({url:t.ajax_url,type:"POST",data:{action:"user_registration_membership_reactivate_membership",security:t._nonce,subscription_id:r.data("id")},beforeSend:function(){r.text(t.labels.i18n_sending_text)},success:function(e){e.success?(a.hasClass("btn-error")&&(a.removeClass("btn-error"),a.addClass("btn-success")),a.text(e.data.message),a.show(),location.reload()):(a.hasClass("btn-success")&&(a.removeClass("btn-success"),a.addClass("btn-error")),a.text(e.data.message),a.show())},complete:function(){r.text(n)}})}),e(document).on("click",".change-membership-button",function(){var r=e(this),i="free",s="",o=r.data("id"),u=r.siblings("button").data("id");r.attr("disabled",!0),a.append_spinner(r),e.ajax({url:t.ajax_url,type:"POST",data:{action:"user_registration_membership_fetch_upgradable_memberships",security:t._nonce,membership_id:o},success:function(r){if(r.success){var _=n.prepare_upgrade_membership_html(r.data);Swal.fire({title:t.labels.i18n_change_membership_title,html:_,customClass:"user-registration-upgrade-membership-swal2-container",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Change",confirmButtonColor:"#475BB2",preConfirm:function(r){var _=e('input[name="urm_membership"]:checked').data("urm-pg-type"),m=(e("#upgrade-membership-notice"),e(".swal2-confirm"));if(m.find("span.urm-spinner").length>0)return!1;if(a.append_spinner(m),s=e('input[name="urm_membership"]:checked').val(),i=e('input[name="urm_payment_method"]:checked').val()===undefined?i:e('input[name="urm_payment_method"]:checked').val(),"free"!==_){if(s===undefined)return!0,a.show_failure_message(t.labels.i18n_change_plan_required),a.remove_spinner(m),!1;if(i===undefined||"free"===i)return!0,a.show_failure_message(t.labels.i18n_field_payment_gateway_field_validation),a.remove_spinner(m),!1}return n.validate_membership_form(!0)?(n.upgrade_membership(o,s,u,i,m),!1):(a.remove_spinner(m),!1)},allowOutsideClick:!1})}else Swal.fire({html:r.data.message,customClass:"user-registration-upgrade-membership-swal2-container",showCancelButton:!0,confirmButtonColor:"red",confirmButtonText:t.labels.i18n_cancel_membership_text,cancelButtonText:t.labels.i18n_close,preConfirm:function(){var t=Swal.getConfirmButton();return n.cancel_delayed_subscription(e(t)),!1}})},error:function(e){Swal.fire({type:"error",text:e.responseJSON.data.message,customClass:"user-registration-upgrade-membership-swal2-container"})},complete:function(){a.remove_spinner(r),r.attr("disabled",!1)}})}),e(document).on("click",".renew-membership-button",function(){var r=e(this),i="free",s=r.data("pg-gateways").split(","),o=n.prepare_renew_membership_html(s);r.attr("disabled",!0),a.append_spinner(r),Swal.fire({title:t.labels.i18n_field_select_payment_gateway,html:o,customClass:"user-registration-upgrade-membership-swal2-container",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Change",confirmButtonColor:"#475BB2",didOpen:function(){e('.membership-upgrade-container input[name="urm_payment_method"]').trigger("change")},preConfirm:function(t){e('input[name="urm_membership"]:checked').data("urm-pg-type"),e("#upgrade-membership-notice");var r=e(".swal2-confirm");return!(r.find("span.urm-spinner").length>0)&&(a.append_spinner(r),r.attr("disabled",!0),i=e('input[name="urm_payment_method"]:checked').val()===undefined?i:e('input[name="urm_payment_method"]:checked').val(),n.renew_membership(i,r),!1)},allowOutsideClick:!1}).then(function(e){e.isConfirmed||(r.attr("disabled",!1),a.remove_spinner(r))})}),e("#membership-error-div .cancel-notice").on("click",function(){e(this).siblings("span").text(""),e(this).closest("#membership-error-div").hide()}),e(".field-membership").length&&e(".field-membership").each(function(t,r){if(e(r).find(".no-membership")){var a=e(r).find(".no-membership").attr("data-form-id");e("#user-registration-form-"+a).find(".ur-submit-button").prop("disabled",!0)}}),e(".view-bank-data").on("click",function(){Swal.fire({title:t.labels.i18n_bank_details_title,html:e(".upgrade-info").html(),customClass:"user-registration-upgrade-membership-swal2-container",showCancelButton:!1,showConfirmButton:!1})})})()}(jQuery,window.ur_membership_frontend_localized_data);