!function(e,t){var n=e("#payment-detail-modal");if(UR_Snackbar)var s=new UR_Snackbar;var o={append_spinner:function(e){if(e&&e.append){return e.append('<span class="ur-spinner is-active"></span>'),!0}return!1},remove_spinner:function(e){return!(!e||!e.remove)&&(e.find(".ur-spinner").remove(),!0)},if_empty:function(e,t){return null===e||undefined===e||""===e?t:e},toggleSaveButtons:function(t){t=o.if_empty(t,!0),e(".approve-payment").prop("disabled",!!t)},handle_bulk_delete_action:function(n){Swal.fire({title:'<img src="'+t.delete_icon+'" id="delete-user-icon">'+t.labels.i18n_prompt_title,html:'<p id="html_1">'+t.labels.i18n_prompt_bulk_subtitle+"</p>",showCancelButton:!0,confirmButtonText:t.labels.i18n_prompt_delete,cancelButtonText:t.labels.i18n_prompt_cancel,allowOutsideClick:!1}).then(function(s){if(s.isConfirmed){var a=n.find("tbody input[type=checkbox]:checked"),i=[],r=[];if(a.length<1)return void o.show_failure_message(t.labels.i18n_prompt_no_order_selected);a.each(function(){""!==e(this).val()?i.push(e(this).val()):""!==e(this).data("user-id")&&r.push(e(this).data("user-id"))}),o.send_data({action:"user_registration_membership_delete_orders",order_ids:JSON.stringify(i),user_ids:JSON.stringify(r)},{success:function(t){t.success?(e(".ur-member-save-btn").text("Save"),o.show_success_message(t.data.message),o.remove_deleted_orders(a,!0)):o.show_failure_message(t.data.message)},failure:function(e,n){o.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){window.location.reload()}})}})},handle_single_delete_action:function(e){var n=e.data("order-id"),s=e.data("user-id");Swal.fire({title:'<img src="'+t.delete_icon+'" id="delete-user-icon">'+t.labels.i18n_prompt_title,html:'<p id="html_1">'+t.labels.i18n_prompt_single_subtitle+"</p>",showCancelButton:!0,confirmButtonText:t.labels.i18n_prompt_delete,cancelButtonText:t.labels.i18n_prompt_cancel,allowOutsideClick:!1}).then(function(a){a.isConfirmed&&o.send_data({action:"user_registration_membership_delete_order",order_id:n,user_id:s},{success:function(t){t.success?(o.show_success_message(t.data.message),o.remove_deleted_orders(e,!1)):o.show_failure_message(t.data.message)},failure:function(e,n){o.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){window.location.reload()}})})},send_data:function(n,s){var o="function"==typeof s.success?s.success:function(){},a="function"==typeof s.failure?s.failure:function(){},i="function"==typeof s.beforeSend?s.beforeSend:function(){},r="function"==typeof s.complete?s.complete:function(){};!n._wpnonce&&t&&(n._wpnonce=t._nonce),e.ajax({type:"post",dataType:"json",url:t.ajax_url,data:n,beforeSend:i,success:o,error:a,complete:r})},show_success_message:function(e){return!!s&&(s.add({type:"success",message:e,duration:5}),!0)},show_failure_message:function(e){return!!s&&(s.add({type:"failure",message:e,duration:6}),!0)},remove_deleted_orders:function(t,n){n?t.each(function(t){0!==t&&e(this).parents("tr").remove()}):e(t).parents("tr").remove()},open_modal:function(){this.clear_modal(),n.css({display:"flex"})},close_modal:function(){n.css({display:"none"})},clear_modal:function(){n.find(".modal-body").empty()}};e(document).ready(function(){e("#doaction-orders,#doaction-orders2").on("click",function(t){t.preventDefault(),t.stopPropagation();var n=e("#ur-membership-payment-history-form");switch(n.find("select#bulk-action-selector-top option:selected").val()){case"delete":o.handle_bulk_delete_action(n)}}),e(".single-delete-order").on("click",function(){o.handle_single_delete_action(e(this))}),e(document).on("click",".show-order-detail",function(){var s=e(this),a=s.data("order-id"),i=n.find(".modal-body"),r=s.data("user-id");o.open_modal(),o.append_spinner(i),o.send_data({action:"user_registration_membership_show_order_detail",order_id:a,user_id:r},{success:function(e){if(e.success){var t=JSON.parse(e.data);i.html(t)}else o.show_failure_message(e.data.message)},failure:function(e,n){o.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){}})}),e(window).click(function(t){e(t.target).is(n)&&o.close_modal()}),e(document).on("click",".close-button",function(){o.close_modal()}),e(document).on("change","#user-registration-pro-payment-type-filters",function(){var t=e(this).find("option:selected").val();e(".module-box").each(function(t,n){e(n).hide(),e(n).find("select option").removeAttr("selected")}),e("#user-registration-pro-"+t+"-filters-container").css({display:"flex"})}),e(document).on("click",".approve-payment",function(){var n=e(this),s=n.data("order-id");o.append_spinner(n),o.toggleSaveButtons(!0),o.send_data({action:"user_registration_membership_approve_payment",order_id:s},{success:function(a){(a=JSON.parse(a.data)).status?(o.show_success_message(a.message),n.siblings("span").removeClass("pending").addClass("completed").text(t.labels.i18n_payment_completed),e("#ur-order-"+s).removeClass("pending").addClass("completed").text(t.labels.i18n_payment_completed),n.remove()):o.show_failure_message(a.message)},failure:function(e,n){console.log(e),o.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){o.remove_spinner(n),o.toggleSaveButtons(!1)}})})})}(jQuery,window.urm_orders_localized_data);