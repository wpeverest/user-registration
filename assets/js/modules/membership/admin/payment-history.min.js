!function(e,t){var n=e("#payment-detail-modal");if(UR_Snackbar)var r=new UR_Snackbar;var a={append_spinner:function(e){if(e&&e.append){return e.append('<span class="ur-spinner is-active"></span>'),!0}return!1},remove_spinner:function(e){return!(!e||!e.remove)&&(e.find(".ur-spinner").remove(),!0)},if_empty:function(e,t){return null==e||""===e?t:e},toggleSaveButtons:function(t){t=a.if_empty(t,!0),e(".approve-payment").prop("disabled",!!t)},handle_bulk_delete_action:function(n){Swal.fire({title:'<img src="'+t.delete_icon+'" id="delete-user-icon">'+t.labels.i18n_prompt_title,html:'<p id="html_1">'+t.labels.i18n_prompt_bulk_subtitle+"</p>",showCancelButton:!0,confirmButtonText:t.labels.i18n_prompt_delete,cancelButtonText:t.labels.i18n_prompt_cancel,allowOutsideClick:!1}).then(function(r){if(r.isConfirmed){var i=n.find("tbody input[type=checkbox]:checked"),s=[],o=[];if(i.length<1)return void a.show_failure_message(t.labels.i18n_prompt_no_order_selected);i.each(function(){""!==e(this).val()?s.push(e(this).val()):""!==e(this).data("user-id")&&o.push(e(this).data("user-id"))}),a.send_data({action:"user_registration_membership_delete_orders",order_ids:JSON.stringify(s),user_ids:JSON.stringify(o)},{success:function(t){t.success?(e(".ur-member-save-btn").text("Save"),a.show_success_message(t.data.message),a.remove_deleted_orders(i,!0)):a.show_failure_message(t.data.message)},failure:function(e,n){a.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){window.location.reload()}})}})},handle_single_delete_action:function(e){var n=e.data("order-id"),r=e.data("user-id");Swal.fire({title:'<img src="'+t.delete_icon+'" id="delete-user-icon">'+t.labels.i18n_prompt_title,html:'<p id="html_1">'+t.labels.i18n_prompt_single_subtitle+"</p>",showCancelButton:!0,confirmButtonText:t.labels.i18n_prompt_delete,cancelButtonText:t.labels.i18n_prompt_cancel,allowOutsideClick:!1}).then(function(i){i.isConfirmed&&a.send_data({action:"user_registration_membership_delete_order",order_id:n,user_id:r},{success:function(t){t.success?(a.show_success_message(t.data.message),a.remove_deleted_orders(e,!1)):a.show_failure_message(t.data.message)},failure:function(e,n){a.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){var e=new URL(window.location.href);e.searchParams.has("id")&&e.searchParams.has("action")?(e.searchParams.delete("id"),e.searchParams.delete("action"),window.location.replace(e.toString())):window.location.reload()}})})},send_data:function(n,r){var a="function"==typeof r.success?r.success:function(){},i="function"==typeof r.failure?r.failure:function(){},s="function"==typeof r.beforeSend?r.beforeSend:function(){},o="function"==typeof r.complete?r.complete:function(){};!n._wpnonce&&t&&(n._wpnonce=t._nonce),e.ajax({type:"post",dataType:"json",url:t.ajax_url,data:n,beforeSend:s,success:a,error:i,complete:o})},show_success_message:function(e){return!!r&&(r.add({type:"success",message:e,duration:5}),!0)},show_failure_message:function(e){return!!r&&(r.add({type:"failure",message:e,duration:6}),!0)},remove_deleted_orders:function(t,n){n?t.each(function(t){0!==t&&e(this).parents("tr").remove()}):e(t).parents("tr").remove()},open_modal:function(){this.clear_modal(),n.css({display:"flex"})},close_modal:function(){n.css({display:"none"})},clear_modal:function(){n.find(".modal-body").empty()},handle_edit_action:function(n){e(".ur-payment-update-btn").prop("disabled",!0).append('<span class="ur-spinner"></span>');var r={};e.each(n.serializeArray(),function(t,n){var a=n.name.replace(/\[\]$/,"");r.name?(e.isArray(r[a])||(r[a]=[r[a]]),r[a].push(n.value)):r[a]=n.value}),r.security=r.ur_membership_edit_order_nonce,a.send_data(e.extend({action:"user_registration_membership_edit_order"},r),{success:function(e){e.success?(a.show_success_message(e.data.message),setTimeout(function(){window.location.reload()},1e3)):a.show_failure_message(e.data.message)},failure:function(e,n){a.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){e(".ur-payment-update-btn").prop("disabled",!1).find(".ur-spinner").remove()}})}};e(document).ready(function(){e("#doaction-orders,#doaction-orders2").on("click",function(t){t.preventDefault(),t.stopPropagation();var n=e("#ur-membership-payment-history-form");if("delete"===n.find("select#bulk-action-selector-top option:selected").val())a.handle_bulk_delete_action(n)}),e(".ur-payment-update-btn").on("click",function(t){t.preventDefault(),a.handle_edit_action(e("#ur-payments-edit-form"))}),e(".single-delete-order").on("click",function(){a.handle_single_delete_action(e(this))}),e(document).on("click",".show-order-detail",function(){var r=e(this),i=r.data("order-id"),s=n.find(".modal-body"),o=r.data("user-id");a.open_modal(),a.append_spinner(s),a.send_data({action:"user_registration_membership_show_order_detail",order_id:i,user_id:o},{success:function(e){if(e.success){var t=JSON.parse(e.data);s.html(t)}else a.show_failure_message(e.data.message)},failure:function(e,n){a.show_failure_message(t.labels.network_error+"("+n+")")},complete:function(){}})}),e(window).click(function(t){e(t.target).is(n)&&a.close_modal()}),e(document).on("click",".close-button",function(){a.close_modal()}),e(document).on("change","#user-registration-pro-payment-type-filters",function(){var t=e(this).find("option:selected").val();e(".module-box").each(function(t,n){e(n).hide(),e(n).find("select option").removeAttr("selected")}),e("#user-registration-pro-"+t+"-filters-container").css({display:"flex"})})}),e(document).ready(function(){e(".manual-payment-button").on("click",function(){window.location.href=t.add_manual_payment_url});e("#ur-member-id-hidden"),e("#ur-membership-payment-history-form")});e("#ur-member-search-input");e(document).ready(function(){e("#ur-input-type-member").select2({placeholder:"Select a member",allowClear:!0,width:"100%"}),e("#ur-input-type-payment-method").select2({placeholder:"Select Payment Method",allowClear:!0,minimumResultsForSearch:1/0,width:"100%"}),e("#ur-input-type-transaction-status").select2({placeholder:"Select status",minimumResultsForSearch:1/0,width:"100%"})}),e(document).ready(function(e){e("#ur-membership-order-create-form").on("submit",function(n){n.preventDefault();var r=e(".ur-add-new-payment");r.prop("disabled",!0).prepend('<span class="ur-spinner"></span>');var i={ur_member_id:e("#ur-input-type-member").val(),ur_membership_plan:e("#ur-input-type-membership-plan").val(),ur_membership_amount:e("#ur-input-type-membership-amount").val(),ur_payment_date:e("#ur-input-type-payment-date").val(),ur_transaction_status:e("#ur-input-type-transaction-status").val(),ur_payment_notes:e("#ur-input-type-payment-notes").val(),ur_payment_method:e("#ur-input-type-payment-method").val()};e.ajax({url:t.ajax_url,type:"POST",data:{action:"user_registration_membership_create_order",security:e("#ur_membership_order_nonce").val(),order_data:JSON.stringify(i)},success:function(e){e.success?(r.prop("disabled",!1).find(".ur-spinner").remove(),a.show_success_message(e.data.message||"Payment created successfully"),setTimeout(function(){window.location.href=t.payment_history_url},1e3)):(a.show_failure_message(e.data.message||"Error creating payment","error"),r.prop("disabled",!1).find(".ur-spinner").remove())},error:function(e,t,n){a.show_failure_message("Server error occurred. Please try again.","error"),r.prop("disabled",!1).find(".ur-spinner").remove()}})}),e("#ur-input-type-membership-plan").on("change",function(){var t=e(this).find("option:selected"),n=t.data("amount");n?(e("#ur-input-type-membership-amount").val(n),e("#ur-input-type-membership-amount").prop("disabled",!1)):(e("#ur-input-type-membership-amount").val(0),e("#ur-input-type-membership-amount").prop("disabled",!0)),e(".ur-membership-plan-name").html(t.text())}),e("#ur-input-type-member").on("change",function(){var t=e(this).find("option:selected").data("membership-plan-id");e("#ur-input-type-membership-plan").val(t).trigger("change")}),e("#ur-input-type-payment-date").on("click focus",function(){this.showPicker&&this.showPicker()})}),e("#user-registration-payments-filter-reset-btn").on("click",function(t){t.preventDefault();var n=window.location.href,r=e(this).closest("form")[0];r.reset(),e(r).find('input[type="hidden"]').val(""),e(r).find("select").each(function(){e(this).prop("selectedIndex",0)}),window.location.href=n.split("&")[0]})}(jQuery,window.urm_orders_localized_data);