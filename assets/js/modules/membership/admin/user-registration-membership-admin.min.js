!(function (e, r) {
	function a() {
		var r = [];
		return (
			c.find("tr[data-membership-id]").each(function () {
				var a = e(this);
				if (
					!a.hasClass("ui-sortable-helper") &&
					!a.hasClass("ur-sortable-placeholder")
				) {
					var t = a.attr("data-membership-id");
					t && r.push(parseInt(t, 10));
				}
			}),
			r
		);
	}
	function t(e, r) {
		e ? r.show() : r.hide();
	}
	function i() {
		e(".ur-sync-to-email-marketing-addon-sync-container").each(function () {
			var r = e(this),
				a = r.find(
					'.ur-sync-to-email-marketing-addon-sync-toggle-container input[type="checkbox"]'
				),
				t = r.find(
					'.ur-sync-to-email-marketing-addon-sync-toggle-label-container .form-row, .urmc-sync-email-marketing-mailchimp-list-wrap, .urmc-sync-email-marketing-brevo-list-wrap, [class*="urmc-sync-email-marketing-"][class$="-list-wrap"]'
				);
			a.is(":checked") ? t.show() : t.hide();
		});
	}
	if (UR_Snackbar) var s = new UR_Snackbar();
	var n = !1,
		o = !1;
	e(".user-membership-enhanced-select2").select2();
	var l = {
			append_spinner: function (e) {
				if (e && e.append) {
					return (
						e.append('<span class="ur-spinner is-active"></span>'),
						!0
					);
				}
				return !1;
			},
			prepend_spinner: function (e) {
				if (e && e.prepend) {
					return (
						e.prepend('<span class="ur-spinner is-active"></span>'),
						!0
					);
				}
				return !1;
			},
			remove_spinner: function (e) {
				return (
					!(!e || !e.remove) && (e.find(".ur-spinner").remove(), !0)
				);
			},
			if_empty: function (e, r) {
				return null === e || undefined === e || "" === e ? r : e;
			},
			toggleSaveButtons: function (r) {
				(r = l.if_empty(r, !0)),
					e(".ur-membership-save-btn").prop("disabled", !!r);
			},
			show_success_message: function (e) {
				return (
					!!s &&
					(s.add({ type: "success", message: e, duration: 5 }), !0)
				);
			},
			show_failure_message: function (e) {
				return (
					!!s &&
					(s.add({ type: "failure", message: e, duration: 6 }), !0)
				);
			},
			convert_to_timestamp: function (e, r) {
				var a;
				switch (r) {
					case "day":
						a = 864e5;
						break;
					case "week":
						a = 6048e5;
						break;
					case "month":
						a = 2592e6;
						break;
					case "year":
						a = 31536e6;
						break;
					default:
						return null;
				}
				return new Date().getTime() + e * a;
			},
			regular_validation: function (a, t, i) {
				return (
					a.every(function (a) {
						var s = e(a),
							u = s.val(),
							p = s.attr("required"),
							m = s.attr("type"),
							c = s.data("key-name");
						if (
							(s.removeClass("ur-membership-error"),
							p && "" === u)
						) {
							(t = !1),
								"form" === i
									? (n = !0)
									: "paypal" === i && (o = !0);
							var d =
								("paypal" === i ? r.labels.i18n_paypal : "") +
								r.labels.i18n_error +
								"! " +
								c +
								" " +
								r.labels.i18n_field_is_required +
								" " +
								("paypal" === i
									? r.labels.i18n_paypal_setup_error
									: "");
							return (
								l.show_failure_message(d),
								s.addClass("ur-membership-error"),
								!1
							);
						}
						return (
							!("url" === m && !l.url_validations(u)) ||
							((t = !1),
							"form" === i
								? (n = !0)
								: "paypal" === i && (o = !0),
							l.show_failure_message(
								r.labels.i18n_error +
									"! " +
									c +
									" " +
									r.labels.i18n_valid_url_field_validation +
									" " +
									c
							),
							s.addClass("ur-membership-error"),
							!1)
						);
					}),
					t
				);
			},
			url_validations: function (e) {
				return new RegExp(
					"^https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)$"
				).test(e);
			},
			handle_bulk_delete_action: function (a) {
				Swal.fire({
					title:
						'<img src="' +
						r.delete_icon +
						'" id="delete-user-icon">' +
						r.labels.i18n_prompt_title,
					html:
						'<p id="html_1">' +
						r.labels.i18n_prompt_bulk_subtitle +
						"</p>",
					showCancelButton: !0,
					confirmButtonText: r.labels.i18n_prompt_delete,
					cancelButtonText: r.labels.i18n_prompt_cancel,
					allowOutsideClick: !1
				}).then(function (t) {
					if (t.isConfirmed) {
						var i = a.find('input[name="membership[]"]:checked'),
							s = [];
						if (i.length < 1)
							return void l.show_failure_message(
								r.labels.i18n_prompt_no_membership_selected
							);
						i.each(function () {
							"" !== e(this).val() && s.push(e(this).val());
						}),
							u.send_data(
								{
									action: "user_registration_membership_delete_memberships",
									membership_ids: JSON.stringify(s)
								},
								{
									success: function (e) {
										e.success
											? (l.show_success_message(
													e.data.message
											  ),
											  u.remove_deleted_memberships(
													i,
													!0
											  ))
											: l.show_failure_message(
													e.data.message
											  );
									},
									failure: function (e, a) {
										l.show_failure_message(
											r.labels.network_error +
												"(" +
												a +
												")"
										);
									},
									complete: function () {
										window.location.reload();
									}
								}
							);
					}
				});
			}
		},
		u = {
			prepare_membership_data: function () {
				var a = {},
					t = {},
					i = e("#ur-membership-create-form"),
					s = tinyMCE
						.get("ur-input-type-membership-description")
						.getContent();
				(s = s.replace(
					/(<img[^>]*?)(")([^>]*?>)/g,
					function (e, r, a, t) {
						return r + "'" + t.replace(/"/g, "'");
					}
				)),
					(a = {
						name: i.find("#ur-input-type-membership-name").val(),
						description: s,
						status: e("#ur-membership-status").prop("checked")
					}),
					r.membership_id && (a.ID = r.membership_id),
					(t.type = i
						.find('input[name="ur_membership_type"]:checked')
						.val()),
					(t.cancel_subscription = i
						.find('input[name="ur_membership_cancel_on"]:checked')
						.val());
				var n = i.find(
					'input[name="ur_membership_email_marketing_sync_action"]:checked'
				);
				t.email_marketing_sync = {};
				var o = {};
				if (
					((t.email_marketing_sync.is_enable = n.val()),
					n.length && n.val())
				) {
					[
						"activecampaign",
						"brevo",
						"convertkit",
						"klaviyo",
						"mailchimp",
						"mailerlite",
						"mailpoet",
						"salesforce"
					].forEach(function (e) {
						o[e] || (o[e] = {});
						var r = i.find(
							'input[name="sync_membership_plan_with_' + e + '"]'
						);
						if (r.length && r.is(":checked")) {
							o[e].email_marketing_sync = r.is(":checked");
							var a = i.find(
								"#ur_sync_email_marketing_" + e + "_account"
							);
							a.length &&
								(o[e].email_marketing_account = a.val());
							var t = i.find(
								"#ur_sync_email_marketing_" +
									e +
									"_integration_list_id"
							);
							t.length && (o[e].integration_list_id = t.val());
						}
					});
				}
				if (
					((t.email_marketing_sync.addons_sync_details = o),
					(t.role = i
						.find("#ur-input-type-membership-role")
						.find(":selected")
						.val()),
					"free" !== t.type)
				) {
					"paid" !== t.type &&
						((t.subscription = {
							value: i
								.find("#ur-membership-duration-value")
								.val(),
							duration: i.find("#ur-membership-duration").val()
						}),
						(t.trial_status = i
							.find("#ur-membership-trial-status")
							.val()),
						"on" === t.trial_status &&
							(t.trial_data = {
								value: i
									.find("#ur-membership-trial-duration-value")
									.val(),
								duration: i
									.find("#ur-membership-trial-duration")
									.val()
							}),
						(t.cancel_subscription = i
							.find(
								'input[name="ur_membership_cancel_on"]:checked'
							)
							.val())),
						(t.amount = i.find("#ur-membership-amount").val());
					var l = i.find("#ur-membership-pg-paypal:checked").val(),
						u = i.find("#ur-membership-pg-bank:checked").val(),
						p = i.find("#ur-membership-pg-stripe:checked").val(),
						m = i.find("#ur-membership-pg-authorize:checked").val(),
						c = i.find("#ur-membership-pg-mollie:checked").val();
					(t.payment_gateways = {
						paypal: { status: "off" },
						stripe: { status: "off" },
						bank: { status: "off" },
						authorize: { status: "off" },
						mollie: { status: "off" }
					}),
						l &&
							((t.payment_gateways.paypal = {
								status: l,
								email: i
									.find("#ur-input-type-paypal-email")
									.val(),
								mode: i
									.find("#ur-membership-paypal-mode")
									.val(),
								payment_type: i
									.find("#ur-membership-paypal-payment-type")
									.val(),
								cancel_url: i
									.find("#ur-input-type-cancel-url")
									.val(),
								return_url: i
									.find("#ur-input-type-return-url")
									.val()
							}),
							"subscription" === t.type &&
								((t.payment_gateways.paypal.client_id = i
									.find("#ur-input-type-client-id")
									.val()),
								(t.payment_gateways.paypal.client_secret = i
									.find("#ur-input-type-client-secret")
									.val()))),
						u && (t.payment_gateways.bank = { status: u }),
						p && (t.payment_gateways.stripe = { status: p }),
						m && (t.payment_gateways.authorize = { status: m }),
						c && (t.payment_gateways.mollie = { status: c });
				}
				return (
					(t.upgrade_settings = {
						upgrade_action: i
							.find("#ur-membership-upgrade-action")
							.is(":checked"),
						upgrade_path: i
							.find("#ur-input-type-membership-upgrade-path")
							.val(),
						upgrade_type: i
							.find(".urm-upgrade-path-type-container")
							.find(
								'input[name="ur_membership_upgrade_type"]:checked'
							)
							.val()
					}),
					{ post_data: a, post_meta_data: t }
				);
			},
			validate_membership_form: function () {
				(n = !1), (o = !1);
				e("#ur-membership-plan-and-price-section");
				var a = e("#ur-membership-main-fields").find("input"),
					t =
						(e("#ur-membership-create-form"),
						e("#ur-membership-upgrade-action").is(":checked")),
					i = !0;
				a = Object.values(a).reverse().slice(2);
				if (!l.regular_validation(a, !0, "form")) return !1;
				var s = e("#ur-membership-main-fields")
						.find('input[name="ur_membership_type"]:checked')
						.val(),
					u = e("#ur-membership-main-fields")
						.find("#ur-membership-amount")
						.val();
				if ("paid" === s || "subscription" === s) {
					e("#ur-membership-amount").removeClass(
						"ur-membership-error"
					),
						u <= 0 &&
							((i = !1),
							(n = !0),
							l.show_failure_message(
								r.labels.i18n_error +
									"! " +
									r.labels.i18n_valid_amount_field_validation
							),
							e("#ur-membership-amount").addClass(
								"ur-membership-error"
							));
					if (
						"on" === e("#ur-membership-trial-status").val() &&
						"subscription" === s
					) {
						var p = e("#ur-membership-trial-duration").val(),
							m = e("#ur-membership-trial-duration-value").val(),
							c = e("#ur-membership-duration").val(),
							d = e("#ur-membership-duration-value").val(),
							_ = l.convert_to_timestamp(parseInt(m, 10), p),
							h = l.convert_to_timestamp(parseInt(d, 10), c);
						e("#ur-membership-trial-duration-value").removeClass(
							"ur-membership-error"
						),
							e("#ur-membership-trial-duration").removeClass(
								"ur-membership-error"
							),
							_ >= h &&
								((i = !1),
								(o = !0),
								l.show_failure_message(
									r.labels.i18n_error +
										"! " +
										r.labels
											.i18n_valid_trial_period_field_validation
								),
								e(
									"#ur-membership-trial-duration-value"
								).addClass("ur-membership-error"),
								e("#ur-membership-trial-duration").addClass(
									"ur-membership-error"
								)),
							e("#ur-membership-duration-value").removeClass(
								"ur-membership-error"
							),
							e(
								"#ur-membership-trial-duration-value"
							).removeClass("ur-membership-error"),
							m < 1 &&
								((i = !1),
								(o = !0),
								l.show_failure_message(
									r.labels.i18n_error +
										"! " +
										r.labels
											.i18n_valid_min_trial_period_field_validation
								),
								e(
									"#ur-membership-trial-duration-value"
								).addClass("ur-membership-error"));
					}
					"subscription" === s &&
						d < 1 &&
						((i = !1),
						(n = !0),
						l.show_failure_message(
							r.labels.i18n_error +
								"! " +
								r.labels
									.i18n_valid_min_subs_period_field_validation
						),
						e("#ur-membership-duration-value").addClass(
							"ur-membership-error"
						));
				}
				if (t) {
					var f = e("#ur-input-type-membership-upgrade-path"),
						b = e(".urm-upgrade-path-type-container"),
						g = b
							.find(
								'input[name="ur_membership_upgrade_type"]:checked'
							)
							.val();
					e(
						".ur-input-type-membership-upgrade-path .select2-selection--multiple"
					).removeClass("ur-membership-error"),
						f.val().length < 1 &&
							((i = !1),
							(o = !0),
							l.show_failure_message(
								r.labels.i18n_error +
									"! " +
									f.data("key-name") +
									" " +
									r.labels.i18n_field_is_required
							),
							e(
								".ur-input-type-membership-upgrade-path .select2-selection--multiple"
							).addClass("ur-membership-error")),
						g === undefined &&
							((i = !1),
							(o = !0),
							l.show_failure_message(
								r.labels.i18n_error +
									"! " +
									b.data("key-name") +
									" " +
									r.labels.i18n_field_is_required
							));
				}
				return i;
			},
			create_membership: function (a) {
				if (this.validate_membership_form()) {
					var t = null;
					"undefined" != typeof window.URCRMembershipAccess &&
						"function" ==
							typeof window.URCRMembershipAccess
								.prepareRuleData &&
						(t = window.URCRMembershipAccess.prepareRuleData());
					var i = this.prepare_membership_data(),
						s = {
							action: "user_registration_membership_create_membership",
							membership_data: JSON.stringify(i)
						};
					t &&
						((s.urcr_membership_access_rule_data =
							JSON.stringify(t)),
						console.log(
							"Rule data added to AJAX request for create"
						)),
						this.send_data(s, {
							success: function (t) {
								t.success
									? ((r.membership_id = t.data.membership_id),
									  a.text(r.labels.i18n_save),
									  l.show_success_message(t.data.message),
									  e(location).attr(
											"href",
											r.membership_page_url
									  ))
									: l.show_failure_message(t.data.message);
							},
							failure: function (e, a) {
								l.show_failure_message(
									r.labels.network_error + "(" + a + ")"
								);
							},
							complete: function () {
								l.remove_spinner(a), l.toggleSaveButtons(!1);
							}
						});
				} else
					n
						? e("#ur-basic-tab").trigger("click")
						: o && e("#ur-advanced-tab").trigger("click"),
						l.remove_spinner(a),
						l.toggleSaveButtons(!1);
			},
			update_membership: function (a) {
				if (
					(l.toggleSaveButtons(!0),
					l.append_spinner(a),
					this.validate_membership_form())
				) {
					var t = null;
					"undefined" != typeof window.URCRMembershipAccess &&
						"function" ==
							typeof window.URCRMembershipAccess
								.prepareRuleData &&
						(t = window.URCRMembershipAccess.prepareRuleData()),
						console.log(t);
					var i = this.prepare_membership_data(),
						s = {
							action: "user_registration_membership_update_membership",
							membership_data: JSON.stringify(i),
							membership_id: r.membership_id
						};
					t &&
						((s.urcr_membership_access_rule_data =
							JSON.stringify(t)),
						console.log(
							"Rule data added to AJAX request for update"
						)),
						this.send_data(s, {
							success: function (e) {
								e.success
									? l.show_success_message(e.data.message)
									: l.show_failure_message(e.data.message);
							},
							failure: function (e, a) {
								l.show_failure_message(
									r.labels.network_error + "(" + a + ")"
								);
							},
							complete: function () {
								l.remove_spinner(a), l.toggleSaveButtons(!1);
							}
						});
				} else
					n
						? e("#ur-basic-tab").trigger("click")
						: o && e("#ur-advanced-tab").trigger("click"),
						l.remove_spinner(a),
						l.toggleSaveButtons(!1);
			},
			update_membership_status: function (a) {
				l.prepend_spinner(a.parents(".row-actions")),
					a.attr("disabled", !0);
				var t = a.prop("checked"),
					i = a.data("ur-membership-id");
				this.send_data(
					{
						action: "user_registration_membership_update_membership_status",
						membership_data: JSON.stringify({ status: t, ID: i })
					},
					{
						success: function (e) {
							e.success
								? l.show_success_message(e.data.message)
								: l.show_failure_message(e.data.message);
						},
						failure: function (e, a) {
							l.show_failure_message(
								r.labels.network_error + "(" + a + ")"
							);
						},
						complete: function () {
							l.remove_spinner(a.parents(".row-actions")),
								a.attr("disabled", !1);
							var r = t ? "Active" : "Inactive",
								s = e("#ur-membership-list-status-" + i);
							s.text(r),
								"Inactive" === r
									? (s.removeClass(
											"user-registration-badge--success-subtle"
									  ),
									  s.addClass(
											"user-registration-badge--secondary-subtle"
									  ))
									: (s.removeClass(
											"user-registration-badge--secondary-subtle"
									  ),
									  s.addClass(
											"user-registration-badge--success-subtle"
									  ));
						}
					}
				);
			},
			validate_payment_gateway: function (a) {
				var t = a.closest(".ur-toggle-section "),
					i = a.attr("id").split("ur-membership-pg-")[1],
					s = e("input:radio[name=ur_membership_type]:checked").val();
				l.prepend_spinner(t),
					this.send_data(
						{
							action: "user_registration_membership_validate_pg",
							pg: i,
							membership_type: s
						},
						{
							success: function (e) {
								e.status
									? (a.prop("checked", !0),
									  a
											.closest(
												".user-registration-switch"
											)
											.closest(
												".ur-payment-option-header"
											)
											.siblings(".payment-option-body")
											.hide())
									: (l.show_failure_message(e.message),
									  a.prop("checked", !1),
									  a
											.closest(
												".user-registration-switch"
											)
											.closest(
												".ur-payment-option-header"
											)
											.siblings(".payment-option-body")
											.show());
							},
							failure: function (e, a) {
								l.show_failure_message(
									r.labels.network_error + "(" + a + ")"
								);
							},
							complete: function () {
								l.remove_spinner(t), l.toggleSaveButtons(!1);
							}
						}
					);
			},
			send_data: function (a, t) {
				var i =
						"function" == typeof t.success
							? t.success
							: function () {},
					s =
						"function" == typeof t.failure
							? t.failure
							: function () {},
					n =
						"function" == typeof t.beforeSend
							? t.beforeSend
							: function () {},
					o =
						"function" == typeof t.complete
							? t.complete
							: function () {};
				!a._wpnonce && r && (a._wpnonce = r._nonce),
					e.ajax({
						type: "post",
						dataType: "json",
						url: r.ajax_url,
						data: a,
						beforeSend: n,
						success: i,
						error: s,
						complete: o
					});
			},
			remove_deleted_memberships: function (r, a) {
				a
					? r.each(function () {
							e(this).parents("tr").remove();
					  })
					: e(r).parents("tr").remove();
			}
		};
	e(document).on(
		"click",
		"input:radio[name=ur_membership_type]",
		function () {
			var r = e(this).val(),
				a = e("#paid-plan-container"),
				t = e(".ur-membership-subscription-field-container"),
				i = e(
					'label.ur-membership-upgrade-types[for="ur-membership-upgrade-type-pro-rata"]'
				),
				s = e("#ur-membership-duration"),
				n = e("#ur-membership-duration-container"),
				o = e("#ur-membership-payment-settings-notice"),
				l = 1 === o.data("paid-configured"),
				u = 1 === o.data("subscription-configured");
			a.addClass("ur-d-none"),
				i.addClass("ur-d-none"),
				s.addClass("ur-d-none"),
				n.removeClass("ur-d-flex"),
				n.addClass("ur-d-none"),
				o.addClass("ur-d-none"),
				t.show(),
				"free" !== r &&
					("paid" === r
						? (t.hide(), l || o.removeClass("ur-d-none"))
						: (t.removeClass("ur-d-none"),
						  s.removeClass("ur-d-none"),
						  n.addClass("ur-d-flex"),
						  n.removeClass("ur-d-none"),
						  u || o.removeClass("ur-d-none")),
					i.removeClass("ur-d-none"),
					a.removeClass("ur-d-none"));
		}
	),
		e(document).on("click", "#ur-membership-upgrade-action", function () {
			e("#upgrade-settings-container").toggle(),
				e("input:radio[name=ur_membership_type]:checked").trigger(
					"click"
				);
		}),
		e(document).on("keydown", function (r) {
			r.ctrlKey &&
				"s" === r.key &&
				(r.preventDefault(),
				e(".ur-membership-save-btn").trigger("click"));
		}),
		e(".ur-membership-save-btn").on("click", function (a) {
			a.preventDefault(), a.stopPropagation();
			var t = e(this);
			e(this).find(".ur-spinner.is-active").length
				? l.show_failure_message(
						r.labels.i18n_previous_save_action_ongoing
				  )
				: r.membership_id && "" !== r.membership_id
				? u.update_membership(t)
				: u.create_membership(t);
		}),
		e("#ur-membership-trial-status").on("click", function () {
			var r = e(this).prop("checked"),
				a = e(".trial-container");
			e(this).val("on"),
				r || e(this).val("off"),
				a.toggleClass("ur-d-none");
		}),
		e(".ur-membership-change-status").on("change", function () {
			u.update_membership_status(e(this));
		}),
		e(document).on("click", ".ur-payment-option-header", function () {
			e(this).find("input").trigger("click");
		}),
		e(document).on("click", ".pg-switch", function (r) {
			r.stopImmediatePropagation(),
				e(this).is(":checked") &&
					e(this)
						.closest(".user-registration-switch")
						.find(".ur-spinner.is-active").length < 1 &&
					u.validate_payment_gateway(e(this));
		}),
		e(".delete-membership").on("click", function (a) {
			a.preventDefault(), a.stopPropagation();
			var t = e(this),
				i = t.data("membership-id"),
				s = t.closest(".delete");
			s.find("span").hasClass("is-active") ||
				(l.append_spinner(s),
				Swal.fire({
					title:
						'<img src="' +
						r.delete_icon +
						'" id="delete-user-icon">' +
						r.labels.i18n_prompt_title,
					html:
						'<p id="html_1">' +
						r.labels.i18n_prompt_single_subtitle +
						"</p>",
					showCancelButton: !0,
					confirmButtonText: r.labels.i18n_prompt_delete,
					cancelButtonText: r.labels.i18n_prompt_cancel,
					allowOutsideClick: !1
				}).then(function (e) {
					e.isConfirmed
						? u.send_data(
								{
									action: "user_registration_membership_delete_membership",
									membership_id: i
								},
								{
									success: function (e) {
										e.success
											? (l.show_success_message(
													e.data.message
											  ),
											  u.remove_deleted_memberships(
													t,
													!1
											  ))
											: Swal.fire({
													title:
														'<img src="' +
														r.delete_icon +
														'" id="delete-user-icon">' +
														r.labels
															.i18n_prompt_title,
													html: e.data.message,
													confirmButtonText:
														r.labels.i18n_prompt_ok,
													allowOutsideClick: !1
											  });
									},
									failure: function (e, a) {
										l.show_failure_message(
											r.labels.network_error +
												"(" +
												a +
												")"
										);
									},
									complete: function () {
										l.remove_spinner(t.closest(".delete"));
									}
								}
						  )
						: l.remove_spinner(t.closest(".delete"));
				}));
		}),
		e("#membership-list #doaction,#doaction2").on("click", function (r) {
			r.preventDefault(), r.stopPropagation();
			var a = e("#membership-list");
			switch (
				a.find("select#bulk-action-selector-top option:selected").val()
			) {
				case "delete":
					l.handle_bulk_delete_action(a);
			}
		});
	var p = e(
			".ur-page-title__wrapper--steps .ur-page-title__wrapper--steps-btn"
		),
		m = e(".user-registration-card--form-step");
	p.on("click", function () {
		!(function (e) {
			m.removeClass("user-registration-card--form-step-active"),
				p.removeClass("ur-page-title__wrapper--steps-btn-active"),
				m.eq(e).addClass("user-registration-card--form-step-active"),
				p.eq(e).addClass("ur-page-title__wrapper--steps-btn-active"),
				e;
		})(e(this).data("step"));
	});
	var c = e("#membership-list tbody#the-list");
	if (c.length > 0 && e.fn.sortable) {
		var d = r.labels.i18n_update_order,
			_ = e(
				'<div class="ur-membership-order-controls ur-d-none"><button type="button" class="button button-primary ur-update-membership-order-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="#000" viewBox="0 0 24 24"><path d="M2 12A10 10 0 0 1 12 2h.004l.519.015a10.75 10.75 0 0 1 6.53 2.655l.394.363 2.26 2.26a1 1 0 1 1-1.414 1.414l-2.248-2.248-.31-.286A8.75 8.75 0 0 0 11.996 4 8 8 0 0 0 4 12a1 1 0 1 1-2 0Z"/><path d="M20 3a1 1 0 1 1 2 0v5a1 1 0 0 1-1 1h-5a1 1 0 1 1 0-2h4V3Zm0 9a1 1 0 1 1 2 0 10 10 0 0 1-10 10h-.004a10.75 10.75 0 0 1-7.05-2.67l-.393-.363-2.26-2.26a1 1 0 1 1 1.414-1.414l2.248 2.248.31.286A8.749 8.749 0 0 0 12.003 20 7.999 7.999 0 0 0 20 12Z"/><path d="M2 21v-5a1 1 0 0 1 1-1h5a1 1 0 1 1 0 2H4v4a1 1 0 1 1-2 0Z"/></svg><span class="ur-update-order-btn-text">' +
					d +
					"</span></button></div>"
			),
			h = _.find(".ur-update-membership-order-btn"),
			f = '<span class="ur-spinner"></span>',
			b = [];
		e(".user-registration-base-list-table-heading").append(_),
			c.sortable({
				items: "tr[data-membership-id]",
				cancel: ".no-items",
				cursor: "move",
				opacity: 0.8,
				placeholder: "ur-sortable-placeholder",
				helper: function (r, a) {
					(b = []),
						c.find("tr[data-membership-id]").each(function () {
							var r = e(this).attr("data-membership-id");
							r && b.push(parseInt(r, 10));
						});
					var t = a.children(),
						i = a.clone();
					i.children().each(function (r) {
						e(this).width(t.eq(r).width());
					});
					var s = e("<table></table>");
					return (
						s.css({
							width: a.closest("table").width() + "px",
							margin: 0
						}),
						s.append(i),
						s
					);
				},
				start: function (e, r) {
					0 === b.length && (b = a());
				},
				stop: function (e, r) {
					var t = a();
					(function (e, r) {
						if (e.length !== r.length) return !1;
						for (var a = 0; a < e.length; a++)
							if (e[a] !== r[a]) return !1;
						return !0;
					})(b, t) ||
						(h.prop("disabled", !1),
						_.removeClass("ur-d-none"),
						_.find(".ur-spinner").remove()),
						(b = []);
				}
			}),
			_.on("click", ".ur-update-membership-order-btn", function (a) {
				if ((a.preventDefault(), !(_.find(".ur-spinner").length > 0))) {
					_.append(f);
					var t = [];
					if (
						(c.find("tr[data-membership-id]").each(function () {
							var r = e(this).attr("data-membership-id");
							r && t.push(parseInt(r, 10));
						}),
						0 === t.length)
					)
						return (
							f.removeClass("is-active"),
							h.prop("disabled", !1),
							void _.find(".ur-spinner").remove()
						);
					e.ajax({
						url: r.ajax_url,
						type: "POST",
						data: {
							action: r.update_order_action,
							nonce: r.update_order_nonce,
							membership_order: t
						},
						success: function (e) {
							_.find(".ur-spinner").remove(),
								e.success
									? (l.show_success_message(e.data.message),
									  _.addClass("ur-d-none"))
									: l.show_failure_message(e.data.message);
						},
						error: function (e, a, t) {
							_.find(".ur-spinner").remove(),
								l.show_failure_message(r.labels.network_error);
						}
					});
				}
			});
	}
	e(document).on(
		"change",
		"#ur-membership-email-marketing-sync-action",
		function (r) {
			r.stopPropagation(), r.preventDefault();
			var a = e(this),
				i = e("#ur-sync-to-email-marketing-container");
			t(a.is(":checked"), i);
		}
	);
	var g = e("#ur-membership-email-marketing-sync-action"),
		v = e("#ur-sync-to-email-marketing-container");
	t(g.is(":checked"), v),
		i(),
		e(document).on(
			"change",
			'.ur-sync-to-email-marketing-addon-sync-toggle-container input[type="checkbox"]',
			function () {
				i();
			}
		),
		e(document).on(
			"change",
			".ur_sync_email_marketing_addon_account",
			function (a) {
				a.stopPropagation(), a.preventDefault();
				var t = e(this),
					i = t.data("addon_name"),
					s = t.val(),
					n = {
						action: "user_registration_membership_addons_get_lists",
						addon: i,
						api_key: s
					};
				e.ajax({
					type: "post",
					url: r.ajax_url,
					data: n,
					beforeSend: function () {
						var r = e(document).find(
							".urmc-sync-email-marketing-" + i + "-list-wrap"
						);
						l.append_spinner(r),
							r.find("select").prop("disabled", !0),
							r
								.closest(
									".ur-sync-to-email-marketing-addon-sync-container"
								)
								.find("select")
								.prop("disabled", !0);
					},
					success: function (r) {
						var a = e(
							".urmc-sync-email-marketing-" + i + "-list-wrap"
						);
						a.find(".ur-spinner").remove(),
							r.success &&
								(a.find("select").remove(),
								a.append(r.data.html)),
							a
								.closest(
									".ur-sync-to-email-marketing-addon-sync-container"
								)
								.find("select")
								.prop("disabled", !1);
					}
				});
			}
		);
})(jQuery, window.ur_membership_localized_data);
