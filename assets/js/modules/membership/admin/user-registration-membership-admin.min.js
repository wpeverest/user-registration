!function(e,r){if(UR_Snackbar)var a=new UR_Snackbar;var i=!1,t=!1;e(".user-membership-enhanced-select2").select2();var n={append_spinner:function(e){if(e&&e.append){return e.append('<span class="ur-spinner is-active"></span>'),!0}return!1},prepend_spinner:function(e){if(e&&e.prepend){return e.prepend('<span class="ur-spinner is-active"></span>'),!0}return!1},remove_spinner:function(e){return!(!e||!e.remove)&&(e.find(".ur-spinner").remove(),!0)},if_empty:function(e,r){return null==e||""===e?r:e},toggleSaveButtons:function(r){r=n.if_empty(r,!0),e(".ur-membership-save-btn").prop("disabled",!!r)},show_success_message:function(e){return!!a&&(a.add({type:"success",message:e,duration:5}),!0)},show_failure_message:function(e){return!!a&&(a.add({type:"failure",message:e,duration:6}),!0)},convert_to_timestamp:function(e,r){var a;switch(r){case"day":a=864e5;break;case"week":a=6048e5;break;case"month":a=2592e6;break;case"year":a=31536e6;break;default:return null}return(new Date).getTime()+e*a},regular_validation:function(a,s,l){return a.every(function(a){var o=e(a),u=o.val(),m=o.attr("required"),c=o.attr("type"),p=o.data("key-name");if(o.removeClass("ur-membership-error"),m&&""===u){s=!1,"form"===l?i=!0:"paypal"===l&&(t=!0);var d=("paypal"===l?r.labels.i18n_paypal:"")+r.labels.i18n_error+"! "+p+" "+r.labels.i18n_field_is_required+" "+("paypal"===l?r.labels.i18n_paypal_setup_error:"");return n.show_failure_message(d),o.addClass("ur-membership-error"),!1}return!("url"===c&&!n.url_validations(u))||(s=!1,"form"===l?i=!0:"paypal"===l&&(t=!0),n.show_failure_message(r.labels.i18n_error+"! "+p+" "+r.labels.i18n_valid_url_field_validation+" "+p),o.addClass("ur-membership-error"),!1)}),s},url_validations:function(e){return new RegExp("^https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)$").test(e)},handle_bulk_delete_action:function(a){Swal.fire({title:'<img src="'+r.delete_icon+'" id="delete-user-icon">'+r.labels.i18n_prompt_title,html:'<p id="html_1">'+r.labels.i18n_prompt_bulk_subtitle+"</p>",showCancelButton:!0,confirmButtonText:r.labels.i18n_prompt_delete,cancelButtonText:r.labels.i18n_prompt_cancel,allowOutsideClick:!1}).then(function(i){if(i.isConfirmed){var t=a.find('input[name="membership[]"]:checked'),l=[];if(t.length<1)return void n.show_failure_message(r.labels.i18n_prompt_no_membership_selected);t.each(function(){""!==e(this).val()&&l.push(e(this).val())}),s.send_data({action:"user_registration_membership_delete_memberships",membership_ids:JSON.stringify(l)},{success:function(e){e.success?(n.show_success_message(e.data.message),s.remove_deleted_memberships(t,!0)):n.show_failure_message(e.data.message)},failure:function(e,a){n.show_failure_message(r.labels.network_error+"("+a+")")},complete:function(){window.location.reload()}})}})}},s={prepare_membership_data:function(){var a={},i={},t=e("#ur-membership-create-form"),n=tinyMCE.get("ur-input-type-membership-description").getContent();n=n.replace(/(<img[^>]*?)(")([^>]*?>)/g,function(e,r,a,i){return r+"'"+i.replace(/"/g,"'")}),a={name:t.find("#ur-input-type-membership-name").val(),description:n,status:e("#ur-membership-status").prop("checked")},r.membership_id&&(a.ID=r.membership_id),i.type=t.find('input[name="ur_membership_type"]:checked').val(),i.cancel_subscription=t.find('input[name="ur_membership_cancel_on"]:checked').val();var s=t.find('input[name="ur_membership_email_marketing_sync_action"]:checked');i.email_marketing_sync={};var l={};if(i.email_marketing_sync.is_enable=s.val(),s.length&&s.val()){["activecampaign","brevo","convertkit","klaviyo","mailchimp","mailerlite","mailpoet","salesforce"].forEach(function(e){l[e]||(l[e]={});var r=t.find('input[name="sync_membership_plan_with_'+e+'"]');if(r.length&&r.is(":checked")){l[e].email_marketing_sync=r.is(":checked");var a=t.find("#ur_sync_email_marketing_"+e+"_account");a.length&&(l[e].email_marketing_account=a.val());var i=t.find("#ur_sync_email_marketing_"+e+"_integration_list_id");if(i.length&&(l[e].integration_list_id=i.val()),"mailchimp"===e){var n=t.find("#ur_sync_email_marketing_mailchimp_tag_id");n.length&&(l[e].list_tags=n.val())}}})}if(i.email_marketing_sync.addons_sync_details=l,i.role=t.find("#ur-input-type-membership-role").find(":selected").val(),"free"!==i.type){"paid"!==i.type&&(i.subscription={value:t.find("#ur-membership-duration-value").val(),duration:t.find("#ur-membership-duration").val()},i.trial_status=t.find("#ur-membership-trial-status").val(),"on"===i.trial_status&&(i.trial_data={value:t.find("#ur-membership-trial-duration-value").val(),duration:t.find("#ur-membership-trial-duration").val()}),i.cancel_subscription=t.find('input[name="ur_membership_cancel_on"]:checked').val()),i.amount=t.find("#ur-membership-amount").val();var o=t.find("#ur-membership-pg-paypal:checked").val(),u=t.find("#ur-membership-pg-bank:checked").val(),m=t.find("#ur-membership-pg-stripe:checked").val(),c=t.find("#ur-membership-pg-authorize:checked").val(),p=t.find("#ur-membership-pg-mollie:checked").val();i.payment_gateways={paypal:{status:"off"},stripe:{status:"off"},bank:{status:"off"},authorize:{status:"off"},mollie:{status:"off"}},o&&(i.payment_gateways.paypal={status:o,email:t.find("#ur-input-type-paypal-email").val(),mode:t.find("#ur-membership-paypal-mode").val(),payment_type:t.find("#ur-membership-paypal-payment-type").val(),cancel_url:t.find("#ur-input-type-cancel-url").val(),return_url:t.find("#ur-input-type-return-url").val()},"subscription"===i.type&&(i.payment_gateways.paypal.client_id=t.find("#ur-input-type-client-id").val(),i.payment_gateways.paypal.client_secret=t.find("#ur-input-type-client-secret").val())),u&&(i.payment_gateways.bank={status:u}),m&&(i.payment_gateways.stripe={status:m}),c&&(i.payment_gateways.authorize={status:c}),p&&(i.payment_gateways.mollie={status:p}),t.find("#ur-membership-team-pricing").is(":checked")&&(i.team_pricing=[],e("#ur-team-pricing-container .ur-team-pricing-wrapper").each(function(){var r=e(this),a=r.find("input[name^='ur_seat_model']:checked").val(),t=r.find("input[name^='ur_team_plan_type']:checked").val(),n=r.find("input[name^='ur_team_duration_value']").val(),s=r.find("select[name^='ur_team_duration_period']").val(),l={seat_model:a,team_name:r.find("input[name^='ur_team_name']").val(),team_plan_type:t,team_duration_value:n,team_duration_period:s};if("fixed"===a)l.team_size=r.find("input[name^='ur_team_size']").val(),l.team_price=r.find("input[name^='ur_team_pricing']").val();else{l.minimum_seats=r.find("input[name^='ur_minimum_seats']").val(),l.maximum_seats=r.find("input[name^='ur_maximum_seats']").val();var o=r.find("input[name^='ur_pricing_model']:checked").val();if(l.pricing_model=o,"per_seat"===o)l.per_seat_price=r.find("input[name^='ur_per_seat_pricing']").val();else{var u=[];r.find(".ur-team-tier-field-wrapper").each(function(){var r=e(this),a={};a.tier_from=r.find("input[name^='ur_tier_from']").val(),a.tier_to=r.find("input[name^='ur_tier_to']").val(),a.tier_per_seat_price=r.find("input[name^='ur_tier_per_seat_price']").val(),u.push(a)}),l.tiers=u}}i.team_pricing.push(l)}))}var d=t.find('input[name="ur_membership_local_currency"]:checked');return i.local_currency={},i.local_currency.is_enable=d.val(),d.length&&d.val()&&(i.local_currency.zones={},t.find(".ur-local-currency-card").each(function(){var r=e(this),a=r.data("zone-id"),t=r.find(".ur-local-currency-toggle-input").is(":checked")?1:0,n=r.find('.ur-local-currency-radio-group input[type="radio"]:checked').val(),s="";"manual"===n&&(s=r.find(".local-currency-manual-local-price").val()),i.local_currency.zones[a]={enable:t,pricing_method:n,manual_price:s}})),i.upgrade_settings={upgrade_action:t.find("#ur-membership-upgrade-action").is(":checked"),upgrade_path:t.find("#ur-input-type-membership-upgrade-path").val(),upgrade_type:t.find(".urm-upgrade-path-type-container").find('input[name="ur_membership_upgrade_type"]:checked').val()},{post_data:a,post_meta_data:i}},validate_membership_form:function(){i=!1,t=!1;e("#ur-membership-plan-and-price-section");var a=e("#ur-membership-main-fields").find("input"),s=(e("#ur-membership-create-form"),e("#ur-membership-upgrade-action").is(":checked")),l=e("#ur-membership-team-pricing").is(":checked"),o=!0,u=e("#ur-membership-main-fields").find('input[name="ur_membership_type"]:checked').val();if("free"===u&&(e("#ur-membership-amount").prop("required",!1).removeAttr("required").removeClass("ur-membership-error"),a=a.not("#ur-membership-amount")),a=Object.values(a).reverse().slice(2),!n.regular_validation(a,!0,"form"))return!1;var m=u,c=e("#ur-membership-main-fields").find("#ur-membership-amount").val(),p=e("#ur-membership-duration").val(),d=e("#ur-membership-duration-value").val();if("paid"===m||"subscription"===m){if(e("#ur-membership-amount").removeClass("ur-membership-error"),c<=0&&(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! "+r.labels.i18n_valid_price_field_validation),e("#ur-membership-amount").addClass("ur-membership-error")),l){var _=e("input[name^='ur_team_name']"),h=e("input[name^='ur_seat_model']:checked");_.each(function(a){var t=e(this),s=a+1;""===t.val().trim()?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+s+": "+t.data("key-name")+" "+r.labels.i18n_field_is_required),t.addClass("ur-membership-error")):t.removeClass("ur-membership-error")}),h.each(function(a){var t=e(this),s=t.closest(".ur-team-pricing-wrapper"),l=a+1;if("fixed"===t.val()){var u=s.find("input[name^='ur_team_size']"),m=s.find("input[name^='ur_team_pricing']"),c=parseInt(u.val(),10)||0,p=parseInt(m.val(),10)||0;c<=0?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+": "+u.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),u.addClass("ur-membership-error")):u.removeClass("ur-membership-error"),p<=0?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+": "+m.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),m.addClass("ur-membership-error")):m.removeClass("ur-membership-error")}else{var d=s.find("input[name^='ur_minimum_seats']"),_=s.find("input[name^='ur_maximum_seats']"),h=parseInt(d.val(),10)||0,f=parseInt(_.val(),10)||0;if(d.removeClass("ur-membership-error"),_.removeClass("ur-membership-error"),h<=0?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+": "+d.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),d.addClass("ur-membership-error")):f<=0?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+": "+_.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),_.addClass("ur-membership-error")):f<=h&&(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+": "+_.data("key-name")+" must be greater than "+d.data("key-name")),_.addClass("ur-membership-error")),"per_seat"===s.find("input[name^='ur_pricing_model']:checked").val()){var b=s.find("input[name^='ur_per_seat_pricing']");b.val()<=0?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+": "+b.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),b.addClass("ur-membership-error")):b.removeClass("ur-membership-error")}else{var v=s.find(".ur-team-tier-field-wrapper");v.each(function(a){var t=e(this),s=a+1,u=0===a,m=a===v.length-1,c=t.find("input[name^='ur_tier_from']"),p=t.find("input[name^='ur_tier_to']"),b=t.find("input[name^='ur_tier_per_seat_price']"),g=parseInt(c.val(),10)||0,y=parseInt(p.val(),10)||0,w=parseInt(b.val(),10)||0;if(c.removeClass("ur-membership-error"),p.removeClass("ur-membership-error"),b.removeClass("ur-membership-error"),g<=0?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+" Tier "+s+": "+c.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),c.addClass("ur-membership-error")):y<=0?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+" Tier "+s+": "+p.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),p.addClass("ur-membership-error")):y<=g?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+" Tier "+s+": "+p.data("key-name")+" must be greater than "+c.data("key-name")),p.addClass("ur-membership-error")):u&&g!==h?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+" Tier 1: "+c.data("key-name")+" must be equal to "+d.data("key-name")),c.addClass("ur-membership-error")):m&&y!==f?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+" Tier "+s+": "+p.data("key-name")+" must be equal to "+_.data("key-name")),p.addClass("ur-membership-error")):w<=0&&(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Team "+l+" Tier "+s+": "+b.data("key-name")+" "+r.labels.i18n_valid_amount_field_validation),b.addClass("ur-membership-error")),!o)return o})}}})}if("on"===e("#ur-membership-trial-status").val()&&"subscription"===m){var f=e("#ur-membership-trial-duration").val(),b=e("#ur-membership-trial-duration-value").val(),v=n.convert_to_timestamp(parseInt(b,10),f),g=n.convert_to_timestamp(parseInt(d,10),p);e("#ur-membership-trial-duration-value").removeClass("ur-membership-error"),e("#ur-membership-trial-duration").removeClass("ur-membership-error"),v>=g&&(o=!1,t=!0,n.show_failure_message(r.labels.i18n_error+"! "+r.labels.i18n_valid_trial_period_field_validation),e("#ur-membership-trial-duration-value").addClass("ur-membership-error"),e("#ur-membership-trial-duration").addClass("ur-membership-error")),e("#ur-membership-duration-value").removeClass("ur-membership-error"),e("#ur-membership-trial-duration-value").removeClass("ur-membership-error"),b<1&&(o=!1,t=!0,n.show_failure_message(r.labels.i18n_error+"! "+r.labels.i18n_valid_min_trial_period_field_validation),e("#ur-membership-trial-duration-value").addClass("ur-membership-error"))}"subscription"===m&&(e("#ur-membership-duration-value").removeClass("ur-membership-error"),e("#ur-membership-duration").removeClass("ur-membership-error"),""===d||null==d?(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! Billing Cycle "+r.labels.i18n_field_is_required),e("#ur-membership-duration-value").addClass("ur-membership-error"),e("#ur-membership-duration").addClass("ur-membership-error")):parseInt(d,10)<1&&(o=!1,i=!0,n.show_failure_message(r.labels.i18n_error+"! "+r.labels.i18n_valid_min_subs_period_field_validation),e("#ur-membership-duration-value").addClass("ur-membership-error")))}if(s){var y=e("#ur-input-type-membership-upgrade-path"),w=e(".urm-upgrade-path-type-container"),k=w.find('input[name="ur_membership_upgrade_type"]:checked').val();e(".ur-input-type-membership-upgrade-path .select2-selection--multiple").removeClass("ur-membership-error"),y.val().length<1&&(o=!1,t=!0,n.show_failure_message(r.labels.i18n_error+"! "+y.data("key-name")+" "+r.labels.i18n_field_is_required),e(".ur-input-type-membership-upgrade-path .select2-selection--multiple").addClass("ur-membership-error")),void 0===k&&(o=!1,t=!0,n.show_failure_message(r.labels.i18n_error+"! "+w.data("key-name")+" "+r.labels.i18n_field_is_required))}return o},create_membership:function(a){if(n.toggleSaveButtons(!0),n.append_spinner(a),this.validate_membership_form()){var s=null;void 0!==window.URCRMembershipAccess&&"function"==typeof window.URCRMembershipAccess.prepareRuleData&&(s=window.URCRMembershipAccess.prepareRuleData());var l=this.prepare_membership_data(),o={action:"user_registration_membership_create_membership",membership_data:JSON.stringify(l)};s&&(o.urcr_membership_access_rule_data=JSON.stringify(s)),this.send_data(o,{success:function(i){i.success?(r.membership_id=i.data.membership_id,a.text(r.labels.i18n_save),n.show_success_message(i.data.message),e(location).attr("href",r.membership_page_url)):n.show_failure_message(i.data.message)},failure:function(e,a){n.show_failure_message(r.labels.network_error+"("+a+")")},complete:function(){n.remove_spinner(a),n.toggleSaveButtons(!1)}})}else i?e("#ur-basic-tab").trigger("click"):t&&e("#ur-advanced-tab").trigger("click"),n.remove_spinner(a),n.toggleSaveButtons(!1)},update_membership:function(a){if(n.toggleSaveButtons(!0),n.append_spinner(a),this.validate_membership_form()){var s=null;void 0!==window.URCRMembershipAccess&&"function"==typeof window.URCRMembershipAccess.prepareRuleData&&(s=window.URCRMembershipAccess.prepareRuleData());var l=this.prepare_membership_data(),o={action:"user_registration_membership_update_membership",membership_data:JSON.stringify(l),membership_id:r.membership_id};s&&(o.urcr_membership_access_rule_data=JSON.stringify(s)),this.send_data(o,{success:function(e){e.success?n.show_success_message(e.data.message):n.show_failure_message(e.data.message)},failure:function(e,a){n.show_failure_message(r.labels.network_error+"("+a+")")},complete:function(){n.remove_spinner(a),n.toggleSaveButtons(!1)}})}else i?e("#ur-basic-tab").trigger("click"):t&&e("#ur-advanced-tab").trigger("click"),n.remove_spinner(a),n.toggleSaveButtons(!1)},update_membership_status:function(a){n.prepend_spinner(a.parents(".row-actions")),a.attr("disabled",!0);var i=a.prop("checked"),t=a.data("ur-membership-id");this.send_data({action:"user_registration_membership_update_membership_status",membership_data:JSON.stringify({status:i,ID:t})},{success:function(e){e.success?n.show_success_message(e.data.message):n.show_failure_message(e.data.message)},failure:function(e,a){n.show_failure_message(r.labels.network_error+"("+a+")")},complete:function(){n.remove_spinner(a.parents(".row-actions")),a.attr("disabled",!1);var r=i?"Active":"Inactive",s=e("#ur-membership-list-status-"+t);s.text(r),"Inactive"===r?(s.removeClass("user-registration-badge--success-subtle"),s.addClass("user-registration-badge--secondary-subtle")):(s.removeClass("user-registration-badge--secondary-subtle"),s.addClass("user-registration-badge--success-subtle"))}})},validate_payment_gateway:function(a){var i=a.closest(".ur-toggle-section "),t=a.attr("id").split("ur-membership-pg-")[1],s=e("input:radio[name=ur_membership_type]:checked").val();n.prepend_spinner(i),this.send_data({action:"user_registration_membership_validate_pg",pg:t,membership_type:s},{success:function(e){e.status?(a.prop("checked",!0),a.closest(".user-registration-switch").closest(".ur-payment-option-header").siblings(".payment-option-body").hide()):(n.show_failure_message(e.message),a.prop("checked",!1),a.closest(".user-registration-switch").closest(".ur-payment-option-header").siblings(".payment-option-body").show())},failure:function(e,a){n.show_failure_message(r.labels.network_error+"("+a+")")},complete:function(){n.remove_spinner(i),n.toggleSaveButtons(!1)}})},send_data:function(a,i){var t="function"==typeof i.success?i.success:function(){},n="function"==typeof i.failure?i.failure:function(){},s="function"==typeof i.beforeSend?i.beforeSend:function(){},l="function"==typeof i.complete?i.complete:function(){};!a._wpnonce&&r&&(a._wpnonce=r._nonce),e.ajax({type:"post",dataType:"json",url:r.ajax_url,data:a,beforeSend:s,success:t,error:n,complete:l})},remove_deleted_memberships:function(r,a){a?r.each(function(){e(this).parents("tr").remove()}):e(r).parents("tr").remove()}};e(document).on("click","input:radio[name=ur_membership_type]",function(){var r=e(this).val(),a=e("#paid-plan-container"),i=e(".ur-membership-subscription-field-container"),t=e('label.ur-membership-upgrade-types[for="ur-membership-upgrade-type-pro-rata"]'),n=e("#ur-membership-duration"),s=e("#ur-membership-duration-container"),l=e("#ur-membership-team-pricing-container"),o=e("#ur-membership-payment-settings-notice"),u=1===o.data("paid-configured"),m=1===o.data("subscription-configured");a.addClass("ur-d-none"),t.addClass("ur-d-none"),n.addClass("ur-d-none"),s.removeClass("ur-d-flex"),s.addClass("ur-d-none"),l.removeClass("ur-d-flex"),l.addClass("ur-d-none"),o.addClass("ur-d-none"),i.show(),"free"!==r?("paid"===r?(i.hide(),u||o.removeClass("ur-d-none")):(i.removeClass("ur-d-none"),n.removeClass("ur-d-none"),s.addClass("ur-d-flex"),s.removeClass("ur-d-none"),m||o.removeClass("ur-d-none")),t.removeClass("ur-d-none"),a.removeClass("ur-d-none"),l.addClass("ur-d-flex"),l.removeClass("ur-d-none")):(e('input[name="ur_membership_local_currency"]').prop("checked",!1),e('input[name="ur_membership_local_currency"]').trigger("change"))}),e(document).on("click","#ur-membership-upgrade-action",function(){e("#upgrade-settings-container").toggle(),e("input:radio[name=ur_membership_type]:checked").trigger("click")}),e(document).on("keydown",function(r){r.ctrlKey&&"s"===r.key&&(r.preventDefault(),e(".ur-membership-save-btn").trigger("click"))}),e(".ur-membership-save-btn").on("click",function(a){a.preventDefault(),a.stopPropagation();var i=e(this);e(this).find(".ur-spinner.is-active").length?n.show_failure_message(r.labels.i18n_previous_save_action_ongoing):r.membership_id&&""!==r.membership_id?s.update_membership(i):s.create_membership(i)}),e("#ur-membership-trial-status").on("click",function(){var r=e(this).prop("checked"),a=e(".trial-container");e(this).val("on"),r||e(this).val("off"),a.toggleClass("ur-d-none")}),e(".ur-membership-change-status").on("change",function(){s.update_membership_status(e(this))}),e(document).on("click",".ur-payment-option-header",function(){e(this).find("input").trigger("click")}),e(document).on("click",".pg-switch",function(r){r.stopImmediatePropagation(),e(this).is(":checked")&&e(this).closest(".user-registration-switch").find(".ur-spinner.is-active").length<1&&s.validate_payment_gateway(e(this))}),e(".delete-membership").on("click",function(a){a.preventDefault(),a.stopPropagation();var i=e(this),t=i.data("membership-id"),l=i.closest(".delete");l.find("span").hasClass("is-active")||(n.append_spinner(l),Swal.fire({title:'<img src="'+r.delete_icon+'" id="delete-user-icon">'+r.labels.i18n_prompt_title,html:'<p id="html_1">'+r.labels.i18n_prompt_single_subtitle+"</p>",showCancelButton:!0,confirmButtonText:r.labels.i18n_prompt_delete,cancelButtonText:r.labels.i18n_prompt_cancel,allowOutsideClick:!1}).then(function(e){e.isConfirmed?s.send_data({action:"user_registration_membership_delete_membership",membership_id:t},{success:function(e){e.success?(n.show_success_message(e.data.message),s.remove_deleted_memberships(i,!1)):Swal.fire({title:'<img src="'+r.delete_icon+'" id="delete-user-icon">'+r.labels.i18n_prompt_title,html:e.data.message,confirmButtonText:r.labels.i18n_prompt_ok,allowOutsideClick:!1})},failure:function(e,a){n.show_failure_message(r.labels.network_error+"("+a+")")},complete:function(){n.remove_spinner(i.closest(".delete"))}}):n.remove_spinner(i.closest(".delete"))}))}),e("#membership-list #doaction,#doaction2").on("click",function(r){r.preventDefault(),r.stopPropagation();var a=e("#membership-list");if("delete"===a.find("select#bulk-action-selector-top option:selected").val())n.handle_bulk_delete_action(a)});var l=e(".ur-page-title__wrapper--steps .ur-page-title__wrapper--steps-btn"),o=e(".user-registration-card--form-step");l.on("click",function(){var r;r=e(this).data("step"),o.removeClass("user-registration-card--form-step-active"),l.removeClass("ur-page-title__wrapper--steps-btn-active"),o.eq(r).addClass("user-registration-card--form-step-active"),l.eq(r).addClass("ur-page-title__wrapper--steps-btn-active")}),e("#ur-membership-team-pricing").on("change",function(){e(this).is(":checked")?e("#ur-team-pricing-container").show():e("#ur-team-pricing-container").hide()}),e(document).on("change",'input[name^="ur_seat_model"]',function(){var r=e(this).closest(".ur-team-pricing-wrapper");"fixed"===e(this).val()?(r.find(".ur-team-fixed-seats-field").show(),r.find(".ur-team-variable-seats-field").hide()):(r.find(".ur-team-fixed-seats-field").hide(),r.find(".ur-team-variable-seats-field").show())}),e(document).on("change",'input[name^="ur_pricing_model"]',function(){var r=e(this).closest(".ur-team-pricing-wrapper");"per_seat"===e(this).val()?(r.find(".ur-team-per-seats-field").show(),r.find(".ur-team-tier-field").hide()):(r.find(".ur-team-per-seats-field").hide(),r.find(".ur-team-tier-field").show())});var u=e("#ur-team-pricing-container .ur-team-pricing-wrapper:first").clone(),m=e("#ur-team-pricing-container .ur-team-pricing-wrapper").length;e("#ur-add-team-pricing-btn").on("click",function(r){r.preventDefault();var a=u.clone();a.attr("data-pricing-wrapper-id",m),a.find("[id]").each(function(){var r,a=e(this).attr("id");r=a.includes("[")&&a.includes("]")?a.replace(/\[\d+\]/,"_"+m):/_\d+$/.test(a)?a.replace(/_\d+$/,"_"+m):a.replace(/-\d+$/,"-"+m),e(this).attr("id",r)}),a.find("[name]").each(function(){var r=e(this).attr("name");if(r.includes("ur_tier_from")||r.includes("ur_tier_to")||r.includes("ur_tier_per_seat_price")){var a=r.split("[")[0];e(this).attr("name",a+"["+m+"][0]")}else{var i=r.replace(/\[\d*\]$/,"");e(this).attr("name",i+"["+m+"]")}}),a.find("label[for]").each(function(){var r,a=e(this).attr("for");r=a.includes("[")&&a.includes("]")?a.replace(/\[\d+\]/,"_"+m):/_\d+$/.test(a)?a.replace(/_\d+$/,"_"+m):a.replace(/-\d+$/,"-"+m),e(this).attr("for",r)}),a.find("input").each(function(){"number"===e(this).attr("type")&&e(this).val("0"),"text"===e(this).attr("type")&&e(this).val(""),"radio"===e(this).attr("type")&&e(this).prop("checked",!1)}),a.find('input[name="ur_seat_model['+m+']"][value="fixed"]').prop("checked",!0),a.find('input[name="ur_pricing_model['+m+']"][value="per_seat"]').prop("checked",!0),a.find('input[name="ur_team_plan_type['+m+']"][value="one-time"]').prop("checked",!0),a.find(".ur-team-tier-field-wrapper:not(:first)").remove(),a.find(".ur-team-tier-field-wrapper:first").attr("data-tier-wrapper-id","0"),e("#ur-add-team-pricing-btn-wrapper").before(a),a.find('input[name="ur_seat_model['+m+']"]:checked').trigger("change"),a.find('input[name="ur_pricing_model['+m+']"]:checked').trigger("change"),a.find('input[name="ur_team_plan_type['+m+']"]:checked').trigger("change"),m++}),e(document).on("click",".ur-remove-team-pricing-btn",function(){e(this).closest(".ur-team-pricing-wrapper ").remove()}),e(document).on("change",'input[name^="ur_team_plan_type["]',function(){var r=e(this).closest(".ur-team-pricing-wrapper").find("#paid-plan-container");"subscription"===e(this).val()?r.show():r.hide()}),e(document).on("click",".ur-add-tier-btn",function(r){r.preventDefault();var a=e(this).closest(".ur-team-pricing-wrapper"),i=a.find(".ur-team-tier-field"),t=a.attr("data-pricing-wrapper-id"),n=e(".ur-team-tier-field-wrapper:first").clone(),s=i.find(".ur-team-tier-field-wrapper").length;n.attr("data-tier-wrapper-id",s),n.find("input").each(function(){var r=e(this).attr("name").split("[")[0];e(this).attr("name",r+"["+t+"]["+s+"]").val(0)}),e(this).closest(".ur-add-tier-btn-wrapper").before(n),s++}),e(document).on("click",".ur-remove-tier-btn",function(){e(this).closest(".ur-team-tier-field-wrapper").remove()});var c=e("#membership-list tbody#the-list");if(c.length>0&&e.fn.sortable){var p=r.labels.i18n_update_order,d=e('<div class="ur-membership-order-controls ur-d-none"><button type="button" class="button button-primary ur-update-membership-order-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="#000" viewBox="0 0 24 24"><path d="M2 12A10 10 0 0 1 12 2h.004l.519.015a10.75 10.75 0 0 1 6.53 2.655l.394.363 2.26 2.26a1 1 0 1 1-1.414 1.414l-2.248-2.248-.31-.286A8.75 8.75 0 0 0 11.996 4 8 8 0 0 0 4 12a1 1 0 1 1-2 0Z"/><path d="M20 3a1 1 0 1 1 2 0v5a1 1 0 0 1-1 1h-5a1 1 0 1 1 0-2h4V3Zm0 9a1 1 0 1 1 2 0 10 10 0 0 1-10 10h-.004a10.75 10.75 0 0 1-7.05-2.67l-.393-.363-2.26-2.26a1 1 0 1 1 1.414-1.414l2.248 2.248.31.286A8.749 8.749 0 0 0 12.003 20 7.999 7.999 0 0 0 20 12Z"/><path d="M2 21v-5a1 1 0 0 1 1-1h5a1 1 0 1 1 0 2H4v4a1 1 0 1 1-2 0Z"/></svg><span class="ur-update-order-btn-text">'+p+"</span></button></div>"),_=d.find(".ur-update-membership-order-btn"),h='<span class="ur-spinner"></span>',f=[];function b(){var r=[];return c.find("tr[data-membership-id]").each(function(){var a=e(this);if(!a.hasClass("ui-sortable-helper")&&!a.hasClass("ur-sortable-placeholder")){var i=a.attr("data-membership-id");i&&r.push(parseInt(i,10))}}),r}e(".user-registration-base-list-table-heading").append(d),c.sortable({items:"tr[data-membership-id]",cancel:".no-items",cursor:"move",opacity:.8,placeholder:"ur-sortable-placeholder",helper:function(r,a){f=[],c.find("tr[data-membership-id]").each(function(){var r=e(this).attr("data-membership-id");r&&f.push(parseInt(r,10))});var i=a.children(),t=a.clone();t.children().each(function(r){e(this).width(i.eq(r).width())});var n=e("<table></table>");return n.css({width:a.closest("table").width()+"px",margin:0}),n.append(t),n},start:function(e,r){0===f.length&&(f=b())},stop:function(e,r){var a=b();(function(e,r){if(e.length!==r.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!==r[a])return!1;return!0})(f,a)||(_.prop("disabled",!1),d.removeClass("ur-d-none"),d.find(".ur-spinner").remove()),f=[]}}),d.on("click",".ur-update-membership-order-btn",function(a){if(a.preventDefault(),!(d.find(".ur-spinner").length>0)){d.append(h);var i=[];if(c.find("tr[data-membership-id]").each(function(){var r=e(this).attr("data-membership-id");r&&i.push(parseInt(r,10))}),0===i.length)return h.removeClass("is-active"),_.prop("disabled",!1),void d.find(".ur-spinner").remove();e.ajax({url:r.ajax_url,type:"POST",data:{action:r.update_order_action,nonce:r.update_order_nonce,membership_order:i},success:function(e){d.find(".ur-spinner").remove(),e.success?(n.show_success_message(e.data.message),d.addClass("ur-d-none")):n.show_failure_message(e.data.message)},error:function(e,a,i){d.find(".ur-spinner").remove(),n.show_failure_message(r.labels.network_error)}})}})}function v(e){var r=e.find('.ur-local-currency-radio-group input[type="radio"]:checked'),a=e.find(".local-currency-manual-local-price");"manual"===r.val()?a.removeClass("hidden").show():a.addClass("hidden").hide()}function g(a=""){var i=e("#ur-membership-local-currency-action"),t=e(".ur-local-currency-card");"free"===e("input:radio[name=ur_membership_type]:checked").val()&&""===a&&(i.prop("checked",!1),n.show_failure_message(r.local_currency_not_support_msg)),i.is(":checked")?t.show():t.hide()}function y(e,r){e?r.show():r.hide()}e(document).on("change",".ur-local-currency-toggle-input",function(){var a=e(this),i=a.closest(".ur-local-currency-card"),t=i.find(".ur-local-currency-content"),n=i.find(".ur-local-currency-collapse-btn"),s=a.data("zone-id");e(this).is(":checked")?(t.removeClass("hidden"),n.addClass("collapsed"),data={action:"user_registration_membership_validate_payment_currency",zone_id:s,security:r.validate_payment_currency_nonce},e.ajax({type:"post",url:r.ajax_url,data:data,beforeSend:function(){a.closest(".ur-local-currency-controls").append('<span class="ur-spinner is-active"></span>')},success:function(r){a.closest(".ur-local-currency-controls").find(".ur-spinner").remove(),r.success||(e(document).find(".ur-local-currency-"+s+"-message").removeClass("hidden"),e(document).find(".ur-local-currency-"+s+"-message").html(r.data.message))}})):(t.addClass("hidden"),n.removeClass("collapsed"),e(document).find(".ur-local-currency-"+s+"-message").addClass("hidden"),e(document).find(".ur-local-currency-"+s+"-message").empty())}),e(".ur-local-currency-toggle-input:checked").each(function(){e(this).trigger("change")}),e(document).on("click",".ur-local-currency-collapse-btn",function(r){r.preventDefault();var a=e(this).closest(".ur-local-currency-card"),i=a.find(".ur-local-currency-content");a.find(".ur-local-currency-toggle-input").is(":checked")&&(i.toggleClass("hidden"),e(this).toggleClass("collapsed"))}),e(document).on("change",'.ur-local-currency-radio-group input[type="radio"]',function(){v(e(this).closest(".ur-local-currency-card"))}),e(".ur-local-currency-card").each(function(){v(e(this))}),e(document).on("change","#ur-membership-local-currency-action",function(){g()}),g("load"),e(document).on("change","#ur-membership-email-marketing-sync-action",function(r){r.stopPropagation(),r.preventDefault();var a=e(this),i=e("#ur-sync-to-email-marketing-container");y(a.is(":checked"),i)});var w=e("#ur-membership-email-marketing-sync-action"),k=e("#ur-sync-to-email-marketing-container");function C(){e(".ur-sync-to-email-marketing-addon-sync-container").each(function(){var r=e(this),a=r.find('.ur-sync-to-email-marketing-addon-sync-toggle-container input[type="checkbox"]'),i=r.find('.ur-sync-to-email-marketing-addon-sync-toggle-label-container .form-row, .urmc-sync-email-marketing-mailchimp-list-wrap, .urmc-sync-email-marketing-brevo-list-wrap, [class*="urmc-sync-email-marketing-"][class$="-list-wrap"]');a.is(":checked")?i.show():i.hide()})}y(w.is(":checked"),k),C(),e(document).on("change",'.ur-sync-to-email-marketing-addon-sync-toggle-container input[type="checkbox"]',function(){C()}),e(document).on("change",".ur_sync_email_marketing_addon_account",function(a){a.stopPropagation(),a.preventDefault();var i=e(this),t=i.data("addon_name"),s=i.val(),l={action:"user_registration_membership_addons_get_lists",addon:t,api_key:s};e.ajax({type:"post",url:r.ajax_url,data:l,beforeSend:function(){var r=e(document).find(".urmc-sync-email-marketing-"+t+"-list-wrap");n.append_spinner(r),r.find("select").prop("disabled",!0),r.closest(".ur-sync-to-email-marketing-addon-sync-container").find("select").prop("disabled",!0)},success:function(r){var a=e(".urmc-sync-email-marketing-"+t+"-list-wrap");if(a.find(".ur-spinner").remove(),r.success&&(a.find("select").remove(),a.append(r.data.html),"mailchimp"===t&&r.data?.tag_html)){var i=e(".urmc-sync-email-marketing-"+t+"-list-tag-wrap");i.find("select").each(function(){e(this).hasClass("select2-hidden-accessible")&&e(this).select2("destroy")}),i.find("select").remove(),i.append(r.data.tag_html),i.find("select.ur-enhanced-select").select2({width:"100%",placeholder:"Select Tags",allowClear:!0})}a.closest(".ur-sync-to-email-marketing-addon-sync-container").find("select").prop("disabled",!1)}})})}(jQuery,window.ur_membership_localized_data);