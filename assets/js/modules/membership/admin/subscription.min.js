!function(e,i){"use strict";var t;UR_Snackbar&&(t=new UR_Snackbar),e(".user-membership-enhanced-select2").select2();var r=e("#ur-payment-gateway-container"),a=e("#ur-subscription-id-container"),n=e("#ur-subscription-payment-gateway"),s=e("#ur-subscription-plan"),o=e("#ur-subscription-billing-amount"),u=e("#ur-subscription-billing-cycle"),l=e("#ur-billing-cycle-container"),c=e("#ur-start-date-container"),p=e("#ur-expiry-date-container"),d=e("#ur-subscription-start-date"),m=e("#ur-subscription-expiry-date");s.on("change",function(){var t=e(this).val();if(t&&"undefined"!=typeof ur_membership_plans&&Array.isArray(ur_membership_plans)){var s=ur_membership_plans.find(function(e){return String(e.ID)===String(t)});if(s)if(function(e){if(e&&e.meta_value)if(e.meta_value,e.meta_value.amount&&o.val(e.meta_value.amount),"subscription"===e.meta_value.type){var i=e.meta_value.subscription.duration;u.val(i).trigger("change.select2"),e.meta_value.subscription.value||1,[l,c,p].forEach(function(e){e.removeClass("ur-d-none").addClass("ur-d-flex")}),d.prop("required",!0),m.prop("required",!0)}else u.val("").trigger("change.select2"),null,[l,c,p].forEach(function(e){e.removeClass("ur-d-flex").addClass("ur-d-none")}),d.prop("required",!1).val(""),m.prop("required",!1).val("")}(s),s.meta_value&&s.meta_value.payment_gateways){var f=s.meta_value.payment_gateways,h={},_=i.payment_gateways||{};Object.keys(f).forEach(function(e){if("on"===f[e].status){var i=_[e]||e.charAt(0).toUpperCase()+e.slice(1);h[e]=i}}),Object.keys(h).length>0?(n.hasClass("select2-hidden-accessible")&&n.select2("destroy"),n.empty(),n.append('<option value="">'+(i.i18n_select_payment_gateway||"Select Payment Gateway")+"</option>"),e.each(h,function(e,i){n.append('<option value="'+e+'" data-gateway-key="'+e+'">'+i+"</option>")}),n.select2(),r.show()):(r.hide(),a.hide())}else r.hide(),a.hide();else o.val(""),u.val("").trigger("change.select2"),null,null,r.hide(),a.hide(),l.hide(),c.hide(),p.hide(),d.prop("required",!1).val(""),m.prop("required",!1).val("")}else o.val(""),u.val("").trigger("change.select2"),null,null,r.hide(),a.hide(),l.hide(),c.hide(),p.hide(),d.prop("required",!1).val(""),m.prop("required",!1).val("")}),n.on("change",function(){"stripe"===e(this).val()?a.show():(a.hide(),e("#ur-subscription-id-field").val(""))}),e('button[form="ur-membership-subscription-edit-form"]').on("click",function(){e('form[id="ur-membership-subscription-edit-form"]').trigger("submit")}),e('form[id="ur-membership-subscription-create-form"]').on("submit",function(r){r.preventDefault();var a=e('button[form="ur-membership-subscription-create-form"]');a.prop("disabled",!0).append('<span class="ur-spinner"></span>'),e.ajax({url:i.ajax_url+"?action=user_registration_pro_create_subscription",type:"POST",data:e(this).serialize(),success:function(e){e.success?(t.add({type:"success",message:e.data.message,duration:5}),setTimeout(function(){window.location.href=i.subscriptions_url},1e3)):t.add({type:"failed",message:e.data.message,duration:5})},error:function(e,r){t.add({type:"failed",message:i.i18n_error,duration:5})},complete:function(){a.prop("disabled",!1).find(".ur-spinner").remove()}})}),e('form[id="ur-membership-subscription-edit-form"]').on("submit",function(r){r.preventDefault();var a=e('button[form="ur-membership-subscription-edit-form"]');a.prop("disabled",!0).append('<span class="ur-spinner"></span>'),e.ajax({url:i.ajax_url+"?action=user_registration_pro_update_subscription",type:"POST",data:e(this).serialize(),success:function(e){e.success?t.add({type:"success",message:e.data.message,duration:5}):t.add({type:"failed",message:e.data.message,duration:5})},error:function(e,r){t.add({type:"failed",message:i.i18n_error,duration:5})},complete:function(){a.prop("disabled",!1).find(".ur-spinner").remove()}})}),e(".submitdelete,.single-delete-subscription").on("click",function(t){t.preventDefault();var r=e(this);Swal.fire({title:'<img src="'+i.delete_icon+'" id="delete-user-icon">'+i.i18n_prompt_delete_title,html:'<p id="html_1">'+i.i18n_prompt_delete_description+"</p>",showCancelButton:!0,confirmButtonText:i.i18n_prompt_delete_confirm,cancelButtonText:i.i18n_prompt_delete_cancel,allowOutsideClick:!1}).then(function(e){e.isConfirmed&&(window.location.href=r.attr("href"))})})}(jQuery,window.ur_subscription_data);