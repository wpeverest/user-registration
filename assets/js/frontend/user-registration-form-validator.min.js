!function(e){var r;r=e(".ur-frontend-form form, form.cart, form.checkout");var t="";r.hasClass("edit-profile")&&(t="user_registration_");var a={$user_registration:r,init:function(){this.add_validation_methods(),this.load_validation(),this.init_inputMask(),this.init_tooltipster(),this.$user_registration.on("input validate change",".input-text, select, input:checkbox input:radio",this.validate_field),e(".input-text").keypress(function(r){$this=e(this);var t=Number($this.attr("max-words")),a=$this.val().split(" ").length;void 0!==t&&a>t&&r.preventDefault()}),e("[type='number']").keypress(function(r){var t=r.keyCode||r.which,a=e(this).val();46===t&&-1===a.indexOf(".")||!(t<48||t>57)||r.preventDefault()})},init_inputMask:function(){void 0!==e.fn.inputmask&&e(".ur-masked-input").inputmask()},init_tooltipster:function(){if("undefined"!=typeof tooltipster){var r={theme:"tooltipster-borderless",maxWidth:200,multiple:!0,interactive:!0,position:"bottom",contentAsHTML:!0,functionInit:function(e,r){var t=jQuery(r.origin).attr("data-tip");t&&e.content(t)}};e(".user-registration-help-tip").tooltipster(r)}},add_validation_methods:function(){e.validator.methods.email=function(e,r){var t=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return this.optional(r)||t.test(e)},e.validator.methods.required=function(r,t,a){if(!this.depend(a,t))return"dependency-mismatch";if("select"===t.nodeName.toLowerCase()){var i=e(t).val();return i&&i.length>0}return this.checkable(t)?this.getLength(r,t)>0:void 0!==r.trim()&&null!==r.trim()&&r.trim().length>0},e.validator.addMethod("wordsValidator",function(e,r,t){var a=e.trim().split(/\s+/).length;return""==e||a>=t},e.validator.format("Please enter at least {0} words.")),e.validator.addMethod("lengthValidator",function(e,r,t){return e.length<=t},e.validator.format("Please enter less than {0} characters.")),e.validator.addMethod("SpecialCharacterValidator",function(e,r){var t=new RegExp(/^(?=.{3,20}$)[a-zA-Z][a-zA-Z0-9]*(?: [a-zA-Z0-9]+)*$/);return this.optional(r)||t.test(e)},user_registration_params.message_username_character_fields),e.validator.addMethod("checkLimit",function(r,t,a){var i=parseInt(a||0,10),s="";if(e(t).closest(".field-checkbox").length)s=e(t).closest("ul").find('input[type="checkbox"]:checked');else if(e(t).closest(".field-multi_select2").length)s=e(t).val();else if(e(t).closest(".field-multiple_choice").length){s=e(t).closest("ul").find('input[type="checkbox"]:checked')}return 0===i||s.length<=i},e.validator.format(user_registration_params.user_registration_checkbox_validation_message)),e.validator.addMethod("patternValidator",function(e,r,t){var a=new RegExp(t.pattern);return this.optional(r)||a.test(e)},function(e,r){return e.errorMessage})},load_validation:function(){if(void 0===e.fn.validate)return!1;var r=e(document).find('[name="quantity"]');""===r.attr("max")&&r.removeAttr("max");var t=this;t.$user_registration.each(function(){var r=e(this);if(r.parent("div").hasClass("user-registration")){var a=t.custom_validation(r);t.custom_validation_messages(),r.validate({errorClass:"user-registration-error",validClass:"user-registration-valid",ignore:function(r,t){return!(!e(t).closest(".ur-field-item").is(":hidden")&&!e(t).closest(".ur_membership_frontend_input_container").is(":hidden"))||(!!e(t).hasClass("ur-flatpickr-field")||(!!(t.id&&t.id.startsWith("shipping_")&&e(t).closest(".form-row").is(":hidden"))||void 0))},rules:a.rules,messages:a.messages,focusInvalid:!1,invalidHandler:function(r,t){t.numberOfInvalids()&&e(window).scrollTop(e(t.errorList[0].element).offset().top)},errorPlacement:function(r,t){if(t.is("#password_current")||t.is("#password_1")||t.is("#password_2"))t.parent().after(r);else if("radio"===t.attr("type")||"checkbox"===t.attr("type")||"password"===t.attr("type"))t.parent().parent().parent().append(r);else if(t.is("select")&&t.attr("class").match(/date-month|date-day|date-year/))0===t.parent().find("label.user-registration-error:visible").length&&t.parent().find("select:last").after(r);else if(t.hasClass("ur-smart-phone-field")){var a=t.closest(".form-row");a.find("#"+t.data("id")+"-error").remove(),a.append(r)}else"number"===t.attr("type")&&t.hasClass("ur-range-input")?r.insertAfter(t.closest(".ur-range-row").find(".ur-range-number")):"text"===t.attr("type")&&t.hasClass("input-timepicker")?t.hasClass("timepicker-end")||r.insertAfter(t.parent()):(e(document).trigger("user-registration-append-error-messages",t),t.hasClass("urfu-file-input")||t.closest(".field-multi_select2").length?r.insertAfter(t.parent().parent()):"number"===t.attr("type")&&t.hasClass("ur-quantity")?r.insertAfter(t.parent()):"text"===t.attr("type")&&t.hasClass("ur-payment-price")?r.insertAfter(t):"url"===t.attr("type")?r.insertAfter(t.parent()):r.insertAfter(t.parent().parent()))},highlight:function(r,t,a){var i=e(r);i.closest(".form-row"),i.attr("name");i.removeClass("ur-input-border-green").addClass("ur-input-border-red")},unhighlight:function(r,t,a){var i=e(r),s=i.closest(".form-row"),n=i.attr("name");i.removeClass("ur-input-border-red").addClass("ur-input-border-green"),"radio"===i.attr("type")||"checkbox"===i.attr("type")?s.find("input[name='"+n+"']").addClass(a).removeClass(t):i.addClass(a).removeClass(t),s.removeClass("user-registration-has-error")},submitHandler:function(r){return!(e(r).hasClass("register")||e(r).hasClass("edit-profile")&&user_registration_params.ajax_submission_on_edit_profile)}})}})},validate_field:function(r){e.extend(e.validator.messages,{required:user_registration_params.message_required_fields,url:user_registration_params.message_url_fields,email:user_registration_params.message_email_fields,number:user_registration_params.message_number_fields,confirmpassword:user_registration_params.message_confirm_password_fields});var t=e(this),a=t.closest(".form-row"),i=!0,s=a.is(".validate-required"),n=a.is(".validate-email"),u=r.type;if("input"===u&&a.removeClass("user-registration-invalid user-registration-invalid-required-field user-registration-invalid-email user-registration-validated"),"validate"===u||"change"===u){if(s&&("checkbox"!==t.attr("type")||t.is(":checked")?""===t.val()&&(a.removeClass("user-registration-validated").addClass("user-registration-invalid user-registration-invalid-required-field"),i=!1):(a.removeClass("user-registration-validated").addClass("user-registration-invalid user-registration-invalid-required-field"),i=!1)),n)if(t.val())new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(t.val())||(a.removeClass("user-registration-validated").addClass("user-registration-invalid user-registration-invalid-email"),i=!1);i&&a.removeClass("user-registration-invalid user-registration-invalid-required-field user-registration-invalid-email").addClass("user-registration-validated")}},custom_validation:function(r){var a={},i={},s=r.find("[data-min-words]");if(s.length&&e.each(s,function(r,t){var s={};$this=e(t),s.wordsValidator=$this.data("min-words");var n=$this.data("id");a[n]=s,i[n]={wordsValidator:user_registration_params.message_min_words_fields.replace("%qty%",s.wordsValidator)}}),r.find("#user_confirm_email").length){var n=r.closest(".ur-frontend-form").attr("id");a.user_confirm_email={required:!0,equalTo:"#"+n+" #user_email"},i.user_confirm_email={required:user_registration_params.message_required_fields,equalTo:user_registration_params.message_confirm_email_fields}}if(r.hasClass("edit-password")||r.hasClass("ur_lost_reset_password"))a.password_2={equalTo:"#password_1"},i.password_2=user_registration_params.message_confirm_password_fields;else if(r.hasClass("register")&&r.find("#user_confirm_password").length){n=r.closest(".ur-frontend-form").attr("id");a.user_confirm_password={required:!0,equalTo:"#"+n+" #user_pass"},i.user_confirm_password={required:user_registration_params.message_required_fields,equalTo:user_registration_params.message_confirm_password_fields}}var u=r.find("#user_login"),d={};u.length&&void 0!==u.data("username-length")&&(d.lengthValidator=u.data("username-length")),void 0===u.data("username-character")&&r.closest(".ur-frontend-form").find(".register").length&&(d.SpecialCharacterValidator=!0),a.user_login=d;var o=r.find(".field-checkbox"),l=r.find(".field-multi_select2"),F=r.find(".field-multiple_choice");return o.length&&o.each(function(){e(this).attr("data-field-id").indexOf("user_registration_")>-1&&(t=""),a[t+e(this).attr("data-field-id")+"[]"]={checkLimit:e(this).find("ul").data("choice-limit")?e(this).find("ul").data("choice-limit"):0}}),l.length&&l.each(function(){e(this).attr("data-field-id").indexOf("user_registration_")>-1&&(t=""),a[t+e(this).attr("data-field-id")+"[]"]={checkLimit:e(this).find("select").data("choice-limit")?e(this).find("select").data("choice-limit"):0}}),F.length&&F.each(function(){a[t+e(this).data("field-id")+"[]"]={checkLimit:e(this).find("ul").data("choice-limit")?e(this).find("ul").data("choice-limit"):0}}),e('div[data-field-pattern-enabled="1"]').each(function(){var r=e(this),t=r.data("field-id"),i=r.data("field-pattern-value"),s=r.data("field-pattern-message");a[t]={patternValidator:{pattern:i,errorMessage:s,param:{pattern:i,errorMessage:s}}}}),{rules:a,messages:i}},custom_validation_messages:function(){e.validator.messages.required=user_registration_params.message_required_fields,e.validator.messages.url=user_registration_params.message_url_fields,e.validator.messages.email=user_registration_params.message_email_fields,e.validator.messages.number=user_registration_params.message_number_fields,e.validator.messages.confirmpassword=user_registration_params.message_confirm_password_fields,e.validator.messages.max=function(e,r){return user_registration_params.message_confirm_number_field_max.replace("%qty%",r.max)},e.validator.messages.min=function(e,r){return user_registration_params.message_confirm_number_field_min.replace("%qty%",r.min)},e.validator.messages.step=function(e,r){return user_registration_params.message_confirm_number_field_step.replace("%qty%",r.step)},e.validator.messages.minlength=function(e,r){return user_registration_params.message_min_length_fields.replace("%qty%",e)},e.validator.messages.maxlength=function(e,r){return user_registration_params.message_max_length_fields.replace("%qty%",e)}}};e(window).on("load",function(){a.init()}),e(window).on("user_registration_repeater_modified",function(){a.init()})}(jQuery);